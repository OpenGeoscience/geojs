!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof exports?exports.geo=e(require("d3")):t.geo=e(t.d3)}(this,function(t){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="dist/built",e(0)}([function(t,e,i){/**
	 * GeoJS
	 * @copyright 2013-2016, Kitware, Inc.
	 * @license Apache-2.0
	 *
	 * Bundled with the following libraries:
	 *
	 * vgl
	 * @copyright 2014-2016, Kitware, Inc.
	 * @license Apache-2.0
	 *
	 * Proj4js
	 * @copyright 2014, Mike Adair, Richard Greenwood, Didier Richard, Stephen Irons, Olivier Terral and Calvin Metcalf
	 * @license MIT
	 *
	 * gl-matrix
	 * @copyright 2015, Brandon Jones, Colin MacKenzie IV
	 * @license MIT
	 *
	 * JQuery
	 * @copyright jQuery Foundation and other contributors
	 * @license MIT
	 *
	 * earcut
	 * @copyright 2016, Mapbox
	 * @license ISC
	 */
var n=i(1);i(2),t.exports=n.extend({camera:i(3),choroplethFeature:i(126),clock:i(133),contourFeature:i(134),domRenderer:i(135),event:i(125),feature:i(127),featureLayer:i(137),fetchQueue:i(138),fileReader:i(139),geomFeature:i(140),graphFeature:i(141),imageTile:i(142),jsonReader:i(144),layer:i(130),lineFeature:i(145),map:i(146),mapInteractor:i(217),object:i(5),osmLayer:i(220),pathFeature:i(223),pointFeature:i(224),polygonFeature:i(226),quadFeature:i(218),heatmapFeature:i(227),renderer:i(136),sceneObject:i(128),tile:i(143),tileCache:i(222),tileLayer:i(221),timestamp:i(129),transform:i(147),vectorFeature:i(228),inherit:i(4),version:i(229),sha:i(230),util:i(120),jQuery:n,d3:i(231),gl:i(243),canvas:i(256),gui:i(262)},i(131)),window&&!window.$&&(window.$=n),window&&!window.jQuery&&(window.jQuery=n)},function(t,e,i){var n,r;!function(e,i){"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?i(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return i(t)}:i(e)}("undefined"!=typeof window?window:this,function(i,o){function a(t){var e=!!t&&"length"in t&&t.length,i=lt.type(t);return"function"!==i&&!lt.isWindow(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}function s(t,e,i){if(lt.isFunction(e))return lt.grep(t,function(t,n){return!!e.call(t,n,t)!==i});if(e.nodeType)return lt.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(xt.test(e))return lt.filter(e,t,i);e=lt.filter(e,t)}return lt.grep(t,function(t){return nt.call(e,t)>-1!==i})}function u(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function l(t){var e={};return lt.each(t.match(At)||[],function(t,i){e[i]=!0}),e}function h(){J.removeEventListener("DOMContentLoaded",h),i.removeEventListener("load",h),lt.ready()}function c(){this.expando=lt.expando+c.uid++}function d(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(Dt,"-$&").toLowerCase(),i=t.getAttribute(n),"string"==typeof i){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:Lt.test(i)?lt.parseJSON(i):i)}catch(r){}Pt.set(t,e,i)}else i=void 0;return i}function f(t,e,i,n){var r,o=1,a=20,s=n?function(){return n.cur()}:function(){return lt.css(t,e,"")},u=s(),l=i&&i[3]||(lt.cssNumber[e]?"":"px"),h=(lt.cssNumber[e]||"px"!==l&&+u)&&It.exec(lt.css(t,e));if(h&&h[3]!==l){l=l||h[3],i=i||[],h=+u||1;do o=o||".5",h/=o,lt.style(t,e,h+l);while(o!==(o=s()/u)&&1!==o&&--a)}return i&&(h=+h||+u||0,r=i[1]?h+(i[1]+1)*i[2]:+i[2],n&&(n.unit=l,n.start=h,n.end=r)),r}function p(t,e){var i="undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e||"*"):"undefined"!=typeof t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&lt.nodeName(t,e)?lt.merge([t],i):i}function m(t,e){for(var i=0,n=t.length;i<n;i++)Rt.set(t[i],"globalEval",!e||Rt.get(e[i],"globalEval"))}function v(t,e,i,n,r){for(var o,a,s,u,l,h,c=e.createDocumentFragment(),d=[],f=0,v=t.length;f<v;f++)if(o=t[f],o||0===o)if("object"===lt.type(o))lt.merge(d,o.nodeType?[o]:o);else if(Bt.test(o)){for(a=a||c.appendChild(e.createElement("div")),s=(Gt.exec(o)||["",""])[1].toLowerCase(),u=zt[s]||zt._default,a.innerHTML=u[1]+lt.htmlPrefilter(o)+u[2],h=u[0];h--;)a=a.lastChild;lt.merge(d,a.childNodes),a=c.firstChild,a.textContent=""}else d.push(e.createTextNode(o));for(c.textContent="",f=0;o=d[f++];)if(n&&lt.inArray(o,n)>-1)r&&r.push(o);else if(l=lt.contains(o.ownerDocument,o),a=p(c.appendChild(o),"script"),l&&m(a),i)for(h=0;o=a[h++];)Ut.test(o.type||"")&&i.push(o);return c}function g(){return!0}function y(){return!1}function x(){try{return J.activeElement}catch(t){}}function _(t,e,i,n,r,o){var a,s;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=void 0);for(s in e)_(t,s,i,n,e[s],o);return t}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),r===!1)r=y;else if(!r)return t;return 1===o&&(a=r,r=function(t){return lt().off(t),a.apply(this,arguments)},r.guid=a.guid||(a.guid=lt.guid++)),t.each(function(){lt.event.add(this,e,r,n,i)})}function b(t,e){return lt.nodeName(t,"table")&&lt.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function w(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function M(t){var e=Kt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function T(t,e){var i,n,r,o,a,s,u,l;if(1===e.nodeType){if(Rt.hasData(t)&&(o=Rt.access(t),a=Rt.set(e,o),l=o.events)){delete a.handle,a.events={};for(r in l)for(i=0,n=l[r].length;i<n;i++)lt.event.add(e,r,l[r][i])}Pt.hasData(t)&&(s=Pt.access(t),u=lt.extend({},s),Pt.set(e,u))}}function A(t,e){var i=e.nodeName.toLowerCase();"input"===i&&kt.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function E(t,e,i,n){e=et.apply([],e);var r,o,a,s,u,l,h=0,c=t.length,d=c-1,f=e[0],m=lt.isFunction(f);if(m||c>1&&"string"==typeof f&&!st.checkClone&&Xt.test(f))return t.each(function(r){var o=t.eq(r);m&&(e[0]=f.call(this,r,o.html())),E(o,e,i,n)});if(c&&(r=v(e,t[0].ownerDocument,!1,t,n),o=r.firstChild,1===r.childNodes.length&&(r=o),o||n)){for(a=lt.map(p(r,"script"),w),s=a.length;h<c;h++)u=r,h!==d&&(u=lt.clone(u,!0,!0),s&&lt.merge(a,p(u,"script"))),i.call(t[h],u,h);if(s)for(l=a[a.length-1].ownerDocument,lt.map(a,M),h=0;h<s;h++)u=a[h],Ut.test(u.type||"")&&!Rt.access(u,"globalEval")&&lt.contains(l,u)&&(u.src?lt._evalUrl&&lt._evalUrl(u.src):lt.globalEval(u.textContent.replace(Qt,"")))}return t}function C(t,e,i){for(var n,r=e?lt.filter(e,t):t,o=0;null!=(n=r[o]);o++)i||1!==n.nodeType||lt.cleanData(p(n)),n.parentNode&&(i&&lt.contains(n.ownerDocument,n)&&m(p(n,"script")),n.parentNode.removeChild(n));return t}function S(t,e){var i=lt(e.createElement(t)).appendTo(e.body),n=lt.css(i[0],"display");return i.detach(),n}function R(t){var e=J,i=Zt[t];return i||(i=S(t,e),"none"!==i&&i||(Yt=(Yt||lt("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=Yt[0].contentDocument,e.write(),e.close(),i=S(t,e),Yt.detach()),Zt[t]=i),i}function P(t,e,i){var n,r,o,a,s=t.style;return i=i||te(t),a=i?i.getPropertyValue(e)||i[e]:void 0,""!==a&&void 0!==a||lt.contains(t.ownerDocument,t)||(a=lt.style(t,e)),i&&!st.pixelMarginRight()&&Jt.test(a)&&$t.test(e)&&(n=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=i.width,s.width=n,s.minWidth=r,s.maxWidth=o),void 0!==a?a+"":a}function L(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function D(t){if(t in se)return t;for(var e=t[0].toUpperCase()+t.slice(1),i=ae.length;i--;)if(t=ae[i]+e,t in se)return t}function O(t,e,i){var n=It.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function I(t,e,i,n,r){for(var o=i===(n?"border":"content")?4:"width"===e?1:0,a=0;o<4;o+=2)"margin"===i&&(a+=lt.css(t,i+Nt[o],!0,r)),n?("content"===i&&(a-=lt.css(t,"padding"+Nt[o],!0,r)),"margin"!==i&&(a-=lt.css(t,"border"+Nt[o]+"Width",!0,r))):(a+=lt.css(t,"padding"+Nt[o],!0,r),"padding"!==i&&(a+=lt.css(t,"border"+Nt[o]+"Width",!0,r)));return a}function N(t,e,i){var n=!0,r="width"===e?t.offsetWidth:t.offsetHeight,o=te(t),a="border-box"===lt.css(t,"boxSizing",!1,o);if(r<=0||null==r){if(r=P(t,e,o),(r<0||null==r)&&(r=t.style[e]),Jt.test(r))return r;n=a&&(st.boxSizingReliable()||r===t.style[e]),r=parseFloat(r)||0}return r+I(t,e,i||(a?"border":"content"),n,o)+"px"}function F(t,e){for(var i,n,r,o=[],a=0,s=t.length;a<s;a++)n=t[a],n.style&&(o[a]=Rt.get(n,"olddisplay"),i=n.style.display,e?(o[a]||"none"!==i||(n.style.display=""),""===n.style.display&&Ft(n)&&(o[a]=Rt.access(n,"olddisplay",R(n.nodeName)))):(r=Ft(n),"none"===i&&r||Rt.set(n,"olddisplay",r?i:lt.css(n,"display"))));for(a=0;a<s;a++)n=t[a],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?o[a]||"":"none"));return t}function k(t,e,i,n,r){return new k.prototype.init(t,e,i,n,r)}function G(){return i.setTimeout(function(){ue=void 0}),ue=lt.now()}function U(t,e){var i,n=0,r={height:t};for(e=e?1:0;n<4;n+=2-e)i=Nt[n],r["margin"+i]=r["padding"+i]=t;return e&&(r.opacity=r.width=t),r}function z(t,e,i){for(var n,r=(V.tweeners[e]||[]).concat(V.tweeners["*"]),o=0,a=r.length;o<a;o++)if(n=r[o].call(i,e,t))return n}function B(t,e,i){var n,r,o,a,s,u,l,h,c=this,d={},f=t.style,p=t.nodeType&&Ft(t),m=Rt.get(t,"fxshow");i.queue||(s=lt._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,u=s.empty.fire,s.empty.fire=function(){s.unqueued||u()}),s.unqueued++,c.always(function(){c.always(function(){s.unqueued--,lt.queue(t,"fx").length||s.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],l=lt.css(t,"display"),h="none"===l?Rt.get(t,"olddisplay")||R(t.nodeName):l,"inline"===h&&"none"===lt.css(t,"float")&&(f.display="inline-block")),i.overflow&&(f.overflow="hidden",c.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]}));for(n in e)if(r=e[n],he.exec(r)){if(delete e[n],o=o||"toggle"===r,r===(p?"hide":"show")){if("show"!==r||!m||void 0===m[n])continue;p=!0}d[n]=m&&m[n]||lt.style(t,n)}else l=void 0;if(lt.isEmptyObject(d))"inline"===("none"===l?R(t.nodeName):l)&&(f.display=l);else{m?"hidden"in m&&(p=m.hidden):m=Rt.access(t,"fxshow",{}),o&&(m.hidden=!p),p?lt(t).show():c.done(function(){lt(t).hide()}),c.done(function(){var e;Rt.remove(t,"fxshow");for(e in d)lt.style(t,e,d[e])});for(n in d)a=z(p?m[n]:0,n,c),n in m||(m[n]=a.start,p&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}}function j(t,e){var i,n,r,o,a;for(i in t)if(n=lt.camelCase(i),r=e[n],o=t[i],lt.isArray(o)&&(r=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),a=lt.cssHooks[n],a&&"expand"in a){o=a.expand(o),delete t[n];for(i in o)i in t||(t[i]=o[i],e[i]=r)}else e[n]=r}function V(t,e,i){var n,r,o=0,a=V.prefilters.length,s=lt.Deferred().always(function(){delete u.elem}),u=function(){if(r)return!1;for(var e=ue||G(),i=Math.max(0,l.startTime+l.duration-e),n=i/l.duration||0,o=1-n,a=0,u=l.tweens.length;a<u;a++)l.tweens[a].run(o);return s.notifyWith(t,[l,o,i]),o<1&&u?i:(s.resolveWith(t,[l]),!1)},l=s.promise({elem:t,props:lt.extend({},e),opts:lt.extend(!0,{specialEasing:{},easing:lt.easing._default},i),originalProperties:e,originalOptions:i,startTime:ue||G(),duration:i.duration,tweens:[],createTween:function(e,i){var n=lt.Tween(t,l.opts,e,i,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var i=0,n=e?l.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)l.tweens[i].run(1);return e?(s.notifyWith(t,[l,1,0]),s.resolveWith(t,[l,e])):s.rejectWith(t,[l,e]),this}}),h=l.props;for(j(h,l.opts.specialEasing);o<a;o++)if(n=V.prefilters[o].call(l,t,h,l.opts))return lt.isFunction(n.stop)&&(lt._queueHooks(l.elem,l.opts.queue).stop=lt.proxy(n.stop,n)),n;return lt.map(h,z,l),lt.isFunction(l.opts.start)&&l.opts.start.call(t,l),lt.fx.timer(lt.extend(u,{elem:t,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function q(t){return t.getAttribute&&t.getAttribute("class")||""}function W(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,r=0,o=e.toLowerCase().match(At)||[];if(lt.isFunction(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function H(t,e,i,n){function r(s){var u;return o[s]=!0,lt.each(t[s]||[],function(t,s){var l=s(e,i,n);return"string"!=typeof l||a||o[l]?a?!(u=l):void 0:(e.dataTypes.unshift(l),r(l),!1)}),u}var o={},a=t===Pe;return r(e.dataTypes[0])||!o["*"]&&r("*")}function X(t,e){var i,n,r=lt.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((r[i]?t:n||(n={}))[i]=e[i]);return n&&lt.extend(!0,t,n),t}function K(t,e,i){for(var n,r,o,a,s=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(r in s)if(s[r]&&s[r].test(n)){u.unshift(r);break}if(u[0]in i)o=u[0];else{for(r in i){if(!u[0]||t.converters[r+" "+u[0]]){o=r;break}a||(a=r)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),i[o]}function Q(t,e,i,n){var r,o,a,s,u,l={},h=t.dataTypes.slice();if(h[1])for(a in t.converters)l[a.toLowerCase()]=t.converters[a];for(o=h.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!u&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=o,o=h.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(a=l[u+" "+o]||l["* "+o],!a)for(r in l)if(s=r.split(" "),s[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){a===!0?a=l[r]:l[r]!==!0&&(o=s[0],h.unshift(s[1]));break}if(a!==!0)if(a&&t["throws"])e=a(e);else try{e=a(e)}catch(c){return{state:"parsererror",error:a?c:"No conversion from "+u+" to "+o}}}return{state:"success",data:e}}function Y(t,e,i,n){var r;if(lt.isArray(e))lt.each(e,function(e,r){i||Ie.test(t)?n(t,r):Y(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,i,n)});else if(i||"object"!==lt.type(e))n(t,e);else for(r in e)Y(t+"["+r+"]",e[r],i,n)}function Z(t){return lt.isWindow(t)?t:9===t.nodeType&&t.defaultView}var $=[],J=i.document,tt=$.slice,et=$.concat,it=$.push,nt=$.indexOf,rt={},ot=rt.toString,at=rt.hasOwnProperty,st={},ut="2.2.4",lt=function(t,e){return new lt.fn.init(t,e)},ht=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ct=/^-ms-/,dt=/-([\da-z])/gi,ft=function(t,e){return e.toUpperCase()};lt.fn=lt.prototype={jquery:ut,constructor:lt,selector:"",length:0,toArray:function(){return tt.call(this)},get:function(t){return null!=t?t<0?this[t+this.length]:this[t]:tt.call(this)},pushStack:function(t){var e=lt.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t){return lt.each(this,t)},map:function(t){return this.pushStack(lt.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(tt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:it,sort:$.sort,splice:$.splice},lt.extend=lt.fn.extend=function(){var t,e,i,n,r,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||lt.isFunction(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(t=arguments[s]))for(e in t)i=a[e],n=t[e],a!==n&&(l&&n&&(lt.isPlainObject(n)||(r=lt.isArray(n)))?(r?(r=!1,o=i&&lt.isArray(i)?i:[]):o=i&&lt.isPlainObject(i)?i:{},a[e]=lt.extend(l,o,n)):void 0!==n&&(a[e]=n));return a},lt.extend({expando:"jQuery"+(ut+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===lt.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=t&&t.toString();return!lt.isArray(t)&&e-parseFloat(e)+1>=0},isPlainObject:function(t){var e;if("object"!==lt.type(t)||t.nodeType||lt.isWindow(t))return!1;if(t.constructor&&!at.call(t,"constructor")&&!at.call(t.constructor.prototype||{},"isPrototypeOf"))return!1;for(e in t);return void 0===e||at.call(t,e)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?rt[ot.call(t)]||"object":typeof t},globalEval:function(t){var e,i=eval;t=lt.trim(t),t&&(1===t.indexOf("use strict")?(e=J.createElement("script"),e.text=t,J.head.appendChild(e).parentNode.removeChild(e)):i(t))},camelCase:function(t){return t.replace(ct,"ms-").replace(dt,ft)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var i,n=0;if(a(t))for(i=t.length;n<i&&e.call(t[n],n,t[n])!==!1;n++);else for(n in t)if(e.call(t[n],n,t[n])===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(ht,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(a(Object(t))?lt.merge(i,"string"==typeof t?[t]:t):it.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:nt.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;n<i;n++)t[r++]=e[n];return t.length=r,t},grep:function(t,e,i){for(var n,r=[],o=0,a=t.length,s=!i;o<a;o++)n=!e(t[o],o),n!==s&&r.push(t[o]);return r},map:function(t,e,i){var n,r,o=0,s=[];if(a(t))for(n=t.length;o<n;o++)r=e(t[o],o,i),null!=r&&s.push(r);else for(o in t)r=e(t[o],o,i),null!=r&&s.push(r);return et.apply([],s)},guid:1,proxy:function(t,e){var i,n,r;if("string"==typeof e&&(i=t[e],e=t,t=i),lt.isFunction(t))return n=tt.call(arguments,2),r=function(){return t.apply(e||this,n.concat(tt.call(arguments)))},r.guid=t.guid=t.guid||lt.guid++,r},now:Date.now,support:st}),"function"==typeof Symbol&&(lt.fn[Symbol.iterator]=$[Symbol.iterator]),lt.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){rt["[object "+e+"]"]=e.toLowerCase()});var pt=function(t){function e(t,e,i,n){var r,o,a,s,u,l,c,f,p=e&&e.ownerDocument,m=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==m&&9!==m&&11!==m)return i;if(!n&&((e?e.ownerDocument||e:z)!==D&&L(e),e=e||D,I)){if(11!==m&&(l=gt.exec(t)))if(r=l[1]){if(9===m){if(!(a=e.getElementById(r)))return i;if(a.id===r)return i.push(a),i}else if(p&&(a=p.getElementById(r))&&G(e,a)&&a.id===r)return i.push(a),i}else{if(l[2])return $.apply(i,e.getElementsByTagName(t)),i;if((r=l[3])&&b.getElementsByClassName&&e.getElementsByClassName)return $.apply(i,e.getElementsByClassName(r)),i}if(b.qsa&&!W[t+" "]&&(!N||!N.test(t))){if(1!==m)p=e,f=t;else if("object"!==e.nodeName.toLowerCase()){for((s=e.getAttribute("id"))?s=s.replace(xt,"\\$&"):e.setAttribute("id",s=U),c=A(t),o=c.length,u=dt.test(s)?"#"+s:"[id='"+s+"']";o--;)c[o]=u+" "+d(c[o]);f=c.join(","),p=yt.test(t)&&h(e.parentNode)||e}if(f)try{return $.apply(i,p.querySelectorAll(f)),i}catch(v){}finally{s===U&&e.removeAttribute("id")}}}return C(t.replace(st,"$1"),e,i,n)}function i(){function t(i,n){return e.push(i+" ")>w.cacheLength&&delete t[e.shift()],t[i+" "]=n}var e=[];return t}function n(t){return t[U]=!0,t}function r(t){var e=D.createElement("div");try{return!!t(e)}catch(i){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var i=t.split("|"),n=i.length;n--;)w.attrHandle[i[n]]=e}function a(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||X)-(~t.sourceIndex||X);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function s(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function u(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function l(t){return n(function(e){return e=+e,n(function(i,n){for(var r,o=t([],i.length,e),a=o.length;a--;)i[r=o[a]]&&(i[r]=!(n[r]=i[r]))})})}function h(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}function c(){}function d(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function f(t,e,i){var n=e.dir,r=i&&"parentNode"===n,o=j++;return e.first?function(e,i,o){for(;e=e[n];)if(1===e.nodeType||r)return t(e,i,o)}:function(e,i,a){var s,u,l,h=[B,o];if(a){for(;e=e[n];)if((1===e.nodeType||r)&&t(e,i,a))return!0}else for(;e=e[n];)if(1===e.nodeType||r){if(l=e[U]||(e[U]={}),u=l[e.uniqueID]||(l[e.uniqueID]={}),(s=u[n])&&s[0]===B&&s[1]===o)return h[2]=s[2];if(u[n]=h,h[2]=t(e,i,a))return!0}}}function p(t){return t.length>1?function(e,i,n){for(var r=t.length;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function m(t,i,n){for(var r=0,o=i.length;r<o;r++)e(t,i[r],n);return n}function v(t,e,i,n,r){for(var o,a=[],s=0,u=t.length,l=null!=e;s<u;s++)(o=t[s])&&(i&&!i(o,n,r)||(a.push(o),l&&e.push(s)));return a}function g(t,e,i,r,o,a){return r&&!r[U]&&(r=g(r)),o&&!o[U]&&(o=g(o,a)),n(function(n,a,s,u){var l,h,c,d=[],f=[],p=a.length,g=n||m(e||"*",s.nodeType?[s]:s,[]),y=!t||!n&&e?g:v(g,d,t,s,u),x=i?o||(n?t:p||r)?[]:a:y;if(i&&i(y,x,s,u),r)for(l=v(x,f),r(l,[],s,u),h=l.length;h--;)(c=l[h])&&(x[f[h]]=!(y[f[h]]=c));if(n){if(o||t){if(o){for(l=[],h=x.length;h--;)(c=x[h])&&l.push(y[h]=c);o(null,x=[],l,u)}for(h=x.length;h--;)(c=x[h])&&(l=o?tt(n,c):d[h])>-1&&(n[l]=!(a[l]=c))}}else x=v(x===a?x.splice(p,x.length):x),o?o(null,a,x,u):$.apply(a,x)})}function y(t){for(var e,i,n,r=t.length,o=w.relative[t[0].type],a=o||w.relative[" "],s=o?1:0,u=f(function(t){return t===e},a,!0),l=f(function(t){return tt(e,t)>-1},a,!0),h=[function(t,i,n){var r=!o&&(n||i!==S)||((e=i).nodeType?u(t,i,n):l(t,i,n));return e=null,r}];s<r;s++)if(i=w.relative[t[s].type])h=[f(p(h),i)];else{if(i=w.filter[t[s].type].apply(null,t[s].matches),i[U]){for(n=++s;n<r&&!w.relative[t[n].type];n++);return g(s>1&&p(h),s>1&&d(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(st,"$1"),i,s<n&&y(t.slice(s,n)),n<r&&y(t=t.slice(n)),n<r&&d(t))}h.push(i)}return p(h)}function x(t,i){var r=i.length>0,o=t.length>0,a=function(n,a,s,u,l){var h,c,d,f=0,p="0",m=n&&[],g=[],y=S,x=n||o&&w.find.TAG("*",l),_=B+=null==y?1:Math.random()||.1,b=x.length;for(l&&(S=a===D||a||l);p!==b&&null!=(h=x[p]);p++){if(o&&h){for(c=0,a||h.ownerDocument===D||(L(h),s=!I);d=t[c++];)if(d(h,a||D,s)){u.push(h);break}l&&(B=_)}r&&((h=!d&&h)&&f--,n&&m.push(h))}if(f+=p,r&&p!==f){for(c=0;d=i[c++];)d(m,g,a,s);if(n){if(f>0)for(;p--;)m[p]||g[p]||(g[p]=Y.call(u));g=v(g)}$.apply(u,g),l&&!n&&g.length>0&&f+i.length>1&&e.uniqueSort(u)}return l&&(B=_,S=y),m};return r?n(a):a}var _,b,w,M,T,A,E,C,S,R,P,L,D,O,I,N,F,k,G,U="sizzle"+1*new Date,z=t.document,B=0,j=0,V=i(),q=i(),W=i(),H=function(t,e){return t===e&&(P=!0),0},X=1<<31,K={}.hasOwnProperty,Q=[],Y=Q.pop,Z=Q.push,$=Q.push,J=Q.slice,tt=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",it="[\\x20\\t\\r\\n\\f]",nt="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",rt="\\["+it+"*("+nt+")(?:"+it+"*([*^$|!~]?=)"+it+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+nt+"))|)"+it+"*\\]",ot=":("+nt+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+rt+")*)|.*)\\)|)",at=new RegExp(it+"+","g"),st=new RegExp("^"+it+"+|((?:^|[^\\\\])(?:\\\\.)*)"+it+"+$","g"),ut=new RegExp("^"+it+"*,"+it+"*"),lt=new RegExp("^"+it+"*([>+~]|"+it+")"+it+"*"),ht=new RegExp("="+it+"*([^\\]'\"]*?)"+it+"*\\]","g"),ct=new RegExp(ot),dt=new RegExp("^"+nt+"$"),ft={ID:new RegExp("^#("+nt+")"),CLASS:new RegExp("^\\.("+nt+")"),TAG:new RegExp("^("+nt+"|[*])"),ATTR:new RegExp("^"+rt),PSEUDO:new RegExp("^"+ot),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+it+"*(even|odd|(([+-]|)(\\d*)n|)"+it+"*(?:([+-]|)"+it+"*(\\d+)|))"+it+"*\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+it+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+it+"*((?:-\\d)?\\d*)"+it+"*\\)|)(?=[^-]|$)","i")},pt=/^(?:input|select|textarea|button)$/i,mt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,gt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,xt=/'|\\/g,_t=new RegExp("\\\\([\\da-f]{1,6}"+it+"?|("+it+")|.)","ig"),bt=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},wt=function(){L()};try{$.apply(Q=J.call(z.childNodes),z.childNodes),Q[z.childNodes.length].nodeType}catch(Mt){$={apply:Q.length?function(t,e){Z.apply(t,J.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}b=e.support={},T=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},L=e.setDocument=function(t){var e,i,n=t?t.ownerDocument||t:z;return n!==D&&9===n.nodeType&&n.documentElement?(D=n,O=D.documentElement,I=!T(D),(i=D.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",wt,!1):i.attachEvent&&i.attachEvent("onunload",wt)),b.attributes=r(function(t){return t.className="i",!t.getAttribute("className")}),b.getElementsByTagName=r(function(t){return t.appendChild(D.createComment("")),!t.getElementsByTagName("*").length}),b.getElementsByClassName=vt.test(D.getElementsByClassName),b.getById=r(function(t){return O.appendChild(t).id=U,!D.getElementsByName||!D.getElementsByName(U).length}),b.getById?(w.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&I){var i=e.getElementById(t);return i?[i]:[]}},w.filter.ID=function(t){var e=t.replace(_t,bt);return function(t){return t.getAttribute("id")===e}}):(delete w.find.ID,w.filter.ID=function(t){var e=t.replace(_t,bt);return function(t){var i="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}}),w.find.TAG=b.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):b.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},w.find.CLASS=b.getElementsByClassName&&function(t,e){if("undefined"!=typeof e.getElementsByClassName&&I)return e.getElementsByClassName(t)},F=[],N=[],(b.qsa=vt.test(D.querySelectorAll))&&(r(function(t){O.appendChild(t).innerHTML="<a id='"+U+"'></a><select id='"+U+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&N.push("[*^$]="+it+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||N.push("\\["+it+"*(?:value|"+et+")"),t.querySelectorAll("[id~="+U+"-]").length||N.push("~="),t.querySelectorAll(":checked").length||N.push(":checked"),t.querySelectorAll("a#"+U+"+*").length||N.push(".#.+[+~]")}),r(function(t){var e=D.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&N.push("name"+it+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||N.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),N.push(",.*:")})),(b.matchesSelector=vt.test(k=O.matches||O.webkitMatchesSelector||O.mozMatchesSelector||O.oMatchesSelector||O.msMatchesSelector))&&r(function(t){b.disconnectedMatch=k.call(t,"div"),k.call(t,"[s!='']:x"),F.push("!=",ot)}),N=N.length&&new RegExp(N.join("|")),F=F.length&&new RegExp(F.join("|")),e=vt.test(O.compareDocumentPosition),G=e||vt.test(O.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},H=e?function(t,e){if(t===e)return P=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i?i:(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&i||!b.sortDetached&&e.compareDocumentPosition(t)===i?t===D||t.ownerDocument===z&&G(z,t)?-1:e===D||e.ownerDocument===z&&G(z,e)?1:R?tt(R,t)-tt(R,e):0:4&i?-1:1)}:function(t,e){if(t===e)return P=!0,0;var i,n=0,r=t.parentNode,o=e.parentNode,s=[t],u=[e];if(!r||!o)return t===D?-1:e===D?1:r?-1:o?1:R?tt(R,t)-tt(R,e):0;if(r===o)return a(t,e);for(i=t;i=i.parentNode;)s.unshift(i);for(i=e;i=i.parentNode;)u.unshift(i);for(;s[n]===u[n];)n++;return n?a(s[n],u[n]):s[n]===z?-1:u[n]===z?1:0},D):D},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==D&&L(t),i=i.replace(ht,"='$1']"),b.matchesSelector&&I&&!W[i+" "]&&(!F||!F.test(i))&&(!N||!N.test(i)))try{var n=k.call(t,i);if(n||b.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(r){}return e(i,D,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==D&&L(t),G(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==D&&L(t);var i=w.attrHandle[e.toLowerCase()],n=i&&K.call(w.attrHandle,e.toLowerCase())?i(t,e,!I):void 0;return void 0!==n?n:b.attributes||!I?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],n=0,r=0;if(P=!b.detectDuplicates,R=!b.sortStable&&t.slice(0),t.sort(H),P){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return R=null,t},M=e.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=M(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=M(e);return i},w=e.selectors={cacheLength:50,createPseudo:n,match:ft,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(_t,bt),t[3]=(t[3]||t[4]||t[5]||"").replace(_t,bt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return ft.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&ct.test(i)&&(e=A(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(_t,bt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=V[t+" "];return e||(e=new RegExp("(^|"+it+")"+t+"("+it+"|$)"))&&V(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,i,n){return function(r){var o=e.attr(r,t);return null==o?"!="===i:!i||(o+="","="===i?o===n:"!="===i?o!==n:"^="===i?n&&0===o.indexOf(n):"*="===i?n&&o.indexOf(n)>-1:"$="===i?n&&o.slice(-n.length)===n:"~="===i?(" "+o.replace(at," ")+" ").indexOf(n)>-1:"|="===i&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,i,n,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,u){var l,h,c,d,f,p,m=o!==a?"nextSibling":"previousSibling",v=e.parentNode,g=s&&e.nodeName.toLowerCase(),y=!u&&!s,x=!1;if(v){if(o){for(;m;){for(d=e;d=d[m];)if(s?d.nodeName.toLowerCase()===g:1===d.nodeType)return!1;p=m="only"===t&&!p&&"nextSibling"}return!0}if(p=[a?v.firstChild:v.lastChild],a&&y){for(d=v,c=d[U]||(d[U]={}),h=c[d.uniqueID]||(c[d.uniqueID]={}),l=h[t]||[],f=l[0]===B&&l[1],x=f&&l[2],d=f&&v.childNodes[f];d=++f&&d&&d[m]||(x=f=0)||p.pop();)if(1===d.nodeType&&++x&&d===e){h[t]=[B,f,x];break}}else if(y&&(d=e,c=d[U]||(d[U]={}),h=c[d.uniqueID]||(c[d.uniqueID]={}),l=h[t]||[],f=l[0]===B&&l[1],x=f),x===!1)for(;(d=++f&&d&&d[m]||(x=f=0)||p.pop())&&((s?d.nodeName.toLowerCase()!==g:1!==d.nodeType)||!++x||(y&&(c=d[U]||(d[U]={}),h=c[d.uniqueID]||(c[d.uniqueID]={}),h[t]=[B,x]),d!==e)););return x-=r,x===n||x%n===0&&x/n>=0}}},PSEUDO:function(t,i){var r,o=w.pseudos[t]||w.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[U]?o(i):o.length>1?(r=[t,t,"",i],w.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,r=o(t,i),a=r.length;a--;)n=tt(t,r[a]),t[n]=!(e[n]=r[a])}):function(t){return o(t,0,r)}):o}},pseudos:{not:n(function(t){var e=[],i=[],r=E(t.replace(st,"$1"));return r[U]?n(function(t,e,i,n){for(var o,a=r(t,null,n,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,n,o){return e[0]=t,r(e,null,o,i),e[0]=null,!i.pop()}}),has:n(function(t){return function(i){return e(t,i).length>0}}),contains:n(function(t){return t=t.replace(_t,bt),function(e){return(e.textContent||e.innerText||M(e)).indexOf(t)>-1}}),lang:n(function(t){return dt.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(_t,bt).toLowerCase(),function(e){var i;do if(i=I?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===O},focus:function(t){return t===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();
return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!w.pseudos.empty(t)},header:function(t){return mt.test(t.nodeName)},input:function(t){return pt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:l(function(){return[0]}),last:l(function(t,e){return[e-1]}),eq:l(function(t,e,i){return[i<0?i+e:i]}),even:l(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:l(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:l(function(t,e,i){for(var n=i<0?i+e:i;--n>=0;)t.push(n);return t}),gt:l(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}},w.pseudos.nth=w.pseudos.eq;for(_ in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[_]=s(_);for(_ in{submit:!0,reset:!0})w.pseudos[_]=u(_);return c.prototype=w.filters=w.pseudos,w.setFilters=new c,A=e.tokenize=function(t,i){var n,r,o,a,s,u,l,h=q[t+" "];if(h)return i?0:h.slice(0);for(s=t,u=[],l=w.preFilter;s;){n&&!(r=ut.exec(s))||(r&&(s=s.slice(r[0].length)||s),u.push(o=[])),n=!1,(r=lt.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(st," ")}),s=s.slice(n.length));for(a in w.filter)!(r=ft[a].exec(s))||l[a]&&!(r=l[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return i?s.length:s?e.error(t):q(t,u).slice(0)},E=e.compile=function(t,e){var i,n=[],r=[],o=W[t+" "];if(!o){for(e||(e=A(t)),i=e.length;i--;)o=y(e[i]),o[U]?n.push(o):r.push(o);o=W(t,x(r,n)),o.selector=t}return o},C=e.select=function(t,e,i,n){var r,o,a,s,u,l="function"==typeof t&&t,c=!n&&A(t=l.selector||t);if(i=i||[],1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&b.getById&&9===e.nodeType&&I&&w.relative[o[1].type]){if(e=(w.find.ID(a.matches[0].replace(_t,bt),e)||[])[0],!e)return i;l&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=ft.needsContext.test(t)?0:o.length;r--&&(a=o[r],!w.relative[s=a.type]);)if((u=w.find[s])&&(n=u(a.matches[0].replace(_t,bt),yt.test(o[0].type)&&h(e.parentNode)||e))){if(o.splice(r,1),t=n.length&&d(o),!t)return $.apply(i,n),i;break}}return(l||E(t,c))(n,e,!I,i,!e||yt.test(t)&&h(e.parentNode)||e),i},b.sortStable=U.split("").sort(H).join("")===U,b.detectDuplicates=!!P,L(),b.sortDetached=r(function(t){return 1&t.compareDocumentPosition(D.createElement("div"))}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),b.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||o(et,function(t,e,i){var n;if(!i)return t[e]===!0?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(i);lt.find=pt,lt.expr=pt.selectors,lt.expr[":"]=lt.expr.pseudos,lt.uniqueSort=lt.unique=pt.uniqueSort,lt.text=pt.getText,lt.isXMLDoc=pt.isXML,lt.contains=pt.contains;var mt=function(t,e,i){for(var n=[],r=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&lt(t).is(i))break;n.push(t)}return n},vt=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},gt=lt.expr.match.needsContext,yt=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,xt=/^.[^:#\[\.,]*$/;lt.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?lt.find.matchesSelector(n,t)?[n]:[]:lt.find.matches(t,lt.grep(e,function(t){return 1===t.nodeType}))},lt.fn.extend({find:function(t){var e,i=this.length,n=[],r=this;if("string"!=typeof t)return this.pushStack(lt(t).filter(function(){for(e=0;e<i;e++)if(lt.contains(r[e],this))return!0}));for(e=0;e<i;e++)lt.find(t,r[e],n);return n=this.pushStack(i>1?lt.unique(n):n),n.selector=this.selector?this.selector+" "+t:t,n},filter:function(t){return this.pushStack(s(this,t||[],!1))},not:function(t){return this.pushStack(s(this,t||[],!0))},is:function(t){return!!s(this,"string"==typeof t&&gt.test(t)?lt(t):t||[],!1).length}});var _t,bt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,wt=lt.fn.init=function(t,e,i){var n,r;if(!t)return this;if(i=i||_t,"string"==typeof t){if(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:bt.exec(t),!n||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof lt?e[0]:e,lt.merge(this,lt.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:J,!0)),yt.test(n[1])&&lt.isPlainObject(e))for(n in e)lt.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return r=J.getElementById(n[2]),r&&r.parentNode&&(this.length=1,this[0]=r),this.context=J,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):lt.isFunction(t)?void 0!==i.ready?i.ready(t):t(lt):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),lt.makeArray(t,this))};wt.prototype=lt.fn,_t=lt(J);var Mt=/^(?:parents|prev(?:Until|All))/,Tt={children:!0,contents:!0,next:!0,prev:!0};lt.fn.extend({has:function(t){var e=lt(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(lt.contains(this,e[t]))return!0})},closest:function(t,e){for(var i,n=0,r=this.length,o=[],a=gt.test(t)||"string"!=typeof t?lt(t,e||this.context):0;n<r;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&lt.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(o.length>1?lt.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?nt.call(lt(t),this[0]):nt.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(lt.uniqueSort(lt.merge(this.get(),lt(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),lt.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return mt(t,"parentNode")},parentsUntil:function(t,e,i){return mt(t,"parentNode",i)},next:function(t){return u(t,"nextSibling")},prev:function(t){return u(t,"previousSibling")},nextAll:function(t){return mt(t,"nextSibling")},prevAll:function(t){return mt(t,"previousSibling")},nextUntil:function(t,e,i){return mt(t,"nextSibling",i)},prevUntil:function(t,e,i){return mt(t,"previousSibling",i)},siblings:function(t){return vt((t.parentNode||{}).firstChild,t)},children:function(t){return vt(t.firstChild)},contents:function(t){return t.contentDocument||lt.merge([],t.childNodes)}},function(t,e){lt.fn[t]=function(i,n){var r=lt.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=lt.filter(n,r)),this.length>1&&(Tt[t]||lt.uniqueSort(r),Mt.test(t)&&r.reverse()),this.pushStack(r)}});var At=/\S+/g;lt.Callbacks=function(t){t="string"==typeof t?l(t):lt.extend({},t);var e,i,n,r,o=[],a=[],s=-1,u=function(){for(r=t.once,n=e=!0;a.length;s=-1)for(i=a.shift();++s<o.length;)o[s].apply(i[0],i[1])===!1&&t.stopOnFalse&&(s=o.length,i=!1);t.memory||(i=!1),e=!1,r&&(o=i?[]:"")},h={add:function(){return o&&(i&&!e&&(s=o.length-1,a.push(i)),function n(e){lt.each(e,function(e,i){lt.isFunction(i)?t.unique&&h.has(i)||o.push(i):i&&i.length&&"string"!==lt.type(i)&&n(i)})}(arguments),i&&!e&&u()),this},remove:function(){return lt.each(arguments,function(t,e){for(var i;(i=lt.inArray(e,o,i))>-1;)o.splice(i,1),i<=s&&s--}),this},has:function(t){return t?lt.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=a=[],o=i="",this},disabled:function(){return!o},lock:function(){return r=a=[],i||(o=i=""),this},locked:function(){return!!r},fireWith:function(t,i){return r||(i=i||[],i=[t,i.slice?i.slice():i],a.push(i),e||u()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!n}};return h},lt.extend({Deferred:function(t){var e=[["resolve","done",lt.Callbacks("once memory"),"resolved"],["reject","fail",lt.Callbacks("once memory"),"rejected"],["notify","progress",lt.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return lt.Deferred(function(i){lt.each(e,function(e,o){var a=lt.isFunction(t[e])&&t[e];r[o[1]](function(){var t=a&&a.apply(this,arguments);t&&lt.isFunction(t.promise)?t.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[o[0]+"With"](this===n?i.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?lt.extend(t,n):n}},r={};return n.pipe=n.then,lt.each(e,function(t,o){var a=o[2],s=o[3];n[o[1]]=a.add,s&&a.add(function(){i=s},e[1^t][2].disable,e[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?n:this,arguments),this},r[o[0]+"With"]=a.fireWith}),n.promise(r),t&&t.call(r,r),r},when:function(t){var e,i,n,r=0,o=tt.call(arguments),a=o.length,s=1!==a||t&&lt.isFunction(t.promise)?a:0,u=1===s?t:lt.Deferred(),l=function(t,i,n){return function(r){i[t]=this,n[t]=arguments.length>1?tt.call(arguments):r,n===e?u.notifyWith(i,n):--s||u.resolveWith(i,n)}};if(a>1)for(e=new Array(a),i=new Array(a),n=new Array(a);r<a;r++)o[r]&&lt.isFunction(o[r].promise)?o[r].promise().progress(l(r,i,e)).done(l(r,n,o)).fail(u.reject):--s;return s||u.resolveWith(n,o),u.promise()}});var Et;lt.fn.ready=function(t){return lt.ready.promise().done(t),this},lt.extend({isReady:!1,readyWait:1,holdReady:function(t){t?lt.readyWait++:lt.ready(!0)},ready:function(t){(t===!0?--lt.readyWait:lt.isReady)||(lt.isReady=!0,t!==!0&&--lt.readyWait>0||(Et.resolveWith(J,[lt]),lt.fn.triggerHandler&&(lt(J).triggerHandler("ready"),lt(J).off("ready"))))}}),lt.ready.promise=function(t){return Et||(Et=lt.Deferred(),"complete"===J.readyState||"loading"!==J.readyState&&!J.documentElement.doScroll?i.setTimeout(lt.ready):(J.addEventListener("DOMContentLoaded",h),i.addEventListener("load",h))),Et.promise(t)},lt.ready.promise();var Ct=function(t,e,i,n,r,o,a){var s=0,u=t.length,l=null==i;if("object"===lt.type(i)){r=!0;for(s in i)Ct(t,e,s,i[s],!0,o,a)}else if(void 0!==n&&(r=!0,lt.isFunction(n)||(a=!0),l&&(a?(e.call(t,n),e=null):(l=e,e=function(t,e,i){return l.call(lt(t),i)})),e))for(;s<u;s++)e(t[s],i,a?n:n.call(t[s],s,e(t[s],i)));return r?t:l?e.call(t):u?e(t[0],i):o},St=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};c.uid=1,c.prototype={register:function(t,e){var i=e||{};return t.nodeType?t[this.expando]=i:Object.defineProperty(t,this.expando,{value:i,writable:!0,configurable:!0}),t[this.expando]},cache:function(t){if(!St(t))return{};var e=t[this.expando];return e||(e={},St(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,r=this.cache(t);if("string"==typeof e)r[e]=i;else for(n in e)r[n]=e[n];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][e]},access:function(t,e,i){var n;return void 0===e||e&&"string"==typeof e&&void 0===i?(n=this.get(t,e),void 0!==n?n:this.get(t,lt.camelCase(e))):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n,r,o=t[this.expando];if(void 0!==o){if(void 0===e)this.register(t);else{lt.isArray(e)?n=e.concat(e.map(lt.camelCase)):(r=lt.camelCase(e),e in o?n=[e,r]:(n=r,n=n in o?[n]:n.match(At)||[])),i=n.length;for(;i--;)delete o[n[i]]}(void 0===e||lt.isEmptyObject(o))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!lt.isEmptyObject(e)}};var Rt=new c,Pt=new c,Lt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Dt=/[A-Z]/g;lt.extend({hasData:function(t){return Pt.hasData(t)||Rt.hasData(t)},data:function(t,e,i){return Pt.access(t,e,i)},removeData:function(t,e){Pt.remove(t,e)},_data:function(t,e,i){return Rt.access(t,e,i)},_removeData:function(t,e){Rt.remove(t,e)}}),lt.fn.extend({data:function(t,e){var i,n,r,o=this[0],a=o&&o.attributes;if(void 0===t){if(this.length&&(r=Pt.get(o),1===o.nodeType&&!Rt.get(o,"hasDataAttrs"))){for(i=a.length;i--;)a[i]&&(n=a[i].name,0===n.indexOf("data-")&&(n=lt.camelCase(n.slice(5)),d(o,n,r[n])));Rt.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each(function(){Pt.set(this,t)}):Ct(this,function(e){var i,n;if(o&&void 0===e){if(i=Pt.get(o,t)||Pt.get(o,t.replace(Dt,"-$&").toLowerCase()),void 0!==i)return i;if(n=lt.camelCase(t),i=Pt.get(o,n),void 0!==i)return i;if(i=d(o,n,void 0),void 0!==i)return i}else n=lt.camelCase(t),this.each(function(){var i=Pt.get(this,n);Pt.set(this,n,e),t.indexOf("-")>-1&&void 0!==i&&Pt.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){Pt.remove(this,t)})}}),lt.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=Rt.get(t,e),i&&(!n||lt.isArray(i)?n=Rt.access(t,e,lt.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=lt.queue(t,e),n=i.length,r=i.shift(),o=lt._queueHooks(t,e),a=function(){lt.dequeue(t,e)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete o.stop,r.call(t,a,o)),!n&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return Rt.get(t,i)||Rt.access(t,i,{empty:lt.Callbacks("once memory").add(function(){Rt.remove(t,[e+"queue",i])})})}}),lt.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?lt.queue(this[0],t):void 0===e?this:this.each(function(){var i=lt.queue(this,t,e);lt._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&lt.dequeue(this,t)})},dequeue:function(t){return this.each(function(){lt.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,r=lt.Deferred(),o=this,a=this.length,s=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)i=Rt.get(o[a],t+"queueHooks"),i&&i.empty&&(n++,i.empty.add(s));return s(),r.promise(e)}});var Ot=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,It=new RegExp("^(?:([+-])=|)("+Ot+")([a-z%]*)$","i"),Nt=["Top","Right","Bottom","Left"],Ft=function(t,e){return t=e||t,"none"===lt.css(t,"display")||!lt.contains(t.ownerDocument,t)},kt=/^(?:checkbox|radio)$/i,Gt=/<([\w:-]+)/,Ut=/^$|\/(?:java|ecma)script/i,zt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};zt.optgroup=zt.option,zt.tbody=zt.tfoot=zt.colgroup=zt.caption=zt.thead,zt.th=zt.td;var Bt=/<|&#?\w+;/;!function(){var t=J.createDocumentFragment(),e=t.appendChild(J.createElement("div")),i=J.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),e.appendChild(i),st.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",st.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var jt=/^key/,Vt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,qt=/^([^.]*)(?:\.(.+)|)/;lt.event={global:{},add:function(t,e,i,n,r){var o,a,s,u,l,h,c,d,f,p,m,v=Rt.get(t);if(v)for(i.handler&&(o=i,i=o.handler,r=o.selector),i.guid||(i.guid=lt.guid++),(u=v.events)||(u=v.events={}),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof lt&&lt.event.triggered!==e.type?lt.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(At)||[""],l=e.length;l--;)s=qt.exec(e[l])||[],f=m=s[1],p=(s[2]||"").split(".").sort(),f&&(c=lt.event.special[f]||{},f=(r?c.delegateType:c.bindType)||f,c=lt.event.special[f]||{},h=lt.extend({type:f,origType:m,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&lt.expr.match.needsContext.test(r),namespace:p.join(".")},o),(d=u[f])||(d=u[f]=[],d.delegateCount=0,c.setup&&c.setup.call(t,n,p,a)!==!1||t.addEventListener&&t.addEventListener(f,a)),c.add&&(c.add.call(t,h),h.handler.guid||(h.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,h):d.push(h),lt.event.global[f]=!0)},remove:function(t,e,i,n,r){var o,a,s,u,l,h,c,d,f,p,m,v=Rt.hasData(t)&&Rt.get(t);if(v&&(u=v.events)){for(e=(e||"").match(At)||[""],l=e.length;l--;)if(s=qt.exec(e[l])||[],f=m=s[1],p=(s[2]||"").split(".").sort(),f){for(c=lt.event.special[f]||{},f=(n?c.delegateType:c.bindType)||f,d=u[f]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=d.length;o--;)h=d[o],!r&&m!==h.origType||i&&i.guid!==h.guid||s&&!s.test(h.namespace)||n&&n!==h.selector&&("**"!==n||!h.selector)||(d.splice(o,1),h.selector&&d.delegateCount--,c.remove&&c.remove.call(t,h));a&&!d.length&&(c.teardown&&c.teardown.call(t,p,v.handle)!==!1||lt.removeEvent(t,f,v.handle),delete u[f])}else for(f in u)lt.event.remove(t,f+e[l],i,n,!0);lt.isEmptyObject(u)&&Rt.remove(t,"handle events")}},dispatch:function(t){t=lt.event.fix(t);var e,i,n,r,o,a=[],s=tt.call(arguments),u=(Rt.get(this,"events")||{})[t.type]||[],l=lt.event.special[t.type]||{};if(s[0]=t,t.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,t)!==!1){for(a=lt.event.handlers.call(this,t,u),e=0;(r=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,i=0;(o=r.handlers[i++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(o.namespace)||(t.handleObj=o,t.data=o.data,n=((lt.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,s),void 0!==n&&(t.result=n)===!1&&(t.preventDefault(),t.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,r,o,a=[],s=e.delegateCount,u=t.target;if(s&&u.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&(u.disabled!==!0||"click"!==t.type)){for(n=[],i=0;i<s;i++)o=e[i],r=o.selector+" ",void 0===n[r]&&(n[r]=o.needsContext?lt(r,this).index(u)>-1:lt.find(r,this,null,[u]).length),n[r]&&n.push(o);n.length&&a.push({elem:u,handlers:n})}return s<e.length&&a.push({elem:this,handlers:e.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,r,o=e.button;return null==t.pageX&&null!=e.clientX&&(i=t.target.ownerDocument||J,n=i.documentElement,r=i.body,t.pageX=e.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n&&n.clientLeft||r&&r.clientLeft||0),t.pageY=e.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n&&n.clientTop||r&&r.clientTop||0)),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},fix:function(t){if(t[lt.expando])return t;var e,i,n,r=t.type,o=t,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=Vt.test(r)?this.mouseHooks:jt.test(r)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,t=new lt.Event(o),e=n.length;e--;)i=n[e],t[i]=o[i];return t.target||(t.target=J),3===t.target.nodeType&&(t.target=t.target.parentNode),a.filter?a.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==x()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===x()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&lt.nodeName(this,"input"))return this.click(),!1},_default:function(t){return lt.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},lt.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},lt.Event=function(t,e){return this instanceof lt.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?g:y):this.type=t,e&&lt.extend(this,e),this.timeStamp=t&&t.timeStamp||lt.now(),void(this[lt.expando]=!0)):new lt.Event(t,e)},lt.Event.prototype={constructor:lt.Event,isDefaultPrevented:y,isPropagationStopped:y,isImmediatePropagationStopped:y,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=g,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=g,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=g,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},lt.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){lt.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,r=t.relatedTarget,o=t.handleObj;return r&&(r===n||lt.contains(n,r))||(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}}),lt.fn.extend({on:function(t,e,i,n){return _(this,t,e,i,n)},one:function(t,e,i,n){return _(this,t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,lt(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return e!==!1&&"function"!=typeof e||(i=e,e=void 0),i===!1&&(i=y),this.each(function(){lt.event.remove(this,t,i,e)})}});var Wt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Ht=/<script|<style|<link/i,Xt=/checked\s*(?:[^=]|=\s*.checked.)/i,Kt=/^true\/(.*)/,Qt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;lt.extend({htmlPrefilter:function(t){return t.replace(Wt,"<$1></$2>")},clone:function(t,e,i){var n,r,o,a,s=t.cloneNode(!0),u=lt.contains(t.ownerDocument,t);if(!(st.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||lt.isXMLDoc(t)))for(a=p(s),o=p(t),n=0,r=o.length;n<r;n++)A(o[n],a[n]);if(e)if(i)for(o=o||p(t),a=a||p(s),n=0,r=o.length;n<r;n++)T(o[n],a[n]);else T(t,s);return a=p(s,"script"),a.length>0&&m(a,!u&&p(t,"script")),s},cleanData:function(t){for(var e,i,n,r=lt.event.special,o=0;void 0!==(i=t[o]);o++)if(St(i)){if(e=i[Rt.expando]){if(e.events)for(n in e.events)r[n]?lt.event.remove(i,n):lt.removeEvent(i,n,e.handle);i[Rt.expando]=void 0}i[Pt.expando]&&(i[Pt.expando]=void 0)}}}),lt.fn.extend({domManip:E,detach:function(t){return C(this,t,!0)},remove:function(t){return C(this,t)},text:function(t){return Ct(this,function(t){return void 0===t?lt.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return E(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=b(this,t);e.appendChild(t)}})},prepend:function(){return E(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=b(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return E(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return E(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(lt.cleanData(p(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return lt.clone(this,t,e)})},html:function(t){return Ct(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Ht.test(t)&&!zt[(Gt.exec(t)||["",""])[1].toLowerCase()]){t=lt.htmlPrefilter(t);try{for(;i<n;i++)e=this[i]||{},1===e.nodeType&&(lt.cleanData(p(e,!1)),e.innerHTML=t);e=0}catch(r){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return E(this,arguments,function(e){var i=this.parentNode;lt.inArray(this,t)<0&&(lt.cleanData(p(this)),i&&i.replaceChild(e,this))},t)}}),lt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){lt.fn[t]=function(t){for(var i,n=[],r=lt(t),o=r.length-1,a=0;a<=o;a++)i=a===o?this:this.clone(!0),lt(r[a])[e](i),it.apply(n,i.get());return this.pushStack(n)}});var Yt,Zt={HTML:"block",BODY:"block"},$t=/^margin/,Jt=new RegExp("^("+Ot+")(?!px)[a-z%]+$","i"),te=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=i),e.getComputedStyle(t)},ee=function(t,e,i,n){var r,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];r=i.apply(t,n||[]);for(o in e)t.style[o]=a[o];return r},ie=J.documentElement;!function(){function t(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",s.innerHTML="",ie.appendChild(a);var t=i.getComputedStyle(s);e="1%"!==t.top,o="2px"===t.marginLeft,n="4px"===t.width,s.style.marginRight="50%",r="4px"===t.marginRight,ie.removeChild(a)}var e,n,r,o,a=J.createElement("div"),s=J.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",st.clearCloneStyle="content-box"===s.style.backgroundClip,a.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",a.appendChild(s),lt.extend(st,{pixelPosition:function(){return t(),e},boxSizingReliable:function(){return null==n&&t(),n},pixelMarginRight:function(){return null==n&&t(),r},reliableMarginLeft:function(){return null==n&&t(),o},reliableMarginRight:function(){var t,e=s.appendChild(J.createElement("div"));return e.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",s.style.width="1px",ie.appendChild(a),t=!parseFloat(i.getComputedStyle(e).marginRight),ie.removeChild(a),s.removeChild(e),t}}))}();var ne=/^(none|table(?!-c[ea]).+)/,re={position:"absolute",visibility:"hidden",display:"block"},oe={letterSpacing:"0",fontWeight:"400"},ae=["Webkit","O","Moz","ms"],se=J.createElement("div").style;lt.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=P(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,a,s=lt.camelCase(e),u=t.style;return e=lt.cssProps[s]||(lt.cssProps[s]=D(s)||s),a=lt.cssHooks[e]||lt.cssHooks[s],void 0===i?a&&"get"in a&&void 0!==(r=a.get(t,!1,n))?r:u[e]:(o=typeof i,"string"===o&&(r=It.exec(i))&&r[1]&&(i=f(t,e,r),o="number"),null!=i&&i===i&&("number"===o&&(i+=r&&r[3]||(lt.cssNumber[s]?"":"px")),st.clearCloneStyle||""!==i||0!==e.indexOf("background")||(u[e]="inherit"),a&&"set"in a&&void 0===(i=a.set(t,i,n))||(u[e]=i)),void 0)}},css:function(t,e,i,n){var r,o,a,s=lt.camelCase(e);return e=lt.cssProps[s]||(lt.cssProps[s]=D(s)||s),a=lt.cssHooks[e]||lt.cssHooks[s],a&&"get"in a&&(r=a.get(t,!0,i)),void 0===r&&(r=P(t,e,n)),"normal"===r&&e in oe&&(r=oe[e]),""===i||i?(o=parseFloat(r),i===!0||isFinite(o)?o||0:r):r}}),lt.each(["height","width"],function(t,e){lt.cssHooks[e]={get:function(t,i,n){if(i)return ne.test(lt.css(t,"display"))&&0===t.offsetWidth?ee(t,re,function(){return N(t,e,n)}):N(t,e,n)},set:function(t,i,n){var r,o=n&&te(t),a=n&&I(t,e,n,"border-box"===lt.css(t,"boxSizing",!1,o),o);return a&&(r=It.exec(i))&&"px"!==(r[3]||"px")&&(t.style[e]=i,i=lt.css(t,e)),O(t,i,a)}}}),lt.cssHooks.marginLeft=L(st.reliableMarginLeft,function(t,e){if(e)return(parseFloat(P(t,"marginLeft"))||t.getBoundingClientRect().left-ee(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),lt.cssHooks.marginRight=L(st.reliableMarginRight,function(t,e){if(e)return ee(t,{display:"inline-block"},P,[t,"marginRight"])}),lt.each({margin:"",padding:"",border:"Width"},function(t,e){lt.cssHooks[t+e]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];n<4;n++)r[t+Nt[n]+e]=o[n]||o[n-2]||o[0];return r}},$t.test(t)||(lt.cssHooks[t+e].set=O)}),lt.fn.extend({css:function(t,e){return Ct(this,function(t,e,i){var n,r,o={},a=0;if(lt.isArray(e)){for(n=te(t),r=e.length;a<r;a++)o[e[a]]=lt.css(t,e[a],!1,n);return o}return void 0!==i?lt.style(t,e,i):lt.css(t,e)},t,e,arguments.length>1)},show:function(){return F(this,!0)},hide:function(){return F(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Ft(this)?lt(this).show():lt(this).hide()})}}),lt.Tween=k,k.prototype={constructor:k,init:function(t,e,i,n,r,o){this.elem=t,this.prop=i,this.easing=r||lt.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(lt.cssNumber[i]?"":"px")},cur:function(){var t=k.propHooks[this.prop];return t&&t.get?t.get(this):k.propHooks._default.get(this)},run:function(t){var e,i=k.propHooks[this.prop];return this.options.duration?this.pos=e=lt.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):k.propHooks._default.set(this),this}},k.prototype.init.prototype=k.prototype,k.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=lt.css(t.elem,t.prop,""),e&&"auto"!==e?e:0)},set:function(t){lt.fx.step[t.prop]?lt.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[lt.cssProps[t.prop]]&&!lt.cssHooks[t.prop]?t.elem[t.prop]=t.now:lt.style(t.elem,t.prop,t.now+t.unit)}}},k.propHooks.scrollTop=k.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},lt.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},lt.fx=k.prototype.init,lt.fx.step={};var ue,le,he=/^(?:toggle|show|hide)$/,ce=/queueHooks$/;lt.Animation=lt.extend(V,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return f(i.elem,t,It.exec(e),i),i}]},tweener:function(t,e){lt.isFunction(t)?(e=t,t=["*"]):t=t.match(At);for(var i,n=0,r=t.length;n<r;n++)i=t[n],V.tweeners[i]=V.tweeners[i]||[],V.tweeners[i].unshift(e)},prefilters:[B],prefilter:function(t,e){e?V.prefilters.unshift(t):V.prefilters.push(t)}}),lt.speed=function(t,e,i){var n=t&&"object"==typeof t?lt.extend({},t):{complete:i||!i&&e||lt.isFunction(t)&&t,duration:t,easing:i&&e||e&&!lt.isFunction(e)&&e};return n.duration=lt.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in lt.fx.speeds?lt.fx.speeds[n.duration]:lt.fx.speeds._default,null!=n.queue&&n.queue!==!0||(n.queue="fx"),n.old=n.complete,n.complete=function(){lt.isFunction(n.old)&&n.old.call(this),n.queue&&lt.dequeue(this,n.queue)},n},lt.fn.extend({fadeTo:function(t,e,i,n){return this.filter(Ft).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var r=lt.isEmptyObject(t),o=lt.speed(e,i,n),a=function(){var e=V(this,lt.extend({},t),o);(r||Rt.get(this,"finish"))&&e.stop(!0)};return a.finish=a,r||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=lt.timers,a=Rt.get(this);if(r)a[r]&&a[r].stop&&n(a[r]);else for(r in a)a[r]&&a[r].stop&&ce.test(r)&&n(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(i),e=!1,o.splice(r,1));!e&&i||lt.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=Rt.get(this),n=i[t+"queue"],r=i[t+"queueHooks"],o=lt.timers,a=n?n.length:0;
for(i.finish=!0,lt.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<a;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),lt.each(["toggle","show","hide"],function(t,e){var i=lt.fn[e];lt.fn[e]=function(t,n,r){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(U(e,!0),t,n,r)}}),lt.each({slideDown:U("show"),slideUp:U("hide"),slideToggle:U("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){lt.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),lt.timers=[],lt.fx.tick=function(){var t,e=0,i=lt.timers;for(ue=lt.now();e<i.length;e++)t=i[e],t()||i[e]!==t||i.splice(e--,1);i.length||lt.fx.stop(),ue=void 0},lt.fx.timer=function(t){lt.timers.push(t),t()?lt.fx.start():lt.timers.pop()},lt.fx.interval=13,lt.fx.start=function(){le||(le=i.setInterval(lt.fx.tick,lt.fx.interval))},lt.fx.stop=function(){i.clearInterval(le),le=null},lt.fx.speeds={slow:600,fast:200,_default:400},lt.fn.delay=function(t,e){return t=lt.fx?lt.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,n){var r=i.setTimeout(e,t);n.stop=function(){i.clearTimeout(r)}})},function(){var t=J.createElement("input"),e=J.createElement("select"),i=e.appendChild(J.createElement("option"));t.type="checkbox",st.checkOn=""!==t.value,st.optSelected=i.selected,e.disabled=!0,st.optDisabled=!i.disabled,t=J.createElement("input"),t.value="t",t.type="radio",st.radioValue="t"===t.value}();var de,fe=lt.expr.attrHandle;lt.fn.extend({attr:function(t,e){return Ct(this,lt.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){lt.removeAttr(this,t)})}}),lt.extend({attr:function(t,e,i){var n,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof t.getAttribute?lt.prop(t,e,i):(1===o&&lt.isXMLDoc(t)||(e=e.toLowerCase(),r=lt.attrHooks[e]||(lt.expr.match.bool.test(e)?de:void 0)),void 0!==i?null===i?void lt.removeAttr(t,e):r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:(t.setAttribute(e,i+""),i):r&&"get"in r&&null!==(n=r.get(t,e))?n:(n=lt.find.attr(t,e),null==n?void 0:n))},attrHooks:{type:{set:function(t,e){if(!st.radioValue&&"radio"===e&&lt.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n,r=0,o=e&&e.match(At);if(o&&1===t.nodeType)for(;i=o[r++];)n=lt.propFix[i]||i,lt.expr.match.bool.test(i)&&(t[n]=!1),t.removeAttribute(i)}}),de={set:function(t,e,i){return e===!1?lt.removeAttr(t,i):t.setAttribute(i,i),i}},lt.each(lt.expr.match.bool.source.match(/\w+/g),function(t,e){var i=fe[e]||lt.find.attr;fe[e]=function(t,e,n){var r,o;return n||(o=fe[e],fe[e]=r,r=null!=i(t,e,n)?e.toLowerCase():null,fe[e]=o),r}});var pe=/^(?:input|select|textarea|button)$/i,me=/^(?:a|area)$/i;lt.fn.extend({prop:function(t,e){return Ct(this,lt.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[lt.propFix[t]||t]})}}),lt.extend({prop:function(t,e,i){var n,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&lt.isXMLDoc(t)||(e=lt.propFix[e]||e,r=lt.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=lt.find.attr(t,"tabindex");return e?parseInt(e,10):pe.test(t.nodeName)||me.test(t.nodeName)&&t.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),st.optSelected||(lt.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),lt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){lt.propFix[this.toLowerCase()]=this});var ve=/[\t\r\n\f]/g;lt.fn.extend({addClass:function(t){var e,i,n,r,o,a,s,u=0;if(lt.isFunction(t))return this.each(function(e){lt(this).addClass(t.call(this,e,q(this)))});if("string"==typeof t&&t)for(e=t.match(At)||[];i=this[u++];)if(r=q(i),n=1===i.nodeType&&(" "+r+" ").replace(ve," ")){for(a=0;o=e[a++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");s=lt.trim(n),r!==s&&i.setAttribute("class",s)}return this},removeClass:function(t){var e,i,n,r,o,a,s,u=0;if(lt.isFunction(t))return this.each(function(e){lt(this).removeClass(t.call(this,e,q(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(At)||[];i=this[u++];)if(r=q(i),n=1===i.nodeType&&(" "+r+" ").replace(ve," ")){for(a=0;o=e[a++];)for(;n.indexOf(" "+o+" ")>-1;)n=n.replace(" "+o+" "," ");s=lt.trim(n),r!==s&&i.setAttribute("class",s)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):lt.isFunction(t)?this.each(function(i){lt(this).toggleClass(t.call(this,i,q(this),e),e)}):this.each(function(){var e,n,r,o;if("string"===i)for(n=0,r=lt(this),o=t.match(At)||[];e=o[n++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else void 0!==t&&"boolean"!==i||(e=q(this),e&&Rt.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||t===!1?"":Rt.get(this,"__className__")||""))})},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+q(i)+" ").replace(ve," ").indexOf(e)>-1)return!0;return!1}});var ge=/\r/g,ye=/[\x20\t\r\n\f]+/g;lt.fn.extend({val:function(t){var e,i,n,r=this[0];{if(arguments.length)return n=lt.isFunction(t),this.each(function(i){var r;1===this.nodeType&&(r=n?t.call(this,i,lt(this).val()):t,null==r?r="":"number"==typeof r?r+="":lt.isArray(r)&&(r=lt.map(r,function(t){return null==t?"":t+""})),e=lt.valHooks[this.type]||lt.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))});if(r)return e=lt.valHooks[r.type]||lt.valHooks[r.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(i=e.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(ge,""):null==i?"":i)}}}),lt.extend({valHooks:{option:{get:function(t){var e=lt.find.attr(t,"value");return null!=e?e:lt.trim(lt.text(t)).replace(ye," ")}},select:{get:function(t){for(var e,i,n=t.options,r=t.selectedIndex,o="select-one"===t.type||r<0,a=o?null:[],s=o?r+1:n.length,u=r<0?s:o?r:0;u<s;u++)if(i=n[u],(i.selected||u===r)&&(st.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!lt.nodeName(i.parentNode,"optgroup"))){if(e=lt(i).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var i,n,r=t.options,o=lt.makeArray(e),a=r.length;a--;)n=r[a],(n.selected=lt.inArray(lt.valHooks.option.get(n),o)>-1)&&(i=!0);return i||(t.selectedIndex=-1),o}}}}),lt.each(["radio","checkbox"],function(){lt.valHooks[this]={set:function(t,e){if(lt.isArray(e))return t.checked=lt.inArray(lt(t).val(),e)>-1}},st.checkOn||(lt.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var xe=/^(?:focusinfocus|focusoutblur)$/;lt.extend(lt.event,{trigger:function(t,e,n,r){var o,a,s,u,l,h,c,d=[n||J],f=at.call(t,"type")?t.type:t,p=at.call(t,"namespace")?t.namespace.split("."):[];if(a=s=n=n||J,3!==n.nodeType&&8!==n.nodeType&&!xe.test(f+lt.event.triggered)&&(f.indexOf(".")>-1&&(p=f.split("."),f=p.shift(),p.sort()),l=f.indexOf(":")<0&&"on"+f,t=t[lt.expando]?t:new lt.Event(f,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=p.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:lt.makeArray(e,[t]),c=lt.event.special[f]||{},r||!c.trigger||c.trigger.apply(n,e)!==!1)){if(!r&&!c.noBubble&&!lt.isWindow(n)){for(u=c.delegateType||f,xe.test(u+f)||(a=a.parentNode);a;a=a.parentNode)d.push(a),s=a;s===(n.ownerDocument||J)&&d.push(s.defaultView||s.parentWindow||i)}for(o=0;(a=d[o++])&&!t.isPropagationStopped();)t.type=o>1?u:c.bindType||f,h=(Rt.get(a,"events")||{})[t.type]&&Rt.get(a,"handle"),h&&h.apply(a,e),h=l&&a[l],h&&h.apply&&St(a)&&(t.result=h.apply(a,e),t.result===!1&&t.preventDefault());return t.type=f,r||t.isDefaultPrevented()||c._default&&c._default.apply(d.pop(),e)!==!1||!St(n)||l&&lt.isFunction(n[f])&&!lt.isWindow(n)&&(s=n[l],s&&(n[l]=null),lt.event.triggered=f,n[f](),lt.event.triggered=void 0,s&&(n[l]=s)),t.result}},simulate:function(t,e,i){var n=lt.extend(new lt.Event,i,{type:t,isSimulated:!0});lt.event.trigger(n,null,e)}}),lt.fn.extend({trigger:function(t,e){return this.each(function(){lt.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return lt.event.trigger(t,e,i,!0)}}),lt.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){lt.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),lt.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),st.focusin="onfocusin"in i,st.focusin||lt.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){lt.event.simulate(e,t.target,lt.event.fix(t))};lt.event.special[e]={setup:function(){var n=this.ownerDocument||this,r=Rt.access(n,e);r||n.addEventListener(t,i,!0),Rt.access(n,e,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=Rt.access(n,e)-1;r?Rt.access(n,e,r):(n.removeEventListener(t,i,!0),Rt.remove(n,e))}}});var _e=i.location,be=lt.now(),we=/\?/;lt.parseJSON=function(t){return JSON.parse(t+"")},lt.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new i.DOMParser).parseFromString(t,"text/xml")}catch(n){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||lt.error("Invalid XML: "+t),e};var Me=/#.*$/,Te=/([?&])_=[^&]*/,Ae=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ee=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ce=/^(?:GET|HEAD)$/,Se=/^\/\//,Re={},Pe={},Le="*/".concat("*"),De=J.createElement("a");De.href=_e.href,lt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_e.href,type:"GET",isLocal:Ee.test(_e.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Le,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":lt.parseJSON,"text xml":lt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?X(X(t,lt.ajaxSettings),e):X(lt.ajaxSettings,t)},ajaxPrefilter:W(Re),ajaxTransport:W(Pe),ajax:function(t,e){function n(t,e,n,s){var l,c,y,x,b,M=e;2!==_&&(_=2,u&&i.clearTimeout(u),r=void 0,a=s||"",w.readyState=t>0?4:0,l=t>=200&&t<300||304===t,n&&(x=K(d,w,n)),x=Q(d,x,w,l),l?(d.ifModified&&(b=w.getResponseHeader("Last-Modified"),b&&(lt.lastModified[o]=b),b=w.getResponseHeader("etag"),b&&(lt.etag[o]=b)),204===t||"HEAD"===d.type?M="nocontent":304===t?M="notmodified":(M=x.state,c=x.data,y=x.error,l=!y)):(y=M,!t&&M||(M="error",t<0&&(t=0))),w.status=t,w.statusText=(e||M)+"",l?m.resolveWith(f,[c,M,w]):m.rejectWith(f,[w,M,y]),w.statusCode(g),g=void 0,h&&p.trigger(l?"ajaxSuccess":"ajaxError",[w,d,l?c:y]),v.fireWith(f,[w,M]),h&&(p.trigger("ajaxComplete",[w,d]),--lt.active||lt.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var r,o,a,s,u,l,h,c,d=lt.ajaxSetup({},e),f=d.context||d,p=d.context&&(f.nodeType||f.jquery)?lt(f):lt.event,m=lt.Deferred(),v=lt.Callbacks("once memory"),g=d.statusCode||{},y={},x={},_=0,b="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===_){if(!s)for(s={};e=Ae.exec(a);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===_?a:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return _||(t=x[i]=x[i]||t,y[t]=e),this},overrideMimeType:function(t){return _||(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(_<2)for(e in t)g[e]=[g[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||b;return r&&r.abort(e),n(0,e),this}};if(m.promise(w).complete=v.add,w.success=w.done,w.error=w.fail,d.url=((t||d.url||_e.href)+"").replace(Me,"").replace(Se,_e.protocol+"//"),d.type=e.method||e.type||d.method||d.type,d.dataTypes=lt.trim(d.dataType||"*").toLowerCase().match(At)||[""],null==d.crossDomain){l=J.createElement("a");try{l.href=d.url,l.href=l.href,d.crossDomain=De.protocol+"//"+De.host!=l.protocol+"//"+l.host}catch(M){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=lt.param(d.data,d.traditional)),H(Re,d,e,w),2===_)return w;h=lt.event&&d.global,h&&0===lt.active++&&lt.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Ce.test(d.type),o=d.url,d.hasContent||(d.data&&(o=d.url+=(we.test(o)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=Te.test(o)?o.replace(Te,"$1_="+be++):o+(we.test(o)?"&":"?")+"_="+be++)),d.ifModified&&(lt.lastModified[o]&&w.setRequestHeader("If-Modified-Since",lt.lastModified[o]),lt.etag[o]&&w.setRequestHeader("If-None-Match",lt.etag[o])),(d.data&&d.hasContent&&d.contentType!==!1||e.contentType)&&w.setRequestHeader("Content-Type",d.contentType),w.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Le+"; q=0.01":""):d.accepts["*"]);for(c in d.headers)w.setRequestHeader(c,d.headers[c]);if(d.beforeSend&&(d.beforeSend.call(f,w,d)===!1||2===_))return w.abort();b="abort";for(c in{success:1,error:1,complete:1})w[c](d[c]);if(r=H(Pe,d,e,w)){if(w.readyState=1,h&&p.trigger("ajaxSend",[w,d]),2===_)return w;d.async&&d.timeout>0&&(u=i.setTimeout(function(){w.abort("timeout")},d.timeout));try{_=1,r.send(y,n)}catch(M){if(!(_<2))throw M;n(-1,M)}}else n(-1,"No Transport");return w},getJSON:function(t,e,i){return lt.get(t,e,i,"json")},getScript:function(t,e){return lt.get(t,void 0,e,"script")}}),lt.each(["get","post"],function(t,e){lt[e]=function(t,i,n,r){return lt.isFunction(i)&&(r=r||n,n=i,i=void 0),lt.ajax(lt.extend({url:t,type:e,dataType:r,data:i,success:n},lt.isPlainObject(t)&&t))}}),lt._evalUrl=function(t){return lt.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},lt.fn.extend({wrapAll:function(t){var e;return lt.isFunction(t)?this.each(function(e){lt(this).wrapAll(t.call(this,e))}):(this[0]&&(e=lt(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return lt.isFunction(t)?this.each(function(e){lt(this).wrapInner(t.call(this,e))}):this.each(function(){var e=lt(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=lt.isFunction(t);return this.each(function(i){lt(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){lt.nodeName(this,"body")||lt(this).replaceWith(this.childNodes)}).end()}}),lt.expr.filters.hidden=function(t){return!lt.expr.filters.visible(t)},lt.expr.filters.visible=function(t){return t.offsetWidth>0||t.offsetHeight>0||t.getClientRects().length>0};var Oe=/%20/g,Ie=/\[\]$/,Ne=/\r?\n/g,Fe=/^(?:submit|button|image|reset|file)$/i,ke=/^(?:input|select|textarea|keygen)/i;lt.param=function(t,e){var i,n=[],r=function(t,e){e=lt.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=lt.ajaxSettings&&lt.ajaxSettings.traditional),lt.isArray(t)||t.jquery&&!lt.isPlainObject(t))lt.each(t,function(){r(this.name,this.value)});else for(i in t)Y(i,t[i],e,r);return n.join("&").replace(Oe,"+")},lt.fn.extend({serialize:function(){return lt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=lt.prop(this,"elements");return t?lt.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!lt(this).is(":disabled")&&ke.test(this.nodeName)&&!Fe.test(t)&&(this.checked||!kt.test(t))}).map(function(t,e){var i=lt(this).val();return null==i?null:lt.isArray(i)?lt.map(i,function(t){return{name:e.name,value:t.replace(Ne,"\r\n")}}):{name:e.name,value:i.replace(Ne,"\r\n")}}).get()}}),lt.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(t){}};var Ge={0:200,1223:204},Ue=lt.ajaxSettings.xhr();st.cors=!!Ue&&"withCredentials"in Ue,st.ajax=Ue=!!Ue,lt.ajaxTransport(function(t){var e,n;if(st.cors||Ue&&!t.crossDomain)return{send:function(r,o){var a,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)s[a]=t.xhrFields[a];t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");for(a in r)s.setRequestHeader(a,r[a]);e=function(t){return function(){e&&(e=n=s.onload=s.onerror=s.onabort=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(Ge[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=e(),n=s.onerror=e("error"),void 0!==s.onabort?s.onabort=n:s.onreadystatechange=function(){4===s.readyState&&i.setTimeout(function(){e&&n()})},e=e("abort");try{s.send(t.hasContent&&t.data||null)}catch(u){if(e)throw u}},abort:function(){e&&e()}}}),lt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return lt.globalEval(t),t}}}),lt.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),lt.ajaxTransport("script",function(t){if(t.crossDomain){var e,i;return{send:function(n,r){e=lt("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&r("error"===t.type?404:200,t.type)}),J.head.appendChild(e[0])},abort:function(){i&&i()}}}});var ze=[],Be=/(=)\?(?=&|$)|\?\?/;lt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=ze.pop()||lt.expando+"_"+be++;return this[t]=!0,t}}),lt.ajaxPrefilter("json jsonp",function(t,e,n){var r,o,a,s=t.jsonp!==!1&&(Be.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Be.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=lt.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Be,"$1"+r):t.jsonp!==!1&&(t.url+=(we.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return a||lt.error(r+" was not called"),a[0]},t.dataTypes[0]="json",o=i[r],i[r]=function(){a=arguments},n.always(function(){void 0===o?lt(i).removeProp(r):i[r]=o,t[r]&&(t.jsonpCallback=e.jsonpCallback,ze.push(r)),a&&lt.isFunction(o)&&o(a[0]),a=o=void 0}),"script"}),lt.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||J;var n=yt.exec(t),r=!i&&[];return n?[e.createElement(n[1])]:(n=v([t],e,r),r&&r.length&&lt(r).remove(),lt.merge([],n.childNodes))};var je=lt.fn.load;lt.fn.load=function(t,e,i){if("string"!=typeof t&&je)return je.apply(this,arguments);var n,r,o,a=this,s=t.indexOf(" ");return s>-1&&(n=lt.trim(t.slice(s)),t=t.slice(0,s)),lt.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(r="POST"),a.length>0&&lt.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){o=arguments,a.html(n?lt("<div>").append(lt.parseHTML(t)).find(n):t)}).always(i&&function(t,e){a.each(function(){i.apply(this,o||[t.responseText,e,t])})}),this},lt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){lt.fn[e]=function(t){return this.on(e,t)}}),lt.expr.filters.animated=function(t){return lt.grep(lt.timers,function(e){return t===e.elem}).length},lt.offset={setOffset:function(t,e,i){var n,r,o,a,s,u,l,h=lt.css(t,"position"),c=lt(t),d={};"static"===h&&(t.style.position="relative"),s=c.offset(),o=lt.css(t,"top"),u=lt.css(t,"left"),l=("absolute"===h||"fixed"===h)&&(o+u).indexOf("auto")>-1,l?(n=c.position(),a=n.top,r=n.left):(a=parseFloat(o)||0,r=parseFloat(u)||0),lt.isFunction(e)&&(e=e.call(t,i,lt.extend({},s))),null!=e.top&&(d.top=e.top-s.top+a),null!=e.left&&(d.left=e.left-s.left+r),"using"in e?e.using.call(t,d):c.css(d)}},lt.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){lt.offset.setOffset(this,t,e)});var e,i,n=this[0],r={top:0,left:0},o=n&&n.ownerDocument;if(o)return e=o.documentElement,lt.contains(e,n)?(r=n.getBoundingClientRect(),i=Z(o),{top:r.top+i.pageYOffset-e.clientTop,left:r.left+i.pageXOffset-e.clientLeft}):r},position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===lt.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),lt.nodeName(t[0],"html")||(n=t.offset()),n.top+=lt.css(t[0],"borderTopWidth",!0),n.left+=lt.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-lt.css(i,"marginTop",!0),left:e.left-n.left-lt.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===lt.css(t,"position");)t=t.offsetParent;return t||ie})}}),lt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i="pageYOffset"===e;lt.fn[t]=function(n){return Ct(this,function(t,n,r){var o=Z(t);return void 0===r?o?o[e]:t[n]:void(o?o.scrollTo(i?o.pageXOffset:r,i?r:o.pageYOffset):t[n]=r)},t,n,arguments.length)}}),lt.each(["top","left"],function(t,e){lt.cssHooks[e]=L(st.pixelPosition,function(t,i){if(i)return i=P(t,e),Jt.test(i)?lt(t).position()[e]+"px":i})}),lt.each({Height:"height",Width:"width"},function(t,e){lt.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){lt.fn[n]=function(n,r){var o=arguments.length&&(i||"boolean"!=typeof n),a=i||(n===!0||r===!0?"margin":"border");return Ct(this,function(e,i,n){var r;return lt.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===n?lt.css(e,i,a):lt.style(e,i,n,a)},e,o?n:void 0,o,null)}})}),lt.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},size:function(){return this.length}}),lt.fn.andSelf=lt.fn.addBack,n=[],r=function(){return lt}.apply(e,n),!(void 0!==r&&(t.exports=r));var Ve=i.jQuery,qe=i.$;return lt.noConflict=function(t){return i.$===lt&&(i.$=qe),t&&i.jQuery===lt&&(i.jQuery=Ve),lt},o||(i.jQuery=i.$=lt),lt})},function(t,e){if(!window.requestAnimationFrame){var i=[];window.performance&&window.performance.now||(window.performance={now:function(){return(new Date).getTime()}}),window.requestAnimationFrame=function(t){"use strict";if(!i.length){var e=window.performance.now();window.setTimeout(function(){var t=i;i=[];for(var e=window.performance.now(),n=0;n<t.length;n+=1)t[n].call(window,e)},15-parseInt(e,10)%15)}i.push(t)}}Math.log2||(Math.log2=function(){return Math.log.apply(Math,arguments)/Math.LN2}),Math.sinh=Math.sinh||function(t){var e=Math.exp(t);return(e-1/e)/2}},function(t,e,i){!function(){"use strict";var e=i(4),n=i(5),r=i(120),o=i(8),a=i(32),s=function(t){if(!(this instanceof s))return new s(t);var e=i(125);return t=t||{},n.call(this,t),this._view=r.mat4AsArray(),this._proj=r.mat4AsArray(),this._projection=null,this._transform=r.mat4AsArray(),this._inverse=r.mat4AsArray(),this._bounds=null,this._display=null,this._world=null,this._viewport={width:1,height:1},this._createProj=function(){var t=this.constructor.bounds.near/this.constructor.bounds.far;"perspective"===this._projection?o.frustum(this._proj,this.constructor.bounds.left*t,this.constructor.bounds.right*t,this.constructor.bounds.bottom*t,this.constructor.bounds.top*t,-this.constructor.bounds.near,-this.constructor.bounds.far):"parallel"===this._projection&&o.ortho(this._proj,this.constructor.bounds.left,this.constructor.bounds.right,this.constructor.bounds.bottom,this.constructor.bounds.top,this.constructor.bounds.near,this.constructor.bounds.far)},this._update=function(){this._bounds=null,this._display=null,this._world=null,this._transform=s.combine(this._proj,this._view),o.invert(this._inverse,this._transform),this.geoTrigger(e.camera.view,{camera:this})},Object.defineProperty(this,"view",{get:function(){return this._view},set:function(t){o.copy(this._view,t),this._update()}}),Object.defineProperty(this,"bounds",{get:function(){return null===this._bounds&&(this._bounds=this._getBounds()),this._bounds},set:function(t){this._setBounds(t),this._update()}}),Object.defineProperty(this,"display",{get:function(){var t;return null===this._display&&(t=s.affine({x:1,y:1},{x:this.viewport.width/2,y:this.viewport.height/-2}),this._display=s.combine(t,this._transform)),this._display}}),Object.defineProperty(this,"world",{get:function(){return null===this._world&&(this._world=o.invert(r.mat4AsArray(),this.display)),this._world}}),Object.defineProperty(this,"projection",{get:function(){return this._projection},set:function(t){if(!this.constructor.projection[t])throw new Error("Unsupported projection type: "+t);t!==this._projection&&(this._projection=t,this._createProj(),this._update(),this.geoTrigger(e.camera.projection,{camera:this,projection:t}))}}),Object.defineProperty(this,"projectionMatrix",{get:function(){return this._proj}}),Object.defineProperty(this,"transform",{get:function(){return this._transform}}),Object.defineProperty(this,"inverse",{get:function(){return this._inverse}}),Object.defineProperty(this,"viewport",{get:function(){return{width:this._viewport.width,height:this._viewport.height}},set:function(t){if(!(t.width>0&&t.height>0))throw new Error("Invalid viewport dimensions");t.width===this._viewport.width&&t.height===this._viewport.height||(this._viewport.width&&this._viewport.height&&(this._scale([this._viewport.width/t.width,this._viewport.height/t.height,1]),this._translate([(t.width-this._viewport.width)/2,(t.height-this._viewport.height)/2,0])),this._viewport={width:t.width,height:t.height},this._update(),this.geoTrigger(e.camera.viewport,{camera:this,viewport:this.viewport}))}}),this._resetView=function(){return o.identity(this._view),this},this._translate=function(t){o.translate(this._view,this._view,t)},this._scale=function(t){o.scale(this._view,this._view,t)},this._worldToClip4=function(t){return s.applyTransform(this._transform,t)},this._clipToWorld4=function(t){return s.applyTransform(this._inverse,t)},this.applyProjection=function(t){var e;return"perspective"===this._projection?(e=1/(t[3]||1),t[0]=e*t[0],t[1]=e*t[1],t[2]=e*t[2],t[3]=e):t[3]=1,t},this.unapplyProjection=function(t){var e;return"perspective"===this._projection?(e=t[3]||1,t[0]=e*t[0],t[1]=e*t[1],t[2]=e*t[2],t[3]=e):t[3]=1,t},this.worldToDisplay4=function(t){return t[2]-=2,this._worldToClip4(t),t=this.applyProjection(t),t[0]=this._viewport.width*(1+t[0])/2,t[1]=this._viewport.height*(1-t[1])/2,t[2]=(1+t[2])/2,t},this.displayToWorld4=function(t){return t[0]=2*t[0]/this._viewport.width-1,t[1]=-2*t[1]/this._viewport.height+1,t[2]=2*t[2]-1,t=this.unapplyProjection(t),this._clipToWorld4(t),t[2]+=2,t},this.worldToDisplay=function(t){var e=0,i=1;return t=this.worldToDisplay4([t.x,t.y,e,i]),{x:t[0],y:t[1],z:t[2]}},this.displayToWorld=function(t){var e=1,i=2;return t=this.displayToWorld4([t.x,t.y,e,i]),{x:t[0],y:t[1]}},this._getBounds=function(){var t,e,i,n,r={};return t=this.displayToWorld({x:0,y:0}),e=this.displayToWorld({x:this._viewport.width,y:0}),i=this.displayToWorld({x:0,y:this._viewport.height}),n=this.displayToWorld({x:this._viewport.width,y:this._viewport.height}),r.left=Math.min(t.x,e.x,i.x,n.x),r.bottom=Math.min(t.y,e.y,i.y,n.y),r.right=Math.max(t.x,e.x,i.x,n.x),r.top=Math.max(t.y,e.y,i.y,n.y),r},this._setBounds=function(t){var e={width:t.right-t.left,height:t.top-t.bottom},i={x:(t.left+t.right)/2,y:(t.bottom+t.top)/2};return this._viewFromCenterSizeRotation(i,e,0),this},this._viewFromCenterSizeRotation=function(t,e,i){var n,o,a,s,u=r.vec3AsArray(),l=r.vec3AsArray();return this._resetView(),a=Math.abs(e.width),s=Math.abs(e.height),n=a/s,o=this._viewport.width/this._viewport.height,n>=o?(s=a/o,l[0]=2/a,l[1]=2/s):(a=s*o,l[0]=2/a,l[1]=2/s),l[2]=1,this._scale(l),i&&this._rotate(i),u[0]=-t.x,u[1]=-t.y,u[2]=0,this._translate(u),this},this.viewFromCenterSizeRotation=function(t,e,i){return this._viewFromCenterSizeRotation(t,e,i),this._update(),this},this.pan=function(t){(t.x||t.y||t.z)&&(this._translate([t.x,t.y,t.z||0]),this._update())},this.zoom=function(t){1!==t&&(o.scale(this._view,this._view,[t,t,t]),this._update())},this._rotate=function(t,e,i){if(t){i=i||[0,0,-1],e?void 0!==e.x&&(e=[e.x||0,e.y||0,e.z||0]):e=[0,0,0];var n=[-e[0],-e[1],-e[2]];o.translate(this._view,this._view,e),o.rotate(this._view,this._view,t,i),o.translate(this._view,this._view,n)}},this.css=function(t){var e;switch((t||"").toLowerCase()){case"display":case"":e=this.display;break;case"world":e=this.world;break;default:throw new Error("Unknown transform "+t)}return s.css(e)},this.ppMatrix=function(t,e){function i(t){var i=n[t],r=i.toExponential(e);return i>=0&&(r=" "+r),r}var n=t;return e=e||2,[[i(0),i(4),i(8),i(12)].join(" "),[i(1),i(5),i(9),i(13)].join(" "),[i(2),i(6),i(10),i(14)].join(" "),[i(3),i(7),i(11),i(15)].join(" ")].join("\n")},this.toString=function(){return this.ppMatrix(this._transform)},this.debug=function(){return["bounds",JSON.stringify(this.bounds),"view:",this.ppMatrix(this._view),"projection:",this.ppMatrix(this._proj),"transform:",this.ppMatrix(this._transform)].join("\n")},this.valueOf=function(){return this._transform},this._resetView(),this.projection=t.projection||"parallel",t.viewport&&(this.viewport=t.viewport),this._update(),this};s.projection={perspective:!0,parallel:!0},s.bounds={left:-1,right:1,top:1,bottom:-1,far:-2,near:-1},s.css=function(t){return"matrix3d("+[t[0].toFixed(20),t[1].toFixed(20),t[2].toFixed(20),t[3].toFixed(20),t[4].toFixed(20),t[5].toFixed(20),t[6].toFixed(20),t[7].toFixed(20),t[8].toFixed(20),t[9].toFixed(20),t[10].toFixed(20),t[11].toFixed(20),t[12].toFixed(20),t[13].toFixed(20),t[14].toFixed(20),t[15].toFixed(20)].join(",")+")"},s.affine=function(t,e,i){var n=r.mat4AsArray();return i&&o.translate(n,n,[i.x||0,i.y||0,i.z||0]),e&&o.scale(n,n,[e.x||1,e.y||1,e.z||1]),t&&o.translate(n,n,[t.x||0,t.y||0,t.z||0]),n},s.applyTransform=function(t,e){return a.transformMat4(e,e,t)},s.combine=function(t,e){return o.multiply(r.mat4AsArray(),t,e)},e(s,n),t.exports=s}()},function(t,e){function i(){return function(){}}t.exports=function(t,e){var n=i();n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,i){var n=i(6),r=i(4),o=function(){"use strict";if(!(this instanceof o))return new o;var t=this,e={},i=[],r=0;return this.onIdle=function(e){return r?i.push(e):e(),t},this.addPromise=function(e){function n(){r-=1,r||i.splice(0,i.length).forEach(function(t){t()})}return r+=1,e.then(n,n),t},this.geoOn=function(i,n){return Array.isArray(i)?(i.forEach(function(e){t.geoOn(e,n)}),t):(e.hasOwnProperty(i)||(e[i]=[]),e[i].push(n),t)},this.geoTrigger=function(i,n){return Array.isArray(i)?(i.forEach(function(e){t.geoTrigger(e,n)}),t):(n=n||{},n.event=i,e.hasOwnProperty(i)&&e[i].forEach(function(e){e.call(t,n)}),t)},this.geoOff=function(n,o){if(void 0===n&&(e={},i=[],r=0),Array.isArray(n))return n.forEach(function(e){t.geoOff(e,o)}),t;if(o){if(Array.isArray(o))return o.forEach(function(e){t.geoOff(n,e)}),t}else e[n]=[];return e.hasOwnProperty(n)&&(e[n]=e[n].filter(function(t){return t!==o})),t},this._exit=function(){t.geoOff()},n.object.call(this),this};r(o,n.object),t.exports=o},function(t,e,i){(function(e){t.exports=e.vgl=i(7)}).call(e,function(){return this}())},function(t,e,i){var n,r,o=i(8),a=i(32),s=i(58),u=i(91),l=i(1);
!function(i,o){n=[],r=function(){return i.vgl=o()}.apply(e,n),!(void 0!==r&&(t.exports=r))}(this,function(){if("undefined"==typeof t)var t={};t.namespace=function(e){"use strict";var i,n=e.split("."),r=t;for("ogs"===n[0]&&(n=n.slice(1)),i=0;i<n.length;i+=1)"undefined"==typeof r[n[i]]&&(r[n[i]]={}),r=r[n[i]];return r};var e=t.namespace("gl");window.vgl=e,e.inherit=function(t,e){"use strict";var i=inherit.func();i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t},e.inherit.func=function(){"use strict";return function(){}},window.inherit=e.inherit,Object.size=function(t){"use strict";var e,i=0;for(e in t)t.hasOwnProperty(e)&&(i+=1);return i},Math.log2||(Math.log2=function(t){return Math.log(t)/Math.log(2)}),e.version="0.3.8",e.GL={ACTIVE_ATTRIBUTES:35721,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALPHA:6406,ALPHA_BITS:3413,ALWAYS:519,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATTACHED_SHADERS:35717,BACK:1029,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BROWSER_DEFAULT_WEBGL:37444,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_BUFFER_BIT:16384,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,COMPILE_STATUS:35713,COMPRESSED_TEXTURE_FORMATS:34467,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_LOST_WEBGL:37442,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH_ATTACHMENT:36096,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DONT_CARE:4352,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,FASTEST:4353,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GREATER:516,GREEN_BITS:3411,HIGH_FLOAT:36338,HIGH_INT:36341,INCR:7682,INCR_WRAP:34055,INT:5124,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE_ALPHA:6410,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_RENDERBUFFER_SIZE:34024,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIRRORED_REPEAT:33648,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,RED_BITS:3410,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,REPEAT:10497,REPLACE:7681,RGB:6407,RGB565:36194,RGB5_A1:32855,RGBA:6408,RGBA4:32854,SAMPLER_2D:35678,SAMPLER_CUBE:35680,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_CLEAR_VALUE:2961,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,UNPACK_ALIGNMENT:3317,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VIEWPORT:2978,ZERO:0};var i=0;e.timestamp=function(){"use strict";if(!(this instanceof e.timestamp))return new e.timestamp;var t=0;this.modified=function(){i+=1,t=i},this.getMTime=function(){return t}},e.object=function(){"use strict";if(!(this instanceof e.object))return new e.object;var t=e.timestamp();return t.modified(),this.modified=function(){t.modified()},this.getMTime=function(){return t.getMTime()},this},e.event=function(){"use strict";return this instanceof e.event?(e.object.call(this),this):new e.event},inherit(e.event,e.object),e.event.keyPress="vgl.event.keyPress",e.event.mousePress="vgl.event.mousePress",e.event.mouseRelease="vgl.event.mouseRelease",e.event.contextMenu="vgl.event.contextMenu",e.event.configure="vgl.event.configure",e.event.enable="vgl.event.enable",e.event.mouseWheel="vgl.event.mouseWheel",e.event.keyRelease="vgl.event.keyRelease",e.event.middleButtonPress="vgl.event.middleButtonPress",e.event.startInteraction="vgl.event.startInteraction",e.event.enter="vgl.event.enter",e.event.rightButtonPress="vgl.event.rightButtonPress",e.event.middleButtonRelease="vgl.event.middleButtonRelease",e.event["char"]="vgl.event.char",e.event.disable="vgl.event.disable",e.event.endInteraction="vgl.event.endInteraction",e.event.mouseMove="vgl.event.mouseMove",e.event.mouseOut="vgl.event.mouseOut",e.event.expose="vgl.event.expose",e.event.timer="vgl.event.timer",e.event.leftButtonPress="vgl.event.leftButtonPress",e.event.leave="vgl.event.leave",e.event.rightButtonRelease="vgl.event.rightButtonRelease",e.event.leftButtonRelease="vgl.event.leftButtonRelease",e.event.click="vgl.event.click",e.event.dblClick="vgl.event.dblClick",e.boundingObject=function(){"use strict";if(!(this instanceof e.boundingObject))return new e.boundingObject;e.object.call(this);var t=[0,0,0,0,0,0],i=e.timestamp(),n=e.timestamp();return i.modified(),n.modified(),this.bounds=function(){return t},this.hasValidBounds=function(t){return t[0]!==Number.MAX_VALUE&&t[1]!==-Number.MAX_VALUE&&t[2]!==Number.MAX_VALUE&&t[3]!==-Number.MAX_VALUE&&t[4]!==Number.MAX_VALUE&&t[5]!==-Number.MAX_VALUE},this.setBounds=function(e,n,r,o,a,s){if(this.hasValidBounds([e,n,r,o,a,s]))return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=a,t[5]=s,this.modified(),i.modified(),!0},this.resetBounds=function(){t[0]=Number.MAX_VALUE,t[1]=-Number.MAX_VALUE,t[2]=Number.MAX_VALUE,t[3]=-Number.MAX_VALUE,t[4]=Number.MAX_VALUE,t[5]=-Number.MAX_VALUE,this.modified()},this.computeBounds=function(){},this.computeBoundsTimestamp=function(){return i},this.boundsDirtyTimestamp=function(){return n},this.resetBounds(),this},e.boundingObject.ReferenceFrame={Relative:0,Absolute:1},inherit(e.boundingObject,e.object),e.node=function(){"use strict";if(!(this instanceof e.node))return new e.node;e.boundingObject.call(this);var t=null,i=null,n=!0,r=!1;return this.accept=function(t){t.visit(this)},this.material=function(){return i},this.setMaterial=function(t){return t!==i&&(i=t,this.modified(),!0)},this.visible=function(){return n},this.setVisible=function(t){return t!==n&&(n=t,this.modified(),!0)},this.parent=function(){return t},this.setParent=function(e){return e!==t&&(null!==t&&t.removeChild(this),t=e,this.modified(),!0)},this.overlay=function(){return r},this.setOverlay=function(t){return r!==t&&(r=t,this.modified(),!0)},this.ascend=function(t){t=t},this.traverse=function(t){t=t},this.boundsModified=function(){this.boundsDirtyTimestamp().modified(),null!==t&&t.boundsModified()},this},inherit(e.node,e.boundingObject),e.groupNode=function(){"use strict";if(!(this instanceof e.groupNode))return new e.groupNode;e.node.call(this);var t=[];return this.b_setVisible=this.setVisible,this.setVisible=function(e){var i;if(this.b_setVisible(e)!==!0)return!1;for(i=0;i<t.length;i+=1)t[i].setVisible(e);return!0},this.addChild=function(i){return i instanceof e.node&&(t.indexOf(i)===-1&&(i.setParent(this),t.push(i),this.boundsDirtyTimestamp().modified(),!0))},this.removeChild=function(e){if(e.parent()===this){var i=t.indexOf(e);if(i>=0)return t.splice(i,1),e.setParent(null),this.boundsDirtyTimestamp().modified(),!0}},this.removeChildren=function(){for(;t.length;)this.removeChild(t[0]);this.modified()},this.children=function(){return t},this.hasChild=function(e){var i=0,n=!1;for(i=0;i<t.length;i+=1)if(t[i]===e){n=!0;break}return n},this.accept=function(t){t.visit(this)},this.traverse=function(t){switch(t.type()){case t.UpdateVisitor:this.traverseChildrenAndUpdateBounds(t);break;case t.CullVisitor:this.traverseChildren(t)}},this.traverseChildrenAndUpdateBounds=function(e){var i;if(this.parent()&&this.boundsDirtyTimestamp().getMTime()>this.computeBoundsTimestamp().getMTime()&&this.parent().boundsDirtyTimestamp().modified(),this.computeBounds(),e.mode()===e.TraverseAllChildren)for(i=0;i<t.length;i+=1)t[i].accept(e),this.updateBounds(t[i]);this.computeBoundsTimestamp().modified()},this.traverseChildren=function(e){var i;if(e.mode()===e.TraverseAllChildren)for(i=0;i<t.length;i+=1)t[i].accept(e)},this.computeBounds=function(){var e=0;if(!(this.computeBoundsTimestamp().getMTime()>this.boundsDirtyTimestamp().getMTime()))for(e=0;e<t.length;e+=1)this.updateBounds(t[e])},this.updateBounds=function(t){if(!t.overlay()){t.computeBounds();var e,i=this.bounds(),n=t.bounds(),r=0,o=0;for(e=0;e<3;e+=1)r=2*e,o=2*e+1,n[r]<i[r]&&(i[r]=n[r]),n[o]>i[o]&&(i[o]=n[o]);this.setBounds(i[0],i[1],i[2],i[3],i[4],i[5])}},this},inherit(e.groupNode,e.node),e.actor=function(){"use strict";if(!(this instanceof e.actor))return new e.actor;e.node.call(this);var t=this,i=o.create(),n=e.boundingObject.ReferenceFrame.Relative,r=null;return this.matrix=function(){return i},this.setMatrix=function(e){e!==i&&(i=e,t.modified())},this.referenceFrame=function(){return n},this.setReferenceFrame=function(e){return e!==n&&(n=e,t.modified(),!0)},this.mapper=function(){return r},this.setMapper=function(e){e!==r&&(r=e,t.boundsModified())},this.accept=function(t){t=t},this.ascend=function(t){t=t},this.computeLocalToWorldMatrix=function(t,e){t=t,e=e},this.computeWorldToLocalMatrix=function(t,e){t=t,e=e},this.computeBounds=function(){if(null===r||void 0===r)return void t.resetBounds();var e,n,o,a,u=t.computeBoundsTimestamp();(t.boundsDirtyTimestamp().getMTime()>u.getMTime()||r.boundsDirtyTimestamp().getMTime()>u.getMTime())&&(r.computeBounds(),e=r.bounds(),n=[e[0],e[2],e[4]],o=[e[1],e[3],e[5]],s.transformMat4(n,n,i),s.transformMat4(o,o,i),a=[n[0]>o[0]?o[0]:n[0],n[0]>o[0]?n[0]:o[0],n[1]>o[1]?o[1]:n[1],n[1]>o[1]?n[1]:o[1],n[2]>o[2]?o[2]:n[2],n[2]>o[2]?n[2]:o[2]],t.setBounds(a[0],a[1],a[2],a[3],a[4],a[5]),u.modified())},t},inherit(e.actor,e.node),e.freezeObject=function(t){"use strict";var e=Object.freeze?Object.freeze(t):void 0;return"undefined"==typeof e?t:e},e.defaultValue=function(t,e){"use strict";return"undefined"!=typeof t?t:e},e.defaultValue.EMPTY_OBJECT=e.freezeObject({}),e.graphicsObject=function(t){"use strict";if(t=t,!(this instanceof e.graphicsObject))return new e.graphicsObject;e.object.call(this);var i=this;return this._setup=function(t){return t=t,!1},this._cleanup=function(t){return t=t,!1},this.bind=function(t){return t=t,!1},this.undoBind=function(t){return t=t,!1},this.render=function(t){return t=t,!1},this.remove=function(t){i._cleanup(t)},i},inherit(e.graphicsObject,e.object),e.geojsonReader=function(){"use strict";return this instanceof e.geojsonReader?(this.readScalars=function(t,i,n,r){var o=null,a=null,s=null,u=null,l=null;"values"===this.m_scalarFormat&&4===t.length?(a=t[3],o=i.sourceData(e.vertexAttributeKeys.Scalar),o||(o=new e.sourceDataSf,this.m_scalarRange&&o.setScalarRange(this.m_scalarRange[0],this.m_scalarRange[1]),void 0!==n&&(o.data().length=n),i.addSource(o)),void 0===n?o.pushBack(a):o.insertAt(r,a)):"rgb"===this.m_scalarFormat&&6===t.length&&(o=i.sourceData(e.vertexAttributeKeys.Color),o||(o=new e.sourceDataC3fv,void 0!==n&&(o.length=3*n),i.addSource(o)),s=t[3],u=t[4],l=t[5],void 0===n?o.pushBack([s,u,l]):o.insertAt(r,[s,u,l]))},this.readPoint=function(t){var i=new e.geometryData,n=new e.points,r=new e.sourceDataP3fv,o=new Uint16Array(1),a=null,s=null,u=null,l=null;for(i.addSource(r),l=0;l<1;l+=1)o[l]=l,a=t[0],s=t[1],u=0,t.length>2&&(u=t[2]),r.pushBack([a,s,u]),this.readScalars(t,i);return n.setIndices(o),i.addPrimitive(n),i.setName("aPoint"),i},this.readMultiPoint=function(t){var i,n=new e.geometryData,r=new e.points,o=new e.sourceDataP3fv,a=new Uint16Array(t.length),s=0,u=t.length,l=null,h=null,c=null;for(o.data().length=3*u,i=0;i<t.length;i+=1)a[i]=i,l=t[i][0],h=t[i][1],c=0,t[i].length>2&&(c=t[i][2]),o.insertAt(s,[l,h,c]),this.readScalars(t[i],n,u,s),s+=1;return r.setIndices(a),n.addPrimitive(r),n.addSource(o),n.setName("manyPoints"),n},this.readLineString=function(t){var i=new e.geometryData,n=new e.lineStrip,r=new e.sourceDataP3fv,o=[],a=null,s=null,u=null,l=null;for(n.setIndicesPerPrimitive(t.length),a=0;a<t.length;a+=1)o.push(a),s=t[a][0],u=t[a][1],l=0,t[a].length>2&&(l=t[a][2]),r.pushBack([s,u,l]),this.readScalars(t[a],i);return n.setIndices(o),i.addPrimitive(n),i.addSource(r),i.setName("aLineString"),i},this.readMultiLineString=function(t){var i=new e.geometryData,n=new e.sourceDataP3fv,r=0,o=2*t.length,a=null,s=null,u=null,l=null,h=null,c=null,d=null,f=null;for(n.data().length=3*o,s=0;s<t.length;s+=1){for(c=[],d=new e.lineStrip,f=t[s].length,d.setIndicesPerPrimitive(f),a=0;a<f;a+=1)c.push(r),u=t[s][a][0],l=t[s][a][1],h=0,t[s][a].length>2&&(h=t[s][a][2]),n.insertAt(r,[u,l,h]),this.readScalars(t[s][a],i,2*o,r),r+=1;d.setIndices(c),i.addPrimitive(d)}return i.setName("aMultiLineString"),i.addSource(n),i},this.readPolygon=function(t){var i=new e.geometryData,n=new e.sourceDataP3fv,r=null,o=null,a=null,s=t[0].length,u=1,l=null,h=null,c=null;for(l=0;l<s;l+=1)r=t[0][l][0],o=t[0][l][1],a=0,t[0][l].length>2&&(a=t[0][l][2]),n.pushBack([r,o,a]),this.readScalars(t[0][l],i),l>1&&(h=new Uint16Array([0,u,l]),c=new e.triangles,c.setIndices(h),i.addPrimitive(c),u=l);return i.setName("POLY"),i.addSource(n),i},this.readMultiPolygon=function(t){var i=new e.geometryData,n=new e.sourceDataP3fv,r=0,o=t.length,a=0,s=3*o,u=new e.triangles,l=[],h=null,c=null,d=null,f=null,p=null,m=null,v=null,g=null,y=null,x=!1,_=0;for(n.data().length=3*o,c=0;c<o;c+=1)for(m=t[c][0].length,v=r,g=r+1,y=[!1,!1,!1],h=0;h<m;h+=1)d=t[c][0][h][0],f=t[c][0][h][1],p=0,t[c][0][h].length>2&&(p=t[c][0][h][2]),x=!1,d>180&&(x=!0,d-=360),0===h?y[0]=x:y[1+(h-1)%2]=x,n.insertAt(a,[d,f,p]),this.readScalars(t[c][0][h],i,s,a),a+=1,h>1&&(y[0]===y[1]&&y[1]===y[2]&&(l[3*_+0]=v,l[3*_+1]=g,l[3*_+2]=r,_+=1),g=r),r+=1;return u.setIndices(l),i.addPrimitive(u),i.setName("aMultiPoly"),i.addSource(n),i},this.readGJObjectInt=function(t){if(!t.hasOwnProperty("type"))return null;t.properties&&t.properties.ScalarFormat&&"values"===t.properties.ScalarFormat&&(this.m_scalarFormat="values",t.properties.ScalarRange&&(this.m_scalarRange=t.properties.ScalarRange)),t.properties&&t.properties.ScalarFormat&&"rgb"===t.properties.ScalarFormat&&(this.m_scalarFormat="rgb");var e,i=t.type,n=null,r=null,o=null;switch(i){case"Point":e=this.readPoint(t.coordinates);break;case"MultiPoint":e=this.readMultiPoint(t.coordinates);break;case"LineString":e=this.readLineString(t.coordinates);break;case"MultiLineString":e=this.readMultiLineString(t.coordinates);break;case"Polygon":e=this.readPolygon(t.coordinates);break;case"MultiPolygon":e=this.readMultiPolygon(t.coordinates);break;case"GeometryCollection":for(r=[],o=0;o<t.geometries.length;o+=1)n=this.readGJObject(t.geometries[o]),r.push(n);e=r;break;case"Feature":n=this.readGJObject(t.geometry),e=n;break;case"FeatureCollection":for(r=[],o=0;o<t.features.length;o+=1)n=this.readGJObject(t.features[o]),r.push(n);e=r;break;default:console.log("Don't understand type "+i),e=null}return e},this.readGJObject=function(t){var e;return e=this.readGJObjectInt(t)},this.linearizeGeoms=function(t,e){var i=null;if("[object Array]"===Object.prototype.toString.call(e))for(i=0;i<e.length;i+=1)this.linearizeGeoms(t,e[i]);else t.push(e)},this.readGeomObject=function(t){var e,i=[];return e=this.readGJObject(t),this.linearizeGeoms(i,e),i},this.getPrimitives=function(t){if(!t)return[];var e=JSON.parse(t),i=this.readGJObject(e),n=[];return this.m_scalarFormat="none",this.m_scalarRange=null,this.linearizeGeoms(n,i),{geoms:n,scalarFormat:this.m_scalarFormat,scalarRange:this.m_scalarRange}},this):new e.geojsonReader},e.data=function(){"use strict";return this instanceof e.data?void(this.type=function(){}):new e.data},e.data.raster=0,e.data.point=1,e.data.lineString=2,e.data.polygon=3,e.data.geometry=10,e.primitive=function(){"use strict";if(!(this instanceof e.primitive))return new e.primitive;var t=0,i=0,n=0,r=null;return this.indices=function(){return r},this.createIndices=function(t){r=new Uint16Array},this.numberOfIndices=function(){return r.length},this.sizeInBytes=function(){return r.length*Uint16Array.BYTES_PER_ELEMENT},this.primitiveType=function(){return i},this.setPrimitiveType=function(t){i=t},this.indicesPerPrimitive=function(){return t},this.setIndicesPerPrimitive=function(e){t=e},this.indicesValueType=function(){return n},this.setIndicesValueType=function(t){n=t},this.setIndices=function(t){r=new Uint16Array(t)},this},e.triangleStrip=function(){"use strict";return this instanceof e.triangleStrip?(e.primitive.call(this),this.setPrimitiveType(e.GL.TRIANGLE_STRIP),this.setIndicesValueType(e.GL.UNSIGNED_SHORT),this.setIndicesPerPrimitive(3),this):new e.triangleStrip},inherit(e.triangleStrip,e.primitive),e.triangles=function(){"use strict";return this instanceof e.triangles?(e.primitive.call(this),this.setPrimitiveType(e.GL.TRIANGLES),this.setIndicesValueType(e.GL.UNSIGNED_SHORT),this.setIndicesPerPrimitive(3),this):new e.triangles},inherit(e.triangles,e.primitive),e.lines=function(){"use strict";return this instanceof e.lines?(e.primitive.call(this),this.setPrimitiveType(e.GL.LINES),this.setIndicesValueType(e.GL.UNSIGNED_SHORT),this.setIndicesPerPrimitive(2),this):new e.lines},inherit(e.lines,e.primitive),e.lineStrip=function(){"use strict";return this instanceof e.lineStrip?(e.primitive.call(this),this.setPrimitiveType(e.GL.LINE_STRIP),this.setIndicesValueType(e.GL.UNSIGNED_SHORT),this.setIndicesPerPrimitive(2),this):new e.lineStrip},inherit(e.lineStrip,e.primitive),e.points=function(){"use strict";return this instanceof e.points?(e.primitive.call(this),this.setPrimitiveType(e.GL.POINTS),this.setIndicesValueType(e.GL.UNSIGNED_SHORT),this.setIndicesPerPrimitive(1),this):new e.points},inherit(e.points,e.primitive),e.vertexDataP3f=function(){"use strict";return this instanceof e.vertexDataP3f?(this.m_position=[],this):new e.vertexDataP3f},e.vertexDataP3N3f=function(){"use strict";return this instanceof e.vertexDataP3N3f?(this.m_position=[],this.m_normal=[],this):new e.vertexDataP3N3f},e.vertexDataP3T3f=function(){"use strict";return this instanceof e.vertexDataP3T3f?(this.m_position=[],this.m_texCoordinate=[],this):new e.vertexDataP3T3f},e.sourceData=function(t){"use strict";if(!(this instanceof e.sourceData))return new e.sourceData(t);t=t||{};var i={},n=[],r=t.name||"Source "+(new Date).toISOString(),o=function(){this.m_numberOfComponents=0,this.m_dataType=0,this.m_dataTypeSize=0,this.m_normalized=!1,this.m_stride=0,this.m_offset=0};return this.data=function(){return n},this.getData=function(){return this.data()},this.dataToFloat32Array=function(){return n instanceof Float32Array||(n=new Float32Array(n)),n},this.setData=function(t){return t instanceof Array||t instanceof Float32Array?void(n=t instanceof Float32Array?t:t.slice(0)):void console.log("[error] Requires array")},this.addAttribute=function(t,e,n,r,a,s,u){if(!i.hasOwnProperty(t)){var l=new o;l.m_dataType=e,l.m_dataTypeSize=n,l.m_offset=r,l.m_stride=a,l.m_numberOfComponents=s,l.m_normalized=u,i[t]=l}},this.sizeOfArray=function(){return Object.size(n)},this.lengthOfArray=function(){return n.length},this.sizeInBytes=function(){var t,e=0,i=this.keys();for(t=0;t<i.length;t+=1)e+=this.attributeNumberOfComponents(i[t])*this.sizeOfAttributeDataType(i[t]);return e*=this.sizeOfArray()},this.hasKey=function(t){return i.hasOwnProperty(t)},this.keys=function(){return Object.keys(i)},this.numberOfAttributes=function(){return Object.size(i)},this.attributeNumberOfComponents=function(t){return i.hasOwnProperty(t)?i[t].m_numberOfComponents:0},this.normalized=function(t){return!!i.hasOwnProperty(t)&&i[t].m_normalized},this.sizeOfAttributeDataType=function(t){return i.hasOwnProperty(t)?i[t].m_dataTypeSize:0},this.attributeDataType=function(t){if(i.hasOwnProperty(t))return i[t].m_dataType},this.attributeOffset=function(t){return i.hasOwnProperty(t)?i[t].m_offset:0},this.attributeStride=function(t){return i.hasOwnProperty(t)?i[t].m_stride:0},this.pushBack=function(t){},this.insert=function(t){var e;if(!n.length&&t.length&&t instanceof Float32Array)return void(n=t);if(n.slice||!n.length&&t.slice||(n=Array.prototype.slice.call(n)),t.length)if(!n.length&&t.slice)n=t.slice(0);else for(e=0;e<t.length;e+=1)n[n.length]=t[e];else n[n.length]=t},this.insertAt=function(t,e){var i;if(e.length)for(i=0;i<e.length;i+=1)n[t*e.length+i]=e[i];else n[t]=e},this.name=function(){return r},this.setName=function(t){r=t},this},e.sourceDataAnyfv=function(t,i,n){"use strict";return this instanceof e.sourceDataAnyfv?(e.sourceData.call(this,n),this.addAttribute(i,e.GL.FLOAT,4,0,4*t,t,!1),this.pushBack=function(t){this.insert(t)},this):new e.sourceDataAnyfv(t,i,n)},inherit(e.sourceDataAnyfv,e.sourceData),e.sourceDataP3T3f=function(t){"use strict";return this instanceof e.sourceDataP3T3f?(e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.Position,e.GL.FLOAT,4,0,24,3,!1),this.addAttribute(e.vertexAttributeKeys.TextureCoordinate,e.GL.FLOAT,4,12,24,3,!1),this.pushBack=function(t){this.insert(t.m_position),this.insert(t.m_texCoordinate)},this):new e.sourceDataP3T3f(t)},inherit(e.sourceDataP3T3f,e.sourceData),e.sourceDataP3N3f=function(t){"use strict";return this instanceof e.sourceDataP3N3f?(e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.Position,e.GL.FLOAT,4,0,24,3,!1),this.addAttribute(e.vertexAttributeKeys.Normal,e.GL.FLOAT,4,12,24,3,!1),this.pushBack=function(t){this.insert(t.m_position),this.insert(t.m_normal)},this):new e.sourceDataP3N3f(t)},inherit(e.sourceDataP3N3f,e.sourceData),e.sourceDataP3fv=function(t){"use strict";return this instanceof e.sourceDataP3fv?(e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.Position,e.GL.FLOAT,4,0,12,3,!1),this.pushBack=function(t){this.insert(t)},this):new e.sourceDataP3fv(t)},inherit(e.sourceDataP3fv,e.sourceData),e.sourceDataT2fv=function(t){"use strict";return this instanceof e.sourceDataT2fv?(e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.TextureCoordinate,e.GL.FLOAT,4,0,8,2,!1),this.pushBack=function(t){this.insert(t)},this):new e.sourceDataT2fv(t)},inherit(e.sourceDataT2fv,e.sourceData),e.sourceDataC3fv=function(t){"use strict";return this instanceof e.sourceDataC3fv?(e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.Color,e.GL.FLOAT,4,0,12,3,!1),this.pushBack=function(t){this.insert(t)},this):new e.sourceDataC3fv(t)},inherit(e.sourceDataC3fv,e.sourceData),e.sourceDataSf=function(t){"use strict";if(!(this instanceof e.sourceDataSf))return new e.sourceDataSf(t);var i=null,n=null,r=null,o=null;return e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.Scalar,e.GL.FLOAT,4,0,4,1,!1),this.pushBack=function(t){(null===n||t>n)&&(n=t),(null===i||t<i)&&(i=t),this.data()[this.data().length]=t},this.insertAt=function(t,e){(null===n||e>n)&&(n=e),(null===i||e<i)&&(i=e),this.data()[t]=e},this.scalarRange=function(){return null===r||null===o?[i,n]:[r,o]},this.setScalarRange=function(t,e){r=t,o=e},this},inherit(e.sourceDataSf,e.sourceData),e.sourceDataDf=function(t){"use strict";return this instanceof e.sourceDataDf?(e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.Scalar,e.GL.FLOAT,4,0,4,1,!1),this.pushBack=function(t){this.data()[this.data().length]=t},this.insertAt=function(t,e){this.data()[t]=e},this):new e.sourceDataDf(t)},inherit(e.sourceDataDf,e.sourceData),e.geometryData=function(){"use strict";if(!(this instanceof e.geometryData))return new e.geometryData;e.data.call(this);var t="",i=[],n=[],r=[0,0,0,0,0,0],o=e.timestamp(),a=e.timestamp();return this.type=function(){return e.data.geometry},this.name=function(){return t},this.setName=function(e){t=e},this.addSource=function(t,i){return void 0!==i&&t.setName(i),n.indexOf(t)===-1&&(n.push(t),t.hasKey(e.vertexAttributeKeys.Position)&&a.modified(),!0)},this.source=function(t){return t<n.length?n[t]:0},this.sourceByName=function(t){for(var e=0;e<n.length;e+=1)if(n[e].name()===t)return n[e];return 0},this.numberOfSources=function(){return n.length},this.sourceData=function(t){var e;for(e=0;e<n.length;e+=1)if(n[e].hasKey(t))return n[e];return null},this.addPrimitive=function(t){return i.push(t),!0},this.primitive=function(t){return t<i.length?i[t]:null},this.numberOfPrimitives=function(){return i.length},this.bounds=function(){return a.getMTime()>o.getMTime()&&this.computeBounds(),r},this.boundsDirty=function(t){return t&&a.modified(),a.getMTime()>o.getMTime()},this.resetBounds=function(){r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=0},this.setBounds=function(t,e,i,n,a,s){return r[0]=t,r[1]=e,r[2]=i,r[3]=n,r[4]=a,r[5]=s,o.modified(),!0},this.computeBounds=function(){if(a.getMTime()>o.getMTime()){var t,i,n,s,u,l,h=e.vertexAttributeKeys.Position,c=this.sourceData(h),d=c.data(),f=c.attributeNumberOfComponents(h),p=c.attributeStride(h),m=c.attributeOffset(h),v=c.sizeOfAttributeDataType(h),g=d.length,y=null;for(p/=v,m/=v,this.resetBounds(),t=0;t<f;t+=1){for(i=2*t,n=2*t+1,s=u=g?r[n]=d[m+t]:0,l=m+p+t;l<g;l+=p)y=d[l],y>s&&(s=y),y<u&&(u=y);r[i]=u,r[n]=s}o.modified()}},this.findClosestVertex=function(t){var i,n,r,o,a,s,u,l=e.vertexAttributeKeys.Position,h=this.sourceData(l),c=h.sizeOfAttributeDataType(l),d=h.attributeNumberOfComponents(l),f=h.data(),p=h.attributeStride(l)/c,m=h.attributeOffset(l)/c,v=Number.MAX_VALUE,g=null;for(3!==d&&console.log("[warning] Find closest vertex assumes threecomponent vertex "),t.z||(t={x:t.x,y:t.y,z:0}),i=m,u=0;i<f.length;i+=p,u+=1)n=[f[i],f[i+1],f[i+2]],r=n[0]-t.x,o=n[1]-t.y,a=n[2]-t.z,s=Math.sqrt(r*r+o*o+a*a),s<v&&(v=s,g=u);return g},this.getPosition=function(t){var i=e.vertexAttributeKeys.Position,n=this.sourceData(i),r=n.sizeOfAttributeDataType(i),o=n.attributeNumberOfComponents(i),a=n.data(),s=n.attributeStride(i)/r,u=n.attributeOffset(i)/r;return 3!==o&&console.log("[warning] getPosition assumes three component data"),[a[u+t*s],a[u+t*s+1],a[u+t*s+2]]},this.getScalar=function(t){var i,n,r,o,a=e.vertexAttributeKeys.Scalar,s=this.sourceData(a);return s?(i=s.sizeOfAttributeDataType(a),n=s.data(),r=s.attributeStride(a)/i,o=s.attributeOffset(a)/i,t*r+o>=n.length&&console.log("access out of bounds in getScalar"),n[t*r+o]):null},this},inherit(e.geometryData,e.data),e.mapper=function(t){"use strict";function i(t){if(a){t&&(c=t.m_context);var i,n,r,o,d,f,p,m=a.numberOfSources(),v=null;for(i=0;i<m;i+=1){for(v=c.createBuffer(),c.bindBuffer(e.GL.ARRAY_BUFFER,v),p=a.source(i).data(),p instanceof Float32Array||(p=new Float32Array(p)),c.bufferData(e.GL.ARRAY_BUFFER,p,l?e.GL.DYNAMIC_DRAW:e.GL.STATIC_DRAW),o=a.source(i).keys(),d=[],n=0;n<o.length;n+=1)d.push(o[n]);u[i]=d,s[i]=v}for(f=a.numberOfPrimitives(),r=0;r<f;r+=1)v=c.createBuffer(),c.bindBuffer(e.GL.ARRAY_BUFFER,v),c.bufferData(e.GL.ARRAY_BUFFER,a.primitive(r).indices(),e.GL.STATIC_DRAW),s[i]=v,i+=1;h.modified()}}function n(t){u={},s=[]}function r(t){d.deleteVertexBufferObjects(t),n(t),i(t)}if(!(this instanceof e.mapper))return new e.mapper(t);e.boundingObject.call(this),t=t||{};var o=[0,1,1],a=null,s=[],u={},l=void 0!==t.dynamicDraw&&t.dynamicDraw,h=e.timestamp(),c=null,d=this;return this.deleteVertexBufferObjects=function(t){var e,i=c;if(t&&(i=t.m_context),i)for(e=0;e<s.length;e+=1)i.deleteBuffer(s[e])},this.computeBounds=function(){if(null===a||"undefined"==typeof a)return void this.resetBounds();var t=this.computeBoundsTimestamp(),e=this.boundsDirtyTimestamp(),i=null;e.getMTime()>t.getMTime()&&(i=a.bounds(),this.setBounds(i[0],i[1],i[2],i[3],i[4],i[5]),t.modified())},this.color=function(){return o},this.setColor=function(t,e,i){o[0]=t,o[1]=e,o[2]=i,this.modified()},this.geometryData=function(){return a},this.setGeometryData=function(t){a!==t&&(a=t,this.modified(),this.boundsDirtyTimestamp().modified())},this.updateSourceBuffer=function(t,i,n){if(n&&(c=n.m_context),!c)return!1;for(var r=-1,o=0;o<a.numberOfSources();o+=1)if(a.source(o).name()===t){r=o;break}return!(r<0||r>=s.length)&&(i||(i=a.source(o).dataToFloat32Array()),c.bindBuffer(e.GL.ARRAY_BUFFER,s[r]),i instanceof Float32Array?c.bufferSubData(e.GL.ARRAY_BUFFER,0,i):c.bufferSubData(e.GL.ARRAY_BUFFER,0,new Float32Array(i)),!0)},this.getSourceBuffer=function(t){var e=a.sourceByName(t);return e?e.dataToFloat32Array():new Float32Array},this.render=function(t,i){(this.getMTime()>h.getMTime()||t.m_contextChanged)&&r(t),c=t.m_context,c.vertexAttrib3fv(e.vertexAttributeKeys.Color,this.color());
var n,o=0,l=0,d=null,f=null;for(n in u)if(u.hasOwnProperty(n)){for(c.bindBuffer(e.GL.ARRAY_BUFFER,s[o]),l=0;l<u[n].length;l+=1)t.m_material.bindVertexData(t,u[n][l]);o+=1}for(d=a.numberOfPrimitives(),l=0;l<d;l+=1){switch(c.bindBuffer(e.GL.ARRAY_BUFFER,s[o]),o+=1,f=a.primitive(l),f.primitiveType()){case e.GL.POINTS:c.drawArrays(e.GL.POINTS,0,f.numberOfIndices());break;case e.GL.LINES:c.drawArrays(e.GL.LINES,0,f.numberOfIndices());break;case e.GL.LINE_STRIP:c.drawArrays(e.GL.LINE_STRIP,0,f.numberOfIndices());break;case e.GL.TRIANGLES:c.drawArrays(e.GL.TRIANGLES,0,f.numberOfIndices());break;case e.GL.TRIANGLE_STRIP:c.drawArrays(e.GL.TRIANGLE_STRIP,0,f.numberOfIndices())}c.bindBuffer(e.GL.ARRAY_BUFFER,null)}i||this.undoBindVertexData(t)},this.undoBindVertexData=function(t){var e,i;for(e in u)if(u.hasOwnProperty(e))for(i=0;i<u[e].length;i+=1)t.m_material.undoBindVertexData(t,u[e][i])},this},inherit(e.mapper,e.boundingObject),e.groupMapper=function(){"use strict";if(!(this instanceof e.groupMapper))return new e.groupMapper;e.mapper.call(this);var t=e.timestamp(),i=[],n=[];return this.geometryData=function(t){return void 0!==t&&t<n.length?n[t]:n.length>0?n[0]:null},this.setGeometryData=function(t){1===n.length&&n[0]===t||(n=[],n.push(t),this.modified())},this.geometryDataArray=function(){return n},this.setGeometryDataArray=function(t){if(t instanceof Array){if(n!==t)return n=[],n=t,this.modified(),!0}else console.log("[error] Requies array of geometry data");return!1},this.computeBounds=function(){if(null===n||void 0===n)return void this.resetBounds();var t=this.computeBoundsTimestamp(),e=this.boundsDirtyTimestamp(),i=this.bounds(),r=null,o=null;if(e.getMTime()>t.getMTime()){for(o=0;o<n.length;o+=1)r=n[o].bounds(),i[0]>r[0]&&(i[0]=r[0]),i[1]<r[1]&&(i[1]=r[1]),i[2]>r[2]&&(i[2]=r[2]),i[3]<r[3]&&(i[3]=r[3]),i[4]>r[4]&&(i[4]=r[4]),i[5]<r[5]&&(i[5]=r[5]);this.modified(),t.modified()}},this.render=function(r){var o=null;if(this.getMTime()>t.getMTime()){for(o=0;o<n.length;o+=1)i.push(e.mapper()),i[o].setGeometryData(n[o]);t.modified()}for(o=0;o<i.length;o+=1)i[o].render(r)},this},inherit(e.groupMapper,e.mapper),e.materialAttributeType={Undefined:0,ShaderProgram:1,Texture:2,Blend:3,Depth:4},e.materialAttribute=function(t){"use strict";if(!(this instanceof e.materialAttribute))return new e.materialAttribute(t);e.graphicsObject.call(this);var i=this,n=t,r=!0;return this.type=function(){return n},this.enabled=function(){return r},this.bindVertexData=function(t,e){return t=t,e=e,!1},this.undoBindVertexData=function(t,e){return t=t,e=e,!1},i},inherit(e.materialAttribute,e.graphicsObject),e.blendFunction=function(t,i){"use strict";if(!(this instanceof e.blendFunction))return new e.blendFunction(t,i);var n=t,r=i;return this.apply=function(t){t.m_context.blendFuncSeparate(n,r,e.GL.ONE,e.GL.ONE_MINUS_SRC_ALPHA)},this},e.blend=function(){"use strict";if(!(this instanceof e.blend))return new e.blend;e.materialAttribute.call(this,e.materialAttributeType.Blend);var t=!1,i=e.blendFunction(e.GL.SRC_ALPHA,e.GL.ONE_MINUS_SRC_ALPHA);return this.bind=function(n){return t=n.m_context.isEnabled(e.GL.BLEND),this.enabled()?(n.m_context.enable(e.GL.BLEND),i.apply(n)):n.m_context.disable(e.GL.BLEND),!0},this.undoBind=function(i){return t?i.m_context.enable(e.GL.BLEND):i.m_context.disable(e.GL.BLEND),!0},this},inherit(e.blend,e.materialAttribute),e.material=function(){"use strict";if(!(this instanceof e.material))return new e.material;e.graphicsObject.call(this);var t=this,i=new e.shaderProgram,n=100,r={},o={};return this.binNumber=function(){return n},this.setBinNumber=function(e){n=e,t.modified()},this.exists=function(t){return t.type()===e.materialAttributeType.Texture?r.hasOwnProperty(t.textureUnit()):o.hasOwnProperty(t.type())},this.uniform=function(t){return i?i.uniform(t):null},this.attribute=function(t,i){return o.hasOwnProperty(t)?o[t]:t===e.materialAttributeType.Texture&&r.hasOwnProperty(i)?r[i]:null},this.setAttribute=function(n){return n.type()===e.materialAttributeType.Texture?r[n.textureUnit()]!==n&&(r[n.textureUnit()]=n,t.modified(),!0):o[n.type()]!==n&&(n.type()===e.materialAttributeType.ShaderProgram&&(i=n),o[n.type()]=n,t.modified(),!0)},this.addAttribute=function(n){return!t.exists(n)&&(n.type()===e.materialAttributeType.Texture?(r[n.textureUnit()]=n,t.modified(),!0):(n.type()===e.materialAttributeType.ShaderProgram&&(i=n),o[n.type()]=n,t.modified(),!0))},this.shaderProgram=function(){return i},this._setup=function(t){return!1},this._cleanup=function(t){for(var e in o)o.hasOwnProperty(e)&&o[e]._cleanup(t);for(e in r)r.hasOwnProperty(e)&&r[e]._cleanup(t)},this.bind=function(t){var e=null;i.bind(t);for(e in o)o.hasOwnProperty(e)&&o[e]!==i&&o[e].bind(t);for(e in r)r.hasOwnProperty(e)&&r[e].bind(t)},this.undoBind=function(t){var e=null;for(e in o)o.hasOwnProperty(e)&&o[e].undoBind(t);for(e in r)r.hasOwnProperty(e)&&r[e].undoBind(t)},this.bindVertexData=function(t,e){var i=null;for(i in o)o.hasOwnProperty(i)&&o[i].bindVertexData(t,e)},this.undoBindVertexData=function(t,e){var i=null;for(i in o)o.hasOwnProperty(i)&&o[i].undoBindVertexData(t,e)},t},e.material.RenderBin={Base:0,Default:100,Opaque:100,Transparent:1e3,Overlay:1e4},inherit(e.material,e.graphicsObject),e.renderState=function(){"use strict";this.m_context=null,this.m_modelViewMatrix=o.create(),this.m_normalMatrix=o.create(),this.m_projectionMatrix=null,this.m_material=null,this.m_mapper=null},e.renderer=function(t){"use strict";if(!(this instanceof e.renderer))return new e.renderer(t);e.graphicsObject.call(this),t=t||{};var i=this;return i.m_renderWindow=null,i.m_contextChanged=!1,i.m_sceneRoot=new e.groupNode,i.m_camera=new e.camera(t),i.m_nearClippingPlaneTolerance=null,i.m_x=0,i.m_y=0,i.m_width=0,i.m_height=0,i.m_resizable=!0,i.m_resetScene=!0,i.m_layer=0,i.m_renderPasses=null,i.m_resetClippingRange=!0,i.m_depthBits=null,i.m_camera.addChild(i.m_sceneRoot),this.width=function(){return i.m_width},this.height=function(){return i.m_height},this.layer=function(){return i.m_layer},this.setLayer=function(t){i.m_layer=t,i.modified()},this.isResizable=function(){return i.m_resizable},this.setResizable=function(t){i.m_resizable=t},this.renderWindow=function(){return i.m_renderWindow},this.setRenderWindow=function(t){i.m_renderWindow!==t&&(i.m_renderWindow&&i.m_renderWindow.removeRenderer(this),i.m_renderWindow=t,i.m_contextChanged=!0,i.modified())},this.backgroundColor=function(){return i.m_camera.clearColor()},this.setBackgroundColor=function(t,e,n,r){i.m_camera.setClearColor(t,e,n,r),i.modified()},this.sceneRoot=function(){return i.m_sceneRoot},this.camera=function(){return i.m_camera},this.render=function(){var t,n,r,a=null,s=[],u=o.create(),l=null;if(n=new e.renderState,n.m_renderer=i,n.m_context=i.renderWindow().context(),i.m_depthBits&&!i.m_contextChanged||(i.m_depthBits=n.m_context.getParameter(e.GL.DEPTH_BITS)),n.m_contextChanged=i.m_contextChanged,i.m_renderPasses)for(t=0;t<i.m_renderPasses.length;t+=1){if(i.m_renderPasses[t].render(n))return console.log("returning"),void i.m_renderPasses[t].remove(n);i.m_renderPasses[t].remove(n)}for(n.m_context.enable(e.GL.DEPTH_TEST),n.m_context.depthFunc(e.GL.LEQUAL),i.m_camera.clearMask()&e.GL.COLOR_BUFFER_BIT&&(l=i.m_camera.clearColor(),n.m_context.clearColor(l[0],l[1],l[2],l[3])),i.m_camera.clearMask()&e.GL.DEPTH_BUFFER_BIT&&n.m_context.clearDepth(i.m_camera.clearDepth()),n.m_context.clear(i.m_camera.clearMask()),n.m_context.viewport(i.m_x,i.m_y,i.m_width,i.m_height),r=i.m_sceneRoot.children(),r.length>0&&i.m_resetScene&&(i.resetCamera(),i.m_resetScene=!1),t=0;t<r.length;t+=1)a=r[t],a.computeBounds(),a.visible()&&a.material().binNumber()>=0&&s.push([a.material().binNumber(),a]);for(s.sort(function(t,e){return t[0]-e[0]}),t=0;t<s.length;t+=1){if(a=s[t][1],a.referenceFrame()===e.boundingObject.ReferenceFrame.Relative){var h=i.m_camera.viewMatrix();h instanceof Array&&(n.m_modelViewMatrix=new Array(16)),o.multiply(n.m_modelViewMatrix,h,a.matrix()),n.m_projectionMatrix=i.m_camera.projectionMatrix(),n.m_modelViewAlignment=i.m_camera.viewAlignment()}else n.m_modelViewMatrix=a.matrix(),n.m_modelViewAlignment=null,n.m_projectionMatrix=o.create(),o.ortho(n.m_projectionMatrix,0,i.m_width,0,i.m_height,-1,1);o.invert(u,n.m_modelViewMatrix),o.transpose(n.m_normalMatrix,u),n.m_material=a.material(),n.m_mapper=a.mapper(),n.m_material.bind(n),n.m_mapper.render(n),n.m_material.undoBind(n)}n.m_context.finish(),i.m_contextChanged=!1},this.resetCamera=function(){i.m_camera.computeBounds();var t=i.m_camera.directionOfProjection(),e=i.m_camera.bounds(),n=[(e[0]+e[1])/2,(e[2]+e[3])/2,(e[4]+e[5])/2],r=[e[1]-e[0],e[3]-e[2],e[5]-e[4]],o=0,a=i.m_camera.viewAspect(),u=i.m_camera.viewAngle(),l=null,h=null;o=r[0]>r[1]?r[0]>r[2]?r[0]/2:r[2]/2:r[1]>r[2]?r[1]/2:r[2]/2,u=a>=1?2*Math.atan(Math.tan(.5*u)/a):2*Math.atan(Math.tan(.5*u)*a),l=o/Math.sin(.5*u),h=i.m_camera.viewUpDirection(),Math.abs(s.dot(h,t))>.999&&i.m_camera.setViewUpDirection(-h[2],h[0],h[1]),i.m_camera.setFocalPoint(n[0],n[1],n[2]),i.m_camera.setPosition(n[0]+l*-t[0],n[1]+l*-t[1],n[2]+l*-t[2]),i.resetCameraClippingRange(e)},this.hasValidBounds=function(t){return t[0]!==Number.MAX_VALUE&&t[1]!==-Number.MAX_VALUE&&t[2]!==Number.MAX_VALUE&&t[3]!==-Number.MAX_VALUE&&t[4]!==Number.MAX_VALUE&&t[5]!==-Number.MAX_VALUE},this.resetCameraClippingRange=function(t){if("undefined"==typeof t&&(i.m_camera.computeBounds(),t=i.m_camera.bounds()),i.hasValidBounds(t)){var e=i.m_camera.viewPlaneNormal(),n=i.m_camera.position(),r=-e[0],o=-e[1],a=-e[2],s=-(r*n[0]+o*n[1]+a*n[2]),l=u.create(),h=null,c=null,d=null,f=null;if(i.m_resetClippingRange){for(l[0]=r*t[0]+o*t[2]+a*t[4]+s,l[1]=1e-18,f=0;f<2;f+=1)for(d=0;d<2;d+=1)for(c=0;c<2;c+=1)h=r*t[c]+o*t[2+d]+a*t[4+f]+s,l[0]=h<l[0]?h:l[0],l[1]=h>l[1]?h:l[1];l[0]<0&&(l[0]=0),l[0]=.99*l[0]-.5*(l[1]-l[0]),l[1]=1.01*l[1]+.5*(l[1]-l[0]),l[0]=l[0]>=l[1]?.01*l[1]:l[0],i.m_nearClippingPlaneTolerance||(i.m_nearClippingPlaneTolerance=.01,i.m_depthBits&&i.m_depthBits>16&&(i.m_nearClippingPlaneTolerance=.001)),l[0]<i.m_nearClippingPlaneTolerance*l[1]&&(l[0]=i.m_nearClippingPlaneTolerance*l[1]),i.m_camera.setClippingRange(l[0],l[1])}}},this.resize=function(t,e){t&&e&&i.positionAndResize(i.m_x,i.m_y,t,e)},this.positionAndResize=function(t,e,n,r){var o;if(t<0||e<0||n<=0||r<=0)return void console.log("[error] Invalid position and resize values",t,e,n,r);if(i.m_resizable&&(i.m_width=n,i.m_height=r,i.m_camera.setViewAspect(n/r),i.m_camera.setParallelExtents({width:n,height:r}),i.modified()),i.m_renderPasses)for(o=0;o<i.m_renderPasses.length;o+=1)i.m_renderPasses[o].resize(n,r),i.m_renderPasses[o].renderer().positionAndResize(t,e,n,r)},this.addActor=function(t){return t instanceof e.actor&&(i.m_sceneRoot.addChild(t),i.modified(),!0)},this.hasActor=function(t){return i.m_sceneRoot.hasChild(t)},this.addActors=function(t){var e=null;if(t instanceof Array){for(e=0;e<t.length;e+=1)i.m_sceneRoot.addChild(t[e]);i.modified()}},this.removeActor=function(t){return i.m_sceneRoot.children().indexOf(t)!==-1&&(t.mapper()&&(t.mapper().deleteVertexBufferObjects(),t.mapper().modified()),i.m_sceneRoot.removeChild(t),i.modified(),!0)},this.removeActors=function(t){if(!(t instanceof Array))return!1;var e;for(e=0;e<t.length;e+=1)i.m_sceneRoot.removeChild(t[e]);return i.modified(),!0},this.removeAllActors=function(){return i.m_sceneRoot.removeChildren()},this.worldToDisplay=function(t,e,i,n,r){var s=o.create(),u=null,l=null,h=null,c=null,d=null;return o.multiply(s,i,e),d=a.create(),a.transformMat4(d,t,s),0!==d[3]&&(d[0]=d[0]/d[3],d[1]=d[1]/d[3],d[2]=d[2]/d[3],d[3]=1),u=(d[0]+1)/2*n,l=(1-d[1])/2*r,h=d[2],c=d[3],a.fromValues(u,l,h,c)},this.displayToWorld=function(t,e,i,n,r){var s=2*t[0]/n-1,u=-(2*t[1]/r)+1,l=t[2],h=o.create(),c=null;return o.multiply(h,i,e),o.invert(h,h),c=a.fromValues(s,u,l,1),a.transformMat4(c,c,h),0!==c[3]&&(c[0]=c[0]/c[3],c[1]=c[1]/c[3],c[2]=c[2]/c[3],c[3]=1),c},this.focusDisplayPoint=function(){var t=i.m_camera.focalPoint(),e=a.fromValues(t[0],t[1],t[2],1);return i.worldToDisplay(e,i.m_camera.viewMatrix(),i.m_camera.projectionMatrix(),i.m_width,i.m_height)},this.resetScene=function(){return i.m_resetScene},this.setResetScene=function(t){i.m_resetScene!==t&&(i.m_resetScene=t,i.modified())},this.resetClippingRange=function(){return i.m_resetClippingRange},this.setResetClippingRange=function(t){i.m_resetClippingRange!==t&&(i.m_resetClippingRange=t,i.modified())},this.addRenderPass=function(t){var e;if(i.m_renderPasses)for(e=0;e<i.m_renderPasses.length;e+=1)if(t===i.m_renderPasses[e])return;i.m_renderPasses=[],i.m_renderPasses.push(t)},this.removeRenderPass=function(t){t=t},this._cleanup=function(t){for(var e=i.m_sceneRoot.children(),n=0;n<e.length;n+=1){var r=e[n];r.material()._cleanup(t),r.mapper()._cleanup(t)}i.m_sceneRoot.removeChildren()},i},inherit(e.renderer,e.graphicsObject),e.renderWindow=function(t){"use strict";if(!(this instanceof e.renderWindow))return new e.renderWindow(t);e.graphicsObject.call(this);var i=this,n=0,r=0,o=400,s=400,u=t,l=null,h=[],c=null;return this.windowSize=function(){return[o,s]},this.setWindowSize=function(t,e){return(o!==t||s!==e)&&(o=t,s=e,i.modified(),!0)},this.windowPosition=function(){return[n,r]},this.setWindowPosition=function(t,e){return(n!==t||r!==e)&&(n=t,r=e,i.modified(),!0)},this.renderers=function(){return h},this.activeRenderer=function(){return l},this.addRenderer=function(t){return i.hasRenderer(t)===!1&&(h.push(t),t.setRenderWindow(i),null===l&&(l=t),0!==t.layer()&&t.camera().setClearMask(e.GL.DepthBufferBit),i.modified(),!0)},this.removeRenderer=function(t){var e=h.indexOf(t);return e!==-1&&(l===t&&(l=null),h.splice(e,1),i.modified(),!0)},this.getRenderer=function(t){return t<h.length?h[t]:(console.log("[WARNING] Out of index array"),null)},this.hasRenderer=function(t){var e;for(e=0;e<h.length;e+=1)if(t===h[e])return!0;return!1},this.resize=function(t,e){i.positionAndResize(n,r,t,e),i.modified()},this.positionAndResize=function(t,e,a,u){n=t,r=e,o=a,s=u;var l;for(l=0;l<h.length;l+=1)h[l].positionAndResize(n,r,o,s);i.modified()},this._setup=function(t){t=t,c=null;try{c=u.getContext("webgl")||u.getContext("experimental-webgl");var e;for(e=0;e<h.length;e+=1)(h[e].width()>o||0===h[e].width()||h[e].height()>s||0===h[e].height())&&h[e].resize(n,r,o,s);return!0}catch(i){}return c||console("[ERROR] Unable to initialize WebGL. Your browser may not support it."),!1},this.context=function(){return c},this._cleanup=function(t){var i;for(i=0;i<h.length;i+=1)h[i]._cleanup(t);e.clearCachedShaders(t?t.m_context:null)},this.render=function(){var t;for(h.sort(function(t,e){return t.layer()-e.layer()}),t=0;t<h.length;t+=1)h[t].render()},this.focusDisplayPoint=function(){return l.focusDisplayPoint()},this.displayToWorld=function(t,e,i,n){n=void 0===n?n=l:n;var r=n.camera();return i||(i=n.focusDisplayPoint()),n.displayToWorld(a.fromValues(t,e,i[2],1),r.viewMatrix(),r.projectionMatrix(),o,s)},this.worldToDisplay=function(t,e,i,n){n=void 0===n?n=l:n;var r=n.camera();return n.worldToDisplay(a.fromValues(t,e,i,1),r.viewMatrix(),r.projectionMatrix(),o,s)},i},inherit(e.renderWindow,e.graphicsObject),e.camera=function(t){"use strict";if(!(this instanceof e.camera))return new e.camera(t);e.groupNode.call(this),t=t||{};var i=30*Math.PI/180,n=a.fromValues(0,0,1,1),r=a.fromValues(0,0,0,1),u=s.fromValues(0,0,0),l=a.fromValues(0,1,0,0),h=a.fromValues(1,0,0,0),c=.01,d=1e4,f=1,p=a.fromValues(0,0,-1,0),m=a.fromValues(0,0,1,0),v=o.create(),g=o.create(),y=e.timestamp(),x=e.timestamp(),_=-1,b=1,w=1,M=-1,T={zoom:1,tilesize:256},A=!0,E=!0,C=!0,S=!1,R=[0,0,0,0],P=1,L=e.GL.COLOR_BUFFER_BIT|e.GL.DEPTH_BUFFER_BIT;return void 0!==t.parallelProjection&&(S=!!t.parallelProjection),this.viewAngle=function(){return i},this.setViewAngleDegrees=function(t){this.setViewAngle(Math.PI*t/180)},this.setViewAngle=function(t){C&&(i=t,this.modified())},this.position=function(){return n},this.setPosition=function(t,e,i){A&&(n=a.fromValues(t,e,i,1),this.modified())},this.focalPoint=function(){return r},this.setFocalPoint=function(t,e,i){E&&A&&(r=a.fromValues(t,e,i,1),this.modified())},this.viewUpDirection=function(){return l},this.setViewUpDirection=function(t,e,i){l=a.fromValues(t,e,i,0),this.modified()},this.centerOfRotation=function(){return u},this.setCenterOfRotation=function(t){u=t,this.modified()},this.clippingRange=function(){return[c,d]},this.setClippingRange=function(t,e){c=t,d=e,this.modified()},this.viewAspect=function(){return f},this.setViewAspect=function(t){f=t,this.modified()},this.enableScale=function(){return C},this.setEnableScale=function(t){return t!==C?(C=t,this.modified(),!0):C},this.enableRotation=function(){return E},this.setEnableRotation=function(t){return t!==E?(E=t,this.modified(),!0):E},this.enableTranslation=function(){return A},this.setEnableTranslation=function(t){return t!==A?(A=t,this.modified(),!0):A},this.isEnabledParallelProjection=function(){return S},this.enableParallelProjection=function(t){return t!==S?(S=t,this.modified(),!0):S},this.setEnableParallelProjection=function(t){return this.enableParallelProjection(t)},this.parallelProjection=function(){return{left:_,right:b,top:w,bottom:M}},this.setParallelProjection=function(t,e,i,n){_=t,b=e,w=i,M=n,this.modified()},this.parallelExtents=function(){return T},this.setParallelExtents=function(t){var e,i,n=["width","height","zoom","tilesize"],r=!1;for(e=0;e<n.length;e+=1)i=n[e],void 0!==t[i]&&t[i]!==T[i]&&(T[i]=t[i],r=!0);if(r&&T.width&&T.height&&void 0!==T.zoom&&T.tilesize){var o=this.unitsPerPixel(T.zoom,T.tilesize);b=o*T.width/2,_=-b,w=o*T.height/2,M=-w,this.modified()}},this.unitsPerPixel=function(t,e){return e=e||256,360*Math.pow(2,-t)/e},this.directionOfProjection=function(){return this.computeDirectionOfProjection(),p},this.viewPlaneNormal=function(){return this.computeViewPlaneNormal(),m},this.viewMatrix=function(){return this.computeViewMatrix()},this.setViewMatrix=function(t,e){e?v=t.slice():o.copy(v,t),y.modified()},this.projectionMatrix=function(){return this.computeProjectionMatrix()},this.setProjectionMatrix=function(t){o.copy(g,t),x.modified()},this.clearMask=function(){return L},this.setClearMask=function(t){L=t,this.modified()},this.clearColor=function(){return R},this.setClearColor=function(t,e,i,n){R[0]=t,R[1]=e,R[2]=i,R[3]=n,this.modified()},this.clearDepth=function(){return P},this.setClearDepth=function(t){P=t,this.modified()},this.computeDirectionOfProjection=function(){s.subtract(p,r,n),s.normalize(p,p),this.modified()},this.computeViewPlaneNormal=function(){m[0]=-p[0],m[1]=-p[1],m[2]=-p[2]},this.zoom=function(t,e){0!==t&&A&&(t*=s.distance(r,n),e?(n[0]=n[0]+t*e[0],n[1]=n[1]+t*e[1],n[2]=n[2]+t*e[2]):(e=p,n[0]=r[0]-t*e[0],n[1]=r[1]-t*e[1],n[2]=r[2]-t*e[2]),this.modified())},this.pan=function(t,e,i){A&&(n[0]+=t,n[1]+=e,n[2]+=i,r[0]+=t,r[1]+=e,r[2]+=i,this.modified())},this.computeOrthogonalAxes=function(){this.computeDirectionOfProjection(),s.cross(h,p,l),s.normalize(h,h),this.modified()},this.rotate=function(t,e){if(E){t=.5*t*(Math.PI/180),e=.5*e*(Math.PI/180);var i=o.create(),c=new s.create;o.identity(i),c[0]=-u[0],c[1]=-u[1],c[2]=-u[2],o.translate(i,i,u),o.rotate(i,i,t,l),o.rotate(i,i,e,h),o.translate(i,i,c),a.transformMat4(n,n,i),a.transformMat4(r,r,i),a.transformMat4(l,l,i),a.normalize(l,l),this.computeOrthogonalAxes(),this.modified()}},this.computeViewMatrix=function(){return y.getMTime()<this.getMTime()&&(o.lookAt(v,n,r,l),y.modified()),v},this.viewAlignment=function(){if(!S){var t=this.projectionMatrix();if(t[1]||t[2]||t[3]||t[4]||t[6]||t[7]||t[8]||t[9]||t[12]||t[13]||t[15])return null}var e=this.unitsPerPixel(T.zoom,T.tilesize);if(!T.width||!T.height||!e)return null;if(parseFloat(T.zoom.toFixed(6))!==parseFloat(T.zoom.toFixed(0)))return null;var i={roundx:e,roundy:e,dx:0,dy:0};return T.width%2&&(i.dx=.5*e),T.height%2&&(i.dy=.5*e),i},this.computeProjectionMatrix=function(){return x.getMTime()<this.getMTime()&&(S?o.ortho(g,_,b,M,w,c,d):o.perspective(g,i,f,c,d),x.modified()),g},this.zoomToHeight=function(t,n,r){return e.zoomToHeight(t,n,r,i)},this.computeDirectionOfProjection(),this},inherit(e.camera,e.groupNode),e.zoomToHeight=function(t,e,i,n){"use strict";n=n||30*Math.PI/180;var r=360*Math.pow(2,-t);return r/=2*Math.tan(n/2)*256/i},e.heightToZoom=function(t,e,i,n){"use strict";n=n||30*Math.PI/180,t*=2*Math.tan(n/2)*256/i;var r=-Math.log2(t/360);return r},e.interactorStyle=function(){"use strict";if(!(this instanceof e.interactorStyle))return new e.interactorStyle;e.object.call(this);var t=this,i=null;return this.viewer=function(){return i},this.setViewer=function(n){n!==i&&(i=n,l(i).on(e.event.mousePress,t.handleMouseDown),l(i).on(e.event.mouseRelease,t.handleMouseUp),l(i).on(e.event.mouseMove,t.handleMouseMove),l(i).on(e.event.mouseOut,t.handleMouseOut),l(i).on(e.event.mouseWheel,t.handleMouseWheel),l(i).on(e.event.keyPress,t.handleKeyPress),l(i).on(e.event.mouseContextMenu,t.handleContextMenu),l(i).on(e.event.click,t.handleClick),l(i).on(e.event.dblClick,t.handleDoubleClick),this.modified())},this.handleMouseDown=function(t){return t=t,!0},this.handleMouseUp=function(t){return t=t,!0},this.handleMouseMove=function(t){return t=t,!0},this.handleMouseOut=function(t){return t=t,!0},this.handleMouseWheel=function(t){return t=t,!0},this.handleClick=function(t){return t=t,!0},this.handleDoubleClick=function(t){return t=t,!0},this.handleKeyPress=function(t){return t=t,!0},this.handleContextMenu=function(t){return t=t,!0},this.reset=function(){return!0},this},inherit(e.interactorStyle,e.object),e.trackballInteractorStyle=function(){"use strict";if(!(this instanceof e.trackballInteractorStyle))return new e.trackballInteractorStyle;e.interactorStyle.call(this);var t,i=this,n=!1,r=!1,o=!1,s={x:0,y:0},u={x:0,y:0};return this.handleMouseMove=function(e){var l,h,c,d,f,p,m,v,g,y,x,_=i.viewer().renderWindow().windowSize()[0],b=i.viewer().renderWindow().windowSize()[1],w=i.viewer().renderWindow().activeRenderer(),M=w.camera(),T=i.viewer().relMouseCoords(e);if(t=!1,s={x:0,y:0},T.x<0||T.x>_?(s.x=0,t=!0):s.x=T.x,T.y<0||T.y>b?(s.y=0,t=!0):s.y=T.y,t!==!0)return l=M.focalPoint(),c=a.fromValues(l[0],l[1],l[2],1),h=w.worldToDisplay(c,M.viewMatrix(),M.projectionMatrix(),_,b),d=a.fromValues(s.x,s.y,h[2],1),f=a.fromValues(u.x,u.y,h[2],1),p=w.displayToWorld(d,M.viewMatrix(),M.projectionMatrix(),_,b),m=w.displayToWorld(f,M.viewMatrix(),M.projectionMatrix(),_,b),v=p[0]-m[0],g=p[1]-m[1],y=p[2]-m[2],o&&(M.pan(-v,-g,-y),i.viewer().render()),n&&(M.rotate(u.x-s.x,u.y-s.y),w.resetCameraClippingRange(),i.viewer().render()),r&&(x=2*(s.y-u.y)/b,x>0?M.zoom(1-Math.abs(x)):M.zoom(1+Math.abs(x)),w.resetCameraClippingRange(),i.viewer().render()),u.x=s.x,u.y=s.y,!1},this.handleMouseDown=function(t){var e;return 0===t.button&&(n=!0),1===t.button&&(o=!0),2===t.button&&(r=!0),e=i.viewer().relMouseCoords(t),e.x<0?u.x=0:u.x=e.x,e.y<0?u.y=0:u.y=e.y,!1},this.handleMouseUp=function(t){return 0===t.button&&(n=!1),1===t.button&&(o=!1),2===t.button&&(r=!1),!1},this.handleMouseWheel=function(t){var e=i.viewer().renderWindow().activeRenderer(),n=e.camera();return t.originalEvent.wheelDelta<0?n.zoom(.9):n.zoom(1.1),e.resetCameraClippingRange(),i.viewer().render(),!0},this},inherit(e.trackballInteractorStyle,e.interactorStyle),e.pvwInteractorStyle=function(){"use strict";function t(){r.resetCameraClippingRange(),b.viewer().render()}if(!(this instanceof e.pvwInteractorStyle))return new e.pvwInteractorStyle;e.trackballInteractorStyle.call(this);var i,n,r,o,s,u,l,h,c,d,f,p,m,v,g,y,x,_,b=this,w=!1,M=!1,T=!1,A={x:0,y:0};return this.handleMouseMove=function(e){var E=[],C=null,S=[],R=null;for(i=b.viewer().renderWindow().windowSize()[0],n=b.viewer().renderWindow().windowSize()[1],r=b.viewer().renderWindow().activeRenderer(),o=r.camera(),s=!1,u=b.viewer().relMouseCoords(e),l={x:0,y:0},E=b.viewer().renderWindow().renderers(),C=0;C<E.length;C+=1)r!==E[C]&&S.push(E[C].camera());if(u.x<0||u.x>i?(l.x=0,s=!0):l.x=u.x,u.y<0||u.y>n?(l.y=0,s=!0):l.y=u.y,s!==!0){if(h=o.focalPoint(),c=a.fromValues(h[0],h[1],h[2],1),d=r.worldToDisplay(c,o.viewMatrix(),o.projectionMatrix(),i,n),f=a.fromValues(l.x,l.y,d[2],1),p=a.fromValues(A.x,A.y,d[2],1),m=r.displayToWorld(f,o.viewMatrix(),o.projectionMatrix(),i,n),v=r.displayToWorld(p,o.viewMatrix(),o.projectionMatrix(),i,n),g=m[0]-v[0],y=m[1]-v[1],x=m[2]-v[2],T&&(o.pan(-g,-y,-x),t()),w){for(R=[A.x-l.x,A.y-l.y],o.rotate(R[0],R[1]),C=0;C<S.length;C+=1)S[C].rotate(R[0],R[1]);for(C=0;C<E.length;C+=1)E[C].resetCameraClippingRange();t()}return M&&(_=2*(l.y-A.y)/n,_>0?o.zoom(1-Math.abs(_)):o.zoom(1+Math.abs(_)),t()),A.x=l.x,A.y=l.y,!1}},this.handleMouseDown=function(t){return 0===t.button&&(w=!0),1===t.button&&(T=!0),2===t.button&&(M=!0),u=b.viewer().relMouseCoords(t),u.x<0?A.x=0:A.x=u.x,u.y<0?A.y=0:A.y=u.y,!1},this.handleMouseUp=function(t){return 0===t.button&&(w=!1),1===t.button&&(T=!1),2===t.button&&(M=!1),!1},this},inherit(e.pvwInteractorStyle,e.trackballInteractorStyle),e.viewer=function(t,i){"use strict";if(!(this instanceof e.viewer))return new e.viewer(t,i);e.object.call(this);var n=this,r=t,o=!0,a=null,s=e.renderer(i),u=e.renderWindow(r);return this.canvas=function(){return r},this.renderWindow=function(){return u},this.init=function(){null!==u?u._setup():console.log("[ERROR] No render window attached")},this.exit=function(t){null!==u?u._cleanup(t):console.log("[ERROR] No render window attached")},this.interactorStyle=function(){return a},this.setInteractorStyle=function(t){t!==a&&(a=t,a.setViewer(this),this.modified())},this.handleMouseDown=function(t){if(o===!0){var i=l.event.fix(t||window.event);2===t.button&&i.preventDefault(),i.state="down",i.type=e.event.mousePress,l(n).trigger(i)}return!0},this.handleMouseUp=function(t){if(o===!0){var i=l.event.fix(t||window.event);i.preventDefault(),i.state="up",i.type=e.event.mouseRelease,l(n).trigger(i)}return!0},this.handleMouseMove=function(t){if(o===!0){var i=l.event.fix(t||window.event);i.preventDefault(),i.type=e.event.mouseMove,l(n).trigger(i)}return!0},this.handleMouseWheel=function(t){if(o===!0){var i=l.event.fix(t||window.event);i.preventDefault(),i.type=e.event.mouseWheel,l(n).trigger(i)}return!0},this.handleMouseOut=function(t){if(o===!0){var i=l.event.fix(t||window.event);i.preventDefault(),i.type=e.event.mouseOut,l(n).trigger(i)}return!0},this.handleKeyPress=function(t){if(o===!0){var i=l.event.fix(t||window.event);i.preventDefault(),i.type=e.event.keyPress,l(n).trigger(i)}return!0},this.handleContextMenu=function(t){if(o===!0){var i=l.event.fix(t||window.event);i.preventDefault(),i.type=e.event.contextMenu,l(n).trigger(i)}return!1},this.handleClick=function(t){if(o===!0){var i=l.event.fix(t||window.event);i.preventDefault(),i.type=e.event.click,l(n).trigger(i)}return!1},this.handleDoubleClick=function(t){if(o===!0){var i=l.event.fix(t||window.event);i.preventDefault(),i.type=e.event.dblClick,l(n).trigger(i)}return!1},this.relMouseCoords=function(t){if(void 0===t.pageX||void 0===t.pageY)throw"Missing attributes pageX and pageY on the event";var e=0,i=0,n=0,o=0,a=r;do e+=a.offsetLeft-a.scrollLeft,i+=a.offsetTop-a.scrollTop,a=a.offsetParent;while(a);return n=t.pageX-e,o=t.pageY-i,{x:n,y:o}},this.render=function(){u.render()},this.bindEventHandlers=function(){l(r).on("mousedown",this.handleMouseDown),l(r).on("mouseup",this.handleMouseUp),l(r).on("mousemove",this.handleMouseMove),l(r).on("mousewheel",this.handleMouseWheel),l(r).on("contextmenu",this.handleContextMenu)},this.unbindEventHandlers=function(){l(r).off("mousedown",this.handleMouseDown),l(r).off("mouseup",this.handleMouseUp),l(r).off("mousemove",this.handleMouseMove),l(r).off("mousewheel",this.handleMouseWheel),l(r).off("contextmenu",this.handleContextMenu)},this._init=function(){this.bindEventHandlers(),u.addRenderer(s)},this._init(),this},inherit(e.viewer,e.object),e.shader=function(t){"use strict";if(!(this instanceof e.shader))return new e.shader(t);e.object.call(this);var i=[],n=t,r="";this._getContextEntry=function(t){var n,r,o=t.m_context;for(n=0;n<i.length;n+=1)if(i[n].context===o)return i[n];return r={context:o,compileTimestamp:e.timestamp()},i.push(r),r},this.removeContext=function(t){var e,n=t.m_context;for(e=0;e<i.length;e+=1)if(i[e].context===n)return void i.splice(e,1)},this.shaderHandle=function(t){var e=this._getContextEntry(t);return e.shaderHandle},this.shaderType=function(){return n},this.shaderSource=function(){return r},this.setShaderSource=function(t){r=t,this.modified()},this.compile=function(t){var i=this._getContextEntry(t);return this.getMTime()<i.compileTimestamp.getMTime()?i.shaderHandle:(t.m_context.deleteShader(i.shaderHandle),i.shaderHandle=t.m_context.createShader(n),t.m_context.shaderSource(i.shaderHandle,r),t.m_context.compileShader(i.shaderHandle),t.m_context.getShaderParameter(i.shaderHandle,e.GL.COMPILE_STATUS)?(i.compileTimestamp.modified(),i.shaderHandle):(console.log("[ERROR] An error occurred compiling the shaders: "+t.m_context.getShaderInfoLog(i.shaderHandle)),console.log(r),t.m_context.deleteShader(i.shaderHandle),null))},this.attachShader=function(t,e){t.m_context.attachShader(e,this.shaderHandle(t))}},inherit(e.shader,e.object),function(){"use strict";var t=[],i=10;e.getCachedShader=function(n,r,o){for(var a=0;a<t.length;a+=1)if(t[a].type===n&&t[a].context===r&&t[a].source===o)return a&&t.splice(0,0,t.splice(a,1)[0]),t[0].shader;var s=new e.shader(n);return s.setShaderSource(o),t.unshift({type:n,context:r,source:o,shader:s}),t.length>=i&&t.splice(i,t.length-i),s},e.clearCachedShaders=function(e){for(var i=t.length-1;i>=0;i-=1)null!==e&&void 0!==e&&t[i].context!==e||t.splice(i,1)}}();var n=function(){"use strict";var t=".",e=document.getElementsByTagName("script");if(e.length>0){var i=e.length-1,n=e[i];i=n.src.lastIndexOf("/"),t=n.src.substring(0,i)}return function(){return t}}();return e.shaderProgram=function(){"use strict";if(!(this instanceof e.shaderProgram))return new e.shaderProgram;e.materialAttribute.call(this,e.materialAttributeType.ShaderProgram);var t=this,i=0,r=e.timestamp(),o=e.timestamp(),a=[],s=[],u={},h={},c={};return this.loadFromFile=function(i,n){var r,o=!1;return l.ajax({url:n,type:"GET",dataType:"text",async:!1,success:function(n){r=e.shader(i),r.setShaderSource(n),t.addShader(r),o=!0}}),o},this.loadShader=function(t,e){return this.loadFromFile(t,n()+"/shaders/"+e)},this.queryUniformLocation=function(t,e){return t.m_context.getUniformLocation(i,e)},this.queryAttributeLocation=function(t,e){return t.m_context.getAttribLocation(i,e)},this.addShader=function(e){if(a.indexOf(e)>-1)return!1;var i;for(i=a.length-2;i>=0;i-=1)a[i].shaderType()===e.shaderType()&&a.splice(i,1);return a.push(e),t.modified(),!0},this.addUniform=function(e){return!(s.indexOf(e)>-1)&&(s.push(e),t.modified(),!0)},this.addVertexAttribute=function(e,i){u[i]=e,t.modified()},this.uniformLocation=function(t){return h[t]},this.attributeLocation=function(t){return c[t]},this.uniform=function(t){var e;for(e=0;e<s.length;e+=1)if(s[e].name()===t)return s[e];return null},this.updateUniforms=function(t){var e;for(e=0;e<s.length;e+=1)s[e].callGL(t,h[s[e].name()])},this.link=function(t){return t.m_context.linkProgram(i),!!t.m_context.getProgramParameter(i,e.GL.LINK_STATUS)||(console.log("[ERROR] Unable to initialize the shader program."),!1)},this.use=function(t){t.m_context.useProgram(i)},this._setup=function(t){0===i&&(i=t.m_context.createProgram())},this._cleanup=function(e){t.deleteVertexAndFragment(e),t.deleteProgram(e)},this.deleteProgram=function(t){t.m_context.deleteProgram(i),i=0},this.deleteVertexAndFragment=function(t){var e;for(e=0;e<a.length;e+=1)t.m_context.detachShader(a[e].shaderHandle(t)),t.m_context.deleteShader(a[e].shaderHandle(t)),a[e].removeContext(t)},this.compileAndLink=function(e){var n;if(!(r.getMTime()>=this.getMTime())){for(t._setup(e),n=0;n<a.length;n+=1)a[n].compile(e),a[n].attachShader(e,i);t.bindAttributes(e),t.link(e)||(console.log("[ERROR] Failed to link Program"),t._cleanup(e)),r.modified()}},this.bind=function(e){var i=0;for(o.getMTime()<t.getMTime()?(t.compileAndLink(e),
t.use(e),t.bindUniforms(e),o.modified()):t.use(e),i=0;i<s.length;i+=1)s[i].update(e,t);t.updateUniforms(e)},this.undoBind=function(t){t.m_context.useProgram(null)},this.bindVertexData=function(t,e){u.hasOwnProperty(e)&&u[e].bindVertexData(t,e)},this.undoBindVertexData=function(t,e){u.hasOwnProperty(e)&&u[e].undoBindVertexData(t,e)},this.bindUniforms=function(t){var e;for(e=0;e<s.length;e+=1)h[s[e].name()]=this.queryUniformLocation(t,s[e].name())},this.bindAttributes=function(t){var e,n;for(e in u)u.hasOwnProperty(e)&&(n=u[e].name(),t.m_context.bindAttribLocation(i,e,n),c[n]=e)},t},inherit(e.shaderProgram,e.materialAttribute),e.texture=function(){"use strict";function t(t){switch(n.m_textureUnit){case 0:t.m_context.activeTexture(e.GL.TEXTURE0);break;case 1:t.m_context.activeTexture(e.GL.TEXTURE1);break;case 2:t.m_context.activeTexture(e.GL.TEXTURE2);break;case 3:t.m_context.activeTexture(e.GL.TEXTURE3);break;case 4:t.m_context.activeTexture(e.GL.TEXTURE4);break;case 5:t.m_context.activeTexture(e.GL.TEXTURE5);break;case 6:t.m_context.activeTexture(e.GL.TEXTURE6);break;case 7:t.m_context.activeTexture(e.GL.TEXTURE7);break;case 8:t.m_context.activeTexture(e.GL.TEXTURE8);break;case 9:t.m_context.activeTexture(e.GL.TEXTURE9);break;case 10:t.m_context.activeTexture(e.GL.TEXTURE10);break;case 11:t.m_context.activeTexture(e.GL.TEXTURE11);break;case 12:t.m_context.activeTexture(e.GL.TEXTURE12);break;case 13:t.m_context.activeTexture(e.GL.TEXTURE13);break;case 14:t.m_context.activeTexture(e.GL.TEXTURE14);break;case 15:t.m_context.activeTexture(e.GL.TEXTURE15);break;default:throw"[error] Texture unit "+n.m_textureUnit+" is not supported"}}if(!(this instanceof e.texture))return new e.texture;e.materialAttribute.call(this,e.materialAttributeType.Texture),this.m_width=0,this.m_height=0,this.m_depth=0,this.m_textureHandle=null,this.m_textureUnit=0,this.m_pixelFormat=e.GL.RGBA,this.m_pixelDataType=e.GL.UNSIGNED_BYTE,this.m_internalFormat=e.GL.RGBA,this.m_nearestPixel=!1,this.m_image=null;var i=e.timestamp(),n=this;return this.setup=function(n){t(n),n.m_context.deleteTexture(this.m_textureHandle),this.m_textureHandle=n.m_context.createTexture(),n.m_context.bindTexture(e.GL.TEXTURE_2D,this.m_textureHandle),n.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MIN_FILTER,this.m_nearestPixel?e.GL.NEAREST:e.GL.LINEAR),n.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MAG_FILTER,this.m_nearestPixel?e.GL.NEAREST:e.GL.LINEAR),n.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_S,e.GL.CLAMP_TO_EDGE),n.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_T,e.GL.CLAMP_TO_EDGE),null!==this.m_image?(n.m_context.pixelStorei(e.GL.UNPACK_ALIGNMENT,1),n.m_context.pixelStorei(e.GL.UNPACK_FLIP_Y_WEBGL,!0),this.updateDimensions(),this.computeInternalFormatUsingImage(),n.m_context.texImage2D(e.GL.TEXTURE_2D,0,this.m_internalFormat,this.m_pixelFormat,this.m_pixelDataType,this.m_image)):n.m_context.texImage2D(e.GL.TEXTURE_2D,0,this.m_internalFormat,this.m_width,this.m_height,0,this.m_pixelFormat,this.m_pixelDataType,null),n.m_context.bindTexture(e.GL.TEXTURE_2D,null),i.modified()},this.bind=function(n){this.getMTime()>i.getMTime()&&this.setup(n),t(n),n.m_context.bindTexture(e.GL.TEXTURE_2D,this.m_textureHandle)},this.undoBind=function(t){t.m_context.bindTexture(e.GL.TEXTURE_2D,null)},this.image=function(){return this.m_image},this.setImage=function(t){return null!==t&&(this.m_image=t,this.updateDimensions(),this.modified(),!0)},this.nearestPixel=function(){return this.m_nearestPixel},this.setNearestPixel=function(t){return t=!!t,t!==this.m_nearestPixel&&(this.m_nearestPixel=t,this.modified(),!0)},this.textureUnit=function(){return this.m_textureUnit},this.setTextureUnit=function(t){return this.m_textureUnit!==t&&(this.m_textureUnit=t,this.modified(),!0)},this.width=function(){return this.m_width},this.setWidth=function(t){return n.m_width!==t&&(n.m_width=t,n.modified(),!0)},this.height=function(){return n.m_height},this.setHeight=function(t){return n.m_height!==t&&(n.m_height=t,n.modified(),!0)},this.depth=function(){return this.m_depth},this.setDepth=function(t){return null!==this.m_image&&(this.m_depth=t,this.modified(),!0)},this.textureHandle=function(){return this.m_textureHandle},this.internalFormat=function(){return this.m_internalFormat},this.setInternalFormat=function(t){return this.m_internalFormat!==t&&(this.m_internalFormat=t,this.modified(),!0)},this.pixelFormat=function(){return this.m_pixelFormat},this.setPixelFormat=function(t){return null!==this.m_image&&(this.m_pixelFormat=t,this.modified(),!0)},this.pixelDataType=function(){return this.m_pixelDataType},this.setPixelDataType=function(t){return null!==this.m_image&&(this.m_pixelDataType=t,this.modified(),!0)},this.computeInternalFormatUsingImage=function(){this.m_internalFormat=e.GL.RGBA,this.m_pixelFormat=e.GL.RGBA,this.m_pixelDataType=e.GL.UNSIGNED_BYTE},this.updateDimensions=function(){null!==this.m_image&&(this.m_width=this.m_image.width,this.m_height=this.m_image.height,this.m_depth=0)},this},inherit(e.texture,e.materialAttribute),e.lookupTable=function(){"use strict";if(!(this instanceof e.lookupTable))return new e.lookupTable;e.texture.call(this);var t=e.timestamp(),i=[0,0];return this.m_colorTable=[.07514311,.468049805,1,1,.247872569,.498782363,1,1,.339526309,.528909511,1,1,.409505078,.558608486,1,1,.468487184,.588057293,1,1,.520796675,.617435078,1,1,.568724526,.646924167,1,1,.613686735,.676713218,1,1,.656658579,.707001303,1,1,.698372844,.738002964,1,1,.739424025,.769954435,1,1,.780330104,.803121429,1,1,.821573924,.837809045,1,1,.863634967,.874374691,1,1,.907017747,.913245283,1,1,.936129275,.938743558,.983038586,1,.943467973,.943498599,.943398095,1,.990146732,.928791426,.917447482,1,1,.88332677,.861943246,1,1,.833985467,.803839606,1,1,.788626485,.750707739,1,1,.746206642,.701389973,1,1,.70590052,.654994046,1,1,.667019783,.610806959,1,1,.6289553,.568237474,1,1,.591130233,.526775617,1,1,.552955184,.485962266,1,1,.513776083,.445364274,1,1,.472800903,.404551679,1,1,.428977855,.363073592,1,1,.380759558,.320428137,1,.961891484,.313155629,.265499262,1,.916482116,.236630659,.209939162,1].map(function(t){return 255*t}),this.setup=function(i){0===this.textureUnit()?i.m_context.activeTexture(e.GL.TEXTURE0):1===this.textureUnit()&&i.m_context.activeTexture(e.GL.TEXTURE1),i.m_context.deleteTexture(this.m_textureHandle),this.m_textureHandle=i.m_context.createTexture(),i.m_context.bindTexture(e.GL.TEXTURE_2D,this.m_textureHandle),i.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MIN_FILTER,e.GL.LINEAR),i.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MAG_FILTER,e.GL.LINEAR),i.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_S,e.GL.CLAMP_TO_EDGE),i.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_T,e.GL.CLAMP_TO_EDGE),i.m_context.pixelStorei(e.GL.UNPACK_ALIGNMENT,1),this.m_width=this.m_colorTable.length/4,this.m_height=1,this.m_depth=0,i.m_context.texImage2D(e.GL.TEXTURE_2D,0,e.GL.RGBA,this.m_width,this.m_height,this.m_depth,e.GL.RGBA,e.GL.UNSIGNED_BYTE,new Uint8Array(this.m_colorTable)),i.m_context.bindTexture(e.GL.TEXTURE_2D,null),t.modified()},this.colorTable=function(){return this.m_colorTable},this.setColorTable=function(t){return this.m_colorTable!==t&&(this.m_colorTable=t,this.modified(),!0)},this.range=function(){return i},this.setRange=function(t){return i!==t&&(i=t,this.modified(),!0)},this.updateRange=function(t){t instanceof Array||console.log("[error] Invalid data type for range. Requires array [min,max]"),t[0]<i[0]&&(i[0]=t[0],this.modified()),t[1]>i[1]&&(i[1]=t[1],this.modified())},this},inherit(e.lookupTable,e.texture),e.uniform=function(t,i){"use strict";if(!(this instanceof e.uniform))return new e.uniform;this.getTypeNumberOfComponents=function(t){switch(t){case e.GL.FLOAT:case e.GL.INT:case e.GL.BOOL:return 1;case e.GL.FLOAT_VEC2:case e.GL.INT_VEC2:case e.GL.BOOL_VEC2:return 2;case e.GL.FLOAT_VEC3:case e.GL.INT_VEC3:case e.GL.BOOL_VEC3:return 3;case e.GL.FLOAT_VEC4:case e.GL.INT_VEC4:case e.GL.BOOL_VEC4:return 4;case e.GL.FLOAT_MAT3:return 9;case e.GL.FLOAT_MAT4:return 16;default:return 0}};var n=t,r=i,o=[];return o.length=this.getTypeNumberOfComponents(n),this.name=function(){return r},this.type=function(){return n},this.get=function(){return o},this.set=function(t){var e=0;if(16===o.length)for(e=0;e<16;e+=1)o[e]=t[e];else if(9===o.length)for(e=0;e<9;e+=1)o[e]=t[e];else if(4===o.length)for(e=0;e<4;e+=1)o[e]=t[e];else if(3===o.length)for(e=0;e<3;e+=1)o[e]=t[e];else if(2===o.length)for(e=0;e<2;e+=1)o[e]=t[e];else o[0]=t},this.callGL=function(t,i){if(!(this.m_numberElements<1))switch(n){case e.GL.BOOL:case e.GL.INT:t.m_context.uniform1iv(i,o);break;case e.GL.FLOAT:t.m_context.uniform1fv(i,o);break;case e.GL.FLOAT_VEC2:t.m_context.uniform2fv(i,o);break;case e.GL.FLOAT_VEC3:t.m_context.uniform3fv(i,o);break;case e.GL.FLOAT_VEC4:t.m_context.uniform4fv(i,o);break;case e.GL.FLOAT_MAT3:t.m_context.uniformMatrix3fv(i,e.GL.FALSE,o);break;case e.GL.FLOAT_MAT4:t.m_context.uniformMatrix4fv(i,e.GL.FALSE,o)}},this.update=function(t,e){t=t,e=e},this},e.modelViewUniform=function(t){"use strict";return this instanceof e.modelViewUniform?(0===t.length&&(t="modelViewMatrix"),e.uniform.call(this,e.GL.FLOAT_MAT4,t),this.set(o.create()),this.update=function(t,e){e=e,this.set(t.m_modelViewMatrix)},this):new e.modelViewUniform(t)},inherit(e.modelViewUniform,e.uniform),e.modelViewOriginUniform=function(t,i){"use strict";if(!(this instanceof e.modelViewOriginUniform))return new e.modelViewOriginUniform(t,i);0===t.length&&(t="modelViewMatrix"),i=i||[0,0,0];var n=[i[0],i[1],i[2]||0];return e.uniform.call(this,e.GL.FLOAT_MAT4,t),this.set(o.create()),this.setOrigin=function(t){t=t||[0,0,0],n=[t[0],t[1],t[2]||0]},this.update=function(t,e){e=e;var i=o.create();if(o.translate(i,t.m_modelViewMatrix,n),t.m_modelViewAlignment){var r=t.m_modelViewAlignment;i[12]=Math.round(i[12]/r.roundx)*r.roundx+r.dx,i[13]=Math.round(i[13]/r.roundy)*r.roundy+r.dy}this.set(i)},this},inherit(e.modelViewOriginUniform,e.uniform),e.projectionUniform=function(t){"use strict";return this instanceof e.projectionUniform?(0===t.length&&(t="projectionMatrix"),e.uniform.call(this,e.GL.FLOAT_MAT4,t),this.set(o.create()),this.update=function(t,e){e=e,this.set(t.m_projectionMatrix)},this):new e.projectionUniform(t)},inherit(e.projectionUniform,e.uniform),e.floatUniform=function(t,i){"use strict";return this instanceof e.floatUniform?(0===t.length&&(t="floatUniform"),i=void 0===i?1:i,e.uniform.call(this,e.GL.FLOAT,t),void this.set(i)):new e.floatUniform(t,i)},inherit(e.floatUniform,e.uniform),e.normalMatrixUniform=function(t){"use strict";return this instanceof e.normalMatrixUniform?(0===t.length&&(t="normalMatrix"),e.uniform.call(this,e.GL.FLOAT_MAT4,t),this.set(o.create()),this.update=function(t,e){e=e,this.set(t.m_normalMatrix)},this):new e.normalMatrixUniform(t)},inherit(e.normalMatrixUniform,e.uniform),e.vertexAttributeKeys={Position:0,Normal:1,TextureCoordinate:2,Color:3,Scalar:4,CountAttributeIndex:5},e.vertexAttributeKeysIndexed={Zero:0,One:1,Two:2,Three:3,Four:4,Five:5,Six:6,Seven:7,Eight:8,Nine:9},e.vertexAttribute=function(t){"use strict";if(!(this instanceof e.vertexAttribute))return new e.vertexAttribute(t);var i=t;this.name=function(){return i},this.bindVertexData=function(t,e){var n=t.m_mapper.geometryData(),r=n.sourceData(e),o=t.m_material.shaderProgram();t.m_context.vertexAttribPointer(o.attributeLocation(i),r.attributeNumberOfComponents(e),r.attributeDataType(e),r.normalized(e),r.attributeStride(e),r.attributeOffset(e)),t.m_context.enableVertexAttribArray(o.attributeLocation(i))},this.undoBindVertexData=function(t,e){e=e;var n=t.m_material.shaderProgram();t.m_context.disableVertexAttribArray(n.attributeLocation(i))}},e.source=function(){"use strict";return this instanceof e.source?(e.object.call(this),this.create=function(){},this):new e.source},inherit(e.source,e.object),e.planeSource=function(){"use strict";if(!(this instanceof e.planeSource))return new e.planeSource;e.source.call(this);var t=[0,0,0],i=[1,0,0],n=[0,1,0],r=[0,0,1],o=1,a=1,s=null;this.setOrigin=function(e,i,n){t[0]=e,t[1]=i,t[2]=n},this.setPoint1=function(t,e,n){i[0]=t,i[1]=e,i[2]=n},this.setPoint2=function(t,e,i){n[0]=t,n[1]=e,n[2]=i},this.create=function(){s=new e.geometryData;var u,l,h,c,d,f=[],p=[],m=[],v=[],g=[],y=0,x=0,_=0,b=0,w=[],M=[],T=[],A=[],E=[],C=null,S=null,R=null;for(f.length=3,p.length=2,m.length=3,v.length=3,g.length=3,u=0;u<3;u+=1)m[u]=i[u]-t[u],v[u]=n[u]-t[u];for(c=(o+1)*(a+1),w.length=3*c,M.length=3*c,A.length=2*c,E.length=c,u=0;u<a+1;u+=1)for(p[1]=u/a,l=0;l<o+1;l+=1){for(p[0]=l/o,h=0;h<3;h+=1)f[h]=t[h]+p[0]*m[h]+p[1]*v[h];w[y++]=f[0],w[y++]=f[1],w[y++]=f[2],T[_++]=1,T[_++]=1,T[_++]=1,M[x++]=r[0],M[x++]=r[1],M[x++]=r[2],A[b++]=p[0],A[b++]=p[1]}for(u=0;u<a;u+=1)for(l=0;l<o;l+=1)g[0]=l+u*(o+1),g[1]=g[0]+1,g[2]=g[0]+o+2,g[3]=g[0]+o+1;for(u=0;u<c;u+=1)E[u]=u;return C=new e.triangleStrip,C.setIndices(E),S=e.sourceDataP3fv(),S.pushBack(w),R=e.sourceDataC3fv(),R.pushBack(T),d=e.sourceDataT2fv(),d.pushBack(A),s.addSource(S),s.addSource(R),s.addSource(d),s.addPrimitive(C),s}},inherit(e.planeSource,e.source),e.pointSource=function(){"use strict";if(!(this instanceof e.pointSource))return new e.pointSource;e.source.call(this);var t=this,i=[],n=[],r=[],o=[],a=null;this.getPositions=function(){return i},this.setPositions=function(e){e instanceof Array?i=e:console.log("[ERROR] Invalid data type for positions. Array is required."),t.modified()},this.getColors=function(){return n},this.setColors=function(e){e instanceof Array?n=e:console.log("[ERROR] Invalid data type for colors. Array is required."),t.modified()},this.getSize=function(){return o},this.setSize=function(t){o=t,this.modified()},this.setTextureCoordinates=function(e){e instanceof Array?r=e:console.log("[ERROR] Invalid data type for texture coordinates. Array is required."),t.modified()},this.create=function(){if(a=new e.geometryData,i.length%3!==0)return void console.log("[ERROR] Invalid length of the points array");var t,s,u,l,h,c=i.length/3,d=0,f=[];for(f.length=c,d=0;d<c;d+=1)f[d]=d;if(h=e.sourceDataDf(),c!==o.length)for(d=0;d<c;d+=1)h.pushBack(o);else h.setData(o);return a.addSource(h),t=new e.points,t.setIndices(f),s=e.sourceDataP3fv(),s.pushBack(i),a.addSource(s),n.length>0&&n.length===i.length?(u=e.sourceDataC3fv(),u.pushBack(n),a.addSource(u)):n.length>0&&n.length!==i.length&&console.log("[ERROR] Number of colors are different than number of points"),r.length>0&&r.length===i.length?(l=e.sourceDataT2fv(),l.pushBack(r),a.addSource(l)):r.length>0&&r.length/2!==i.length/3&&console.log("[ERROR] Number of texture coordinates are different than number of points"),a.addPrimitive(t),a}},inherit(e.pointSource,e.source),e.lineSource=function(t,i){"use strict";if(!(this instanceof e.lineSource))return new e.lineSource;e.source.call(this);var n=t,r=i;this.setPositions=function(t){return t instanceof Array?(n=t,this.modified(),!0):(console.log("[ERROR] Invalid data type for positions. Array is required."),!1)},this.setColors=function(t){return t instanceof Array?(r=t,this.modified(),!0):(console.log("[ERROR] Invalid data type for colors. Array is required."),!1)},this.create=function(){if(!n)return void console.log("[error] Invalid positions");if(n.length%3!==0)return void console.log("[error] Line source requires 3d points");if(n.length%3!==0)return void console.log("[ERROR] Invalid length of the points array");var t,i,o,a,s=new e.geometryData,u=n.length/3,l=[];for(l.length=u,t=0;t<u;t+=1)l[t]=t;return i=new e.lines,i.setIndices(l),o=e.sourceDataP3fv(),o.pushBack(n),s.addSource(o),r&&r.length>0&&r.length===n.length?(a=e.sourceDataC3fv(),a.pushBack(r),s.addSource(a)):r&&r.length>0&&r.length!==n.length&&console.log("[error] Number of colors are different than number of points"),s.addPrimitive(i),s}},inherit(e.lineSource,e.source),e.utils=function(){"use strict";return this instanceof e.utils?(e.object.call(this),this):new e.utils},inherit(e.utils,e.object),e.utils.computePowerOfTwo=function(t,e){"use strict";for(e=e||1;e<t;)e*=2;return e},e.utils.createTextureVertexShader=function(t){"use strict";var i=["attribute vec3 vertexPosition;","attribute vec3 textureCoord;","uniform mediump float pointSize;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","varying highp vec3 iTextureCoord;","void main(void)","{","gl_PointSize = pointSize;","gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);"," iTextureCoord = textureCoord;","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,i)},e.utils.createTextureFragmentShader=function(t){"use strict";var i=["varying highp vec3 iTextureCoord;","uniform sampler2D sampler2d;","uniform mediump float opacity;","void main(void) {","gl_FragColor = vec4(texture2D(sampler2d, vec2(iTextureCoord.s, iTextureCoord.t)).xyz, opacity);","}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,i)},e.utils.createRgbaTextureFragmentShader=function(t){"use strict";var i=["varying highp vec3 iTextureCoord;","uniform sampler2D sampler2d;","uniform mediump float opacity;","void main(void) {","  mediump vec4 color = vec4(texture2D(sampler2d, vec2(iTextureCoord.s, iTextureCoord.t)).xyzw);","  color.w *= opacity;","  gl_FragColor = color;","}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,i)},e.utils.createVertexShader=function(t){"use strict";var i=["attribute vec3 vertexPosition;","attribute vec3 vertexColor;","uniform mediump float pointSize;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","varying mediump vec3 iVertexColor;","varying highp vec3 iTextureCoord;","void main(void)","{","gl_PointSize = pointSize;","gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);"," iVertexColor = vertexColor;","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,i)},e.utils.createPointVertexShader=function(t){"use strict";var i=["attribute vec3 vertexPosition;","attribute vec3 vertexColor;","attribute float vertexSize;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","varying mediump vec3 iVertexColor;","varying highp vec3 iTextureCoord;","void main(void)","{","gl_PointSize =  vertexSize;","gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);"," iVertexColor = vertexColor;","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,i)},e.utils.createVertexShaderSolidColor=function(t){"use strict";var i=["attribute vec3 vertexPosition;","uniform mediump float pointSize;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","void main(void)","{","gl_PointSize = pointSize;","gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,i)},e.utils.createVertexShaderColorMap=function(t,i,n){"use strict";i=i,n=n;var r=["attribute vec3 vertexPosition;","attribute float vertexScalar;","uniform mediump float pointSize;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float lutMin;","uniform float lutMax;","varying mediump float iVertexScalar;","void main(void)","{","gl_PointSize = pointSize;","gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);","iVertexScalar = (vertexScalar-lutMin)/(lutMax-lutMin);","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,r)},e.utils.createFragmentShader=function(t){"use strict";var i=["varying mediump vec3 iVertexColor;","uniform mediump float opacity;","void main(void) {","gl_FragColor = vec4(iVertexColor, opacity);","}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,i)},e.utils.createPhongVertexShader=function(t){"use strict";var i=["attribute highp vec3 vertexPosition;","attribute mediump vec3 vertexNormal;","attribute mediump vec3 vertexColor;","uniform highp mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 normalMatrix;","varying highp vec4 varPosition;","varying mediump vec3 varNormal;","varying mediump vec3 varVertexColor;","void main(void)","{","varPosition = modelViewMatrix * vec4(vertexPosition, 1.0);","gl_Position = projectionMatrix * varPosition;","varNormal = vec3(normalMatrix * vec4(vertexNormal, 0.0));","varVertexColor = vertexColor;","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,i)},e.utils.createPhongFragmentShader=function(t){"use strict";var i=["uniform mediump float opacity;","precision mediump float;","varying vec3 varNormal;","varying vec4 varPosition;","varying mediump vec3 varVertexColor;","const vec3 lightPos = vec3(0.0, 0.0,10000.0);","const vec3 ambientColor = vec3(0.01, 0.01, 0.01);","const vec3 specColor = vec3(0.0, 0.0, 0.0);","void main() {","vec3 normal = normalize(varNormal);","vec3 lightDir = normalize(lightPos);","vec3 reflectDir = -reflect(lightDir, normal);","vec3 viewDir = normalize(-varPosition.xyz);","float lambertian = max(dot(lightDir, normal), 0.0);","vec3 color = vec3(0.0);","if(lambertian > 0.0) {","  color = lambertian * varVertexColor;","}","gl_FragColor = vec4(color * opacity, 1.0 - opacity);","}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,i)},e.utils.createFragmentShaderSolidColor=function(t,i){"use strict";var n=["uniform mediump float opacity;","void main(void) {","gl_FragColor = vec4("+i[0]+","+i[1]+","+i[2]+", opacity);","}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,n)},e.utils.createFragmentShaderColorMap=function(t){"use strict";var i=["varying mediump float iVertexScalar;","uniform sampler2D sampler2d;","uniform mediump float opacity;","void main(void) {","gl_FragColor = vec4(texture2D(sampler2d, vec2(iVertexScalar, 0.0)).xyz, opacity);","}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,i)},e.utils.createPointSpritesVertexShader=function(t){"use strict";var i=["attribute vec3 vertexPosition;","attribute vec3 vertexColor;","uniform mediump vec2 pointSize;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float height;","varying mediump vec3 iVertexColor;","varying highp float iVertexScalar;","void main(void)","{","mediump float realPointSize = pointSize.y;","if (pointSize.x > pointSize.y) {","  realPointSize = pointSize.x;}","gl_PointSize = realPointSize ;","iVertexScalar = vertexPosition.z;","gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition.xy, height, 1.0);"," iVertexColor = vertexColor;","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,i)},e.utils.createPointSpritesFragmentShader=function(t){"use strict";var i=["varying mediump vec3 iVertexColor;","varying highp float iVertexScalar;","uniform sampler2D opacityLookup;","uniform highp float lutMin;","uniform highp float lutMax;","uniform sampler2D scalarsToColors;","uniform int useScalarsToColors;","uniform int useVertexColors;","uniform mediump vec2 pointSize;","uniform mediump float vertexColorWeight;","void main(void) {","mediump vec2 realTexCoord;","if (pointSize.x > pointSize.y) {","  realTexCoord = vec2(1.0, pointSize.y/pointSize.x) * gl_PointCoord;","} else {","  realTexCoord = vec2(pointSize.x/pointSize.y, 1.0) * gl_PointCoord;","}","highp float texOpacity = texture2D(opacityLookup, realTexCoord).w;","if (useScalarsToColors == 1) {","  gl_FragColor = vec4(texture2D(scalarsToColors, vec2((iVertexScalar - lutMin)/(lutMax - lutMin), 0.0)).xyz, texOpacity);","} else if (useVertexColors == 1) {","  gl_FragColor = vec4(iVertexColor, texOpacity);","} else {","  gl_FragColor = vec4(texture2D(opacityLookup, realTexCoord).xyz, texOpacity);","}}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,i)},e.utils.createTextureMaterial=function(t,i){"use strict";var n,r=new e.material,o=new e.blend,a=new e.shaderProgram,s=e.utils.createTextureVertexShader(e.GL),u=null,l=new e.vertexAttribute("vertexPosition"),h=new e.vertexAttribute("textureCoord"),c=new e.floatUniform("pointSize",5),d=new e.projectionUniform("projectionMatrix"),f=new e.uniform(e.GL.INT,"sampler2d"),p=null;return n=void 0!==i?new e.modelViewOriginUniform("modelViewMatrix",i):new e.modelViewUniform("modelViewMatrix"),f.set(0),a.addVertexAttribute(l,e.vertexAttributeKeys.Position),a.addVertexAttribute(h,e.vertexAttributeKeys.TextureCoordinate),a.addUniform(c),a.addUniform(n),a.addUniform(d),u=t?e.utils.createRgbaTextureFragmentShader(e.GL):e.utils.createTextureFragmentShader(e.GL),p=new e.floatUniform("opacity",1),a.addUniform(p),a.addShader(u),a.addShader(s),r.addAttribute(a),r.addAttribute(o),r},e.utils.createGeometryMaterial=function(){"use strict";var t=new e.material,i=new e.shaderProgram,n=5,r=1,o=e.utils.createVertexShader(e.GL),a=e.utils.createFragmentShader(e.GL),s=new e.vertexAttribute("vertexPosition"),u=new e.vertexAttribute("vertexColor"),l=new e.floatUniform("pointSize",n),h=new e.floatUniform("opacity",r),c=new e.modelViewUniform("modelViewMatrix"),d=new e.projectionUniform("projectionMatrix");return i.addVertexAttribute(s,e.vertexAttributeKeys.Position),i.addVertexAttribute(u,e.vertexAttributeKeys.Color),i.addUniform(l),i.addUniform(h),i.addUniform(c),i.addUniform(d),i.addShader(a),i.addShader(o),t.addAttribute(i),t},e.utils.createPointGeometryMaterial=function(t){"use strict";t=void 0===t?1:t;var i=new e.material,n=new e.blend,r=new e.shaderProgram,o=e.utils.createPointVertexShader(e.GL),a=e.utils.createFragmentShader(e.GL),s=new e.vertexAttribute("vertexPosition"),u=new e.vertexAttribute("vertexColor"),l=new e.vertexAttribute("vertexSize"),h=new e.floatUniform("opacity",t),c=new e.modelViewUniform("modelViewMatrix"),d=new e.projectionUniform("projectionMatrix");return r.addVertexAttribute(s,e.vertexAttributeKeys.Position),r.addVertexAttribute(u,e.vertexAttributeKeys.Color),r.addVertexAttribute(l,e.vertexAttributeKeys.Scalar),r.addUniform(h),r.addUniform(c),r.addUniform(d),r.addShader(a),r.addShader(o),i.addAttribute(r),i.addAttribute(n),i},e.utils.createPhongMaterial=function(){"use strict";var t=new e.material,i=new e.shaderProgram,n=e.utils.createPhongVertexShader(e.GL),r=e.utils.createPhongFragmentShader(e.GL),o=new e.vertexAttribute("vertexPosition"),a=new e.vertexAttribute("vertexNormal"),s=new e.vertexAttribute("vertexColor"),u=new e.floatUniform("opacity",1),l=new e.modelViewUniform("modelViewMatrix"),h=new e.normalMatrixUniform("normalMatrix"),c=new e.projectionUniform("projectionMatrix");return i.addVertexAttribute(o,e.vertexAttributeKeys.Position),i.addVertexAttribute(a,e.vertexAttributeKeys.Normal),i.addVertexAttribute(s,e.vertexAttributeKeys.Color),i.addUniform(u),i.addUniform(l),i.addUniform(c),i.addUniform(h),i.addShader(r),i.addShader(n),t.addAttribute(i),t},e.utils.createColorMaterial=function(){"use strict";var t=new e.material,i=new e.blend,n=new e.shaderProgram,r=e.utils.createVertexShader(e.GL),o=e.utils.createFragmentShader(e.GL),a=new e.vertexAttribute("vertexPosition"),s=new e.vertexAttribute("textureCoord"),u=new e.vertexAttribute("vertexColor"),l=new e.floatUniform("pointSize",5),h=new e.floatUniform("opacity",1),c=new e.modelViewUniform("modelViewMatrix"),d=new e.projectionUniform("projectionMatrix");return n.addVertexAttribute(a,e.vertexAttributeKeys.Position),n.addVertexAttribute(u,e.vertexAttributeKeys.Color),n.addVertexAttribute(s,e.vertexAttributeKeys.TextureCoordinate),n.addUniform(l),n.addUniform(h),n.addUniform(c),n.addUniform(d),n.addShader(o),n.addShader(r),t.addAttribute(n),t.addAttribute(i),t},e.utils.createColorMappedMaterial=function(t){"use strict";t||(t=new e.lookupTable);var i=t.range(),n=new e.material,r=new e.blend,o=new e.shaderProgram,a=e.utils.createVertexShaderColorMap(e.GL,i[0],i[1]),s=e.utils.createFragmentShaderColorMap(e.GL),u=new e.vertexAttribute("vertexPosition"),l=new e.vertexAttribute("vertexScalar"),h=new e.floatUniform("pointSize",5),c=new e.floatUniform("opacity",1),d=new e.floatUniform("lutMin",i[0]),f=new e.floatUniform("lutMax",i[1]),p=new e.modelViewUniform("modelViewMatrix"),m=new e.projectionUniform("projectionMatrix"),v=new e.uniform(e.GL.FLOAT,"sampler2d"),g=t;return v.set(0),o.addVertexAttribute(u,e.vertexAttributeKeys.Position),o.addVertexAttribute(l,e.vertexAttributeKeys.Scalar),o.addUniform(h),o.addUniform(c),o.addUniform(d),o.addUniform(f),o.addUniform(p),o.addUniform(m),o.addShader(s),o.addShader(a),n.addAttribute(o),n.addAttribute(r),n.addAttribute(g),n},e.utils.updateColorMappedMaterial=function(t,e){"use strict";if(!t)return void console.log("[warning] Invalid material. Nothing to update.");if(!e)return void console.log("[warning] Invalid lookup table. Nothing to update.");var i=t.shaderProgram().uniform("lutMin"),n=t.shaderProgram().uniform("lutMax");i.set(e.range()[0]),n.set(e.range()[1]),t.setAttribute(e)},e.utils.createSolidColorMaterial=function(t){"use strict";t||(t=[1,1,1]);var i=new e.material,n=new e.blend,r=new e.shaderProgram,o=e.utils.createVertexShaderSolidColor(e.GL),a=e.utils.createFragmentShaderSolidColor(e.GL,t),s=new e.vertexAttribute("vertexPosition"),u=new e.floatUniform("pointSize",5),l=new e.floatUniform("opacity",1),h=new e.modelViewUniform("modelViewMatrix"),c=new e.projectionUniform("projectionMatrix");return r.addVertexAttribute(s,e.vertexAttributeKeys.Position),r.addUniform(u),r.addUniform(l),r.addUniform(h),r.addUniform(c),r.addShader(a),r.addShader(o),i.addAttribute(r),i.addAttribute(n),i},e.utils.createPointSpritesMaterial=function(t,i){"use strict";var n=void 0===i?[0,1]:i.range(),r=new e.material,o=new e.blend,a=new e.shaderProgram,s=e.utils.createPointSpritesVertexShader(e.GL),u=e.utils.createPointSpritesFragmentShader(e.GL),l=new e.vertexAttribute("vertexPosition"),h=new e.vertexAttribute("vertexColor"),c=new e.floatUniform("height",0),d=new e.floatUniform("vertexColorWeight",0),f=new e.floatUniform("lutMin",n[0]),p=new e.floatUniform("lutMax",n[1]),m=new e.modelViewUniform("modelViewMatrix"),v=new e.projectionUniform("projectionMatrix"),g=new e.uniform(e.GL.INT,"opacityLookup"),y=new e.uniform(e.GL.INT,"scalarsToColors"),x=new e.uniform(e.GL.INT,"useScalarsToColors"),_=new e.uniform(e.GL.INT,"useVertexColors"),b=new e.uniform(e.GL.FLOAT_VEC2,"pointSize"),w=new e.texture;return g.set(0),y.set(1),x.set(0),_.set(0),b.set([1,1]),a.addVertexAttribute(l,e.vertexAttributeKeys.Position),a.addVertexAttribute(h,e.vertexAttributeKeys.Color),a.addUniform(c),a.addUniform(d),a.addUniform(m),a.addUniform(v),a.addUniform(g),a.addUniform(_),a.addUniform(x),a.addUniform(b),a.addShader(u),a.addShader(s),r.addAttribute(a),r.addAttribute(o),i&&(a.addUniform(y),x.set(1),a.addUniform(f),a.addUniform(p),i.setTextureUnit(1),r.addAttribute(i)),w.setImage(t),w.setTextureUnit(0),r.addAttribute(w),r},e.utils.createPlane=function(t,i,n,r,o,a,s,u,l){"use strict";var h=new e.mapper,c=new e.planeSource,d=e.utils.createGeometryMaterial(),f=new e.actor;return c.setOrigin(t,i,n),c.setPoint1(r,o,a),c.setPoint2(s,u,l),h.setGeometryData(c.create()),f.setMapper(h),f.setMaterial(d),f},e.utils.createTexturePlane=function(t,i,n,r,o,a,s,u,l,h){"use strict";var c=new e.mapper,d=new e.planeSource,f=e.utils.createTextureMaterial(h,[t,i,n]),p=new e.actor;return d.setPoint1(r-t,o-i,a-n),d.setPoint2(s-t,u-i,l-n),c.setGeometryData(d.create()),p.setMapper(c),p.setMaterial(f),p},e.utils.createPoints=function(t,i,n,r,o){"use strict";if(!t)return console.log("[ERROR] Cannot create points without positions"),null;o=void 0===o?1:o;var a=new e.mapper,s=new e.pointSource,u=e.utils.createPointGeometryMaterial(o),l=new e.actor;return s.setPositions(t),n&&s.setColors(n),r&&s.setTextureCoordinates(r),i?s.setSize(i):s.setSize(1),a.setGeometryData(s.create()),l.setMapper(a),l.setMaterial(u),l},e.utils.createPointSprites=function(t,i,n,r){"use strict";if(!t)return console.log("[ERROR] Point sprites requires an image"),null;if(!i)return console.log("[ERROR] Cannot create points without positions"),null;var o=new e.mapper,a=new e.pointSource,s=e.utils.createPointSpritesMaterial(t),u=new e.actor;return a.setPositions(i),n&&a.setColors(n),r&&a.setTextureCoordinates(r),o.setGeometryData(a.create()),
u.setMapper(o),u.setMaterial(s),u},e.utils.createLines=function(t,i){"use strict";if(!t)return console.log("[ERROR] Cannot create points without positions"),null;var n=new e.mapper,r=new e.lineSource,o=e.utils.createGeometryMaterial(),a=new e.actor;return r.setPositions(t),i&&r.setColors(i),n.setGeometryData(r.create()),a.setMapper(n),a.setMaterial(o),a},e.utils.createColorLegend=function(t,i,n,r,o,a,s){"use strict";function u(t,i,n){if(!i)return void console.log("[error] Create labels requires positions (x,y,z) array");if(i.length%3!==0)return void console.log("[error] Create labels require positions array contain 3d points");if(!n)return void console.log("[error] Create labels requires Valid range");var r,o=null,a=e.utils.computePowerOfTwo(48),s=0,u=[],l=[],h=[],c=[],d=i[6]-i[0],f=4;for(l.length=3,h.length=3,c.length=3,r=0;r<2;r+=1)s=r*(i.length-3),l[0]=i[s]-d,l[1]=i[s+1]-2*d,l[2]=i[s+2],h[0]=i[s]+d,h[1]=l[1],h[2]=l[2],c[0]=l[0],c[1]=i[1],c[2]=l[2],o=e.utils.createTexturePlane(l[0],l[1],l[2],h[0],h[1],h[2],c[0],c[1],c[2],!0),o.setReferenceFrame(e.boundingObject.ReferenceFrame.Absolute),o.material().setBinNumber(e.material.RenderBin.Overlay),o.material().addAttribute(e.utils.create2DTexture(n[r].toFixed(2).toString(),12,null)),u.push(o);return l[0]=.5*(i[0]+i[i.length-3]-a),l[1]=i[1]+f,l[2]=i[2],h[0]=l[0]+a,h[1]=l[1],h[2]=l[2],c[0]=l[0],c[1]=l[1]+a,c[2]=l[2],o=e.utils.createTexturePlane(l[0],l[1],l[2],h[0],h[1],h[2],c[0],c[1],c[2],!0),o.setReferenceFrame(e.boundingObject.ReferenceFrame.Absolute),o.material().setBinNumber(e.material.RenderBin.Overlay),o.material().addAttribute(e.utils.create2DTexture(t,24,null)),u.push(o),u}function l(t,e,i,n,r,o,a,s,l,h,c,d,f,p,m){m=m;var v=l-o,g=null,y=v/d,x=[],_=[];for(g=0;g<=d;g+=1)x.push(o+y*g),x.push(a),x.push(s),x.push(o+y*g),x.push(a+p),x.push(s);return _=_.concat(u(t,x,e.range()))}if(!i)return console.log("[error] Invalid lookup table"),[];var h=n[0]+r,c=n[1],d=0,f=n[0],p=n[1]+o,m=0,v=[],g=null,y=null,x=e.groupNode();return g=e.utils.createTexturePlane(n[0],n[1],n[2],h,c,d,f,p,m,!0),y=g.material(),y.addAttribute(i),g.setMaterial(y),x.addChild(g),g.material().setBinNumber(e.material.RenderBin.Overlay),g.setReferenceFrame(e.boundingObject.ReferenceFrame.Absolute),v.push(g),v=v.concat(l(t,i,n[0],n[1],n[1],f,c,d,h,c,d,a,s,5,3))},e.utils.create2DTexture=function(t,i,n,r,o,a,s){"use strict";var u=document.getElementById("textRendering"),l=null,h=e.texture();return r=r||"sans-serif",o=o||"center",a=a||"bottom","undefined"==typeof s&&(s=!0),u||(u=document.createElement("canvas")),l=u.getContext("2d"),u.setAttribute("id","textRendering"),u.style.display="none",u.height=e.utils.computePowerOfTwo(8*i),u.width=u.height,l.fillStyle="rgba(0, 0, 0, 0)",l.fillRect(0,0,l.canvas.width,l.canvas.height),l.fillStyle="rgba(200, 85, 10, 1.0)",l.textAlign=o,l.textBaseline=a,l.font=4*i+"px "+r,s&&(l.font="bold "+l.font),l.fillText(t,u.width/2,u.height/2,u.width),h.setImage(u),h.updateDimensions(),h},e.picker=function(){"use strict";if(!(this instanceof e.picker))return new e.picker;e.object.call(this);var t=[];return this.getActors=function(){return t},this.pick=function(e,i,n){if(void 0===e)return 0;if(void 0===i)return 0;if(void 0===n)return 0;t=[];var r,o,s,u,l,h,c,d,f,p,m,v=n.camera(),g=n.width(),y=n.height(),x=v.focalPoint(),_=a.fromValues(x[0],x[1],x[2],1),b=n.worldToDisplay(_,v.viewMatrix(),v.projectionMatrix(),g,y),w=a.fromValues(e,i,b[2],1),M=n.displayToWorld(w,v.viewMatrix(),v.projectionMatrix(),g,y),T=v.position(),A=[];for(s=0;s<3;s+=1)A[s]=M[s]-T[s];for(r=n.sceneRoot().children(),o=0,s=0;s<r.length;s+=1)if(m=r[s],m.visible()===!0){if(u=m.bounds(),A[0]>=0?(l=(u[0]-T[0])/A[0],h=(u[1]-T[0])/A[0]):(l=(u[1]-T[0])/A[0],h=(u[0]-T[0])/A[0]),A[1]>=0?(c=(u[2]-T[1])/A[1],d=(u[3]-T[1])/A[1]):(c=(u[3]-T[1])/A[1],d=(u[2]-T[1])/A[1]),l>d||c>h)continue;if(c>l&&(l=c),d<h&&(h=d),A[2]>=0?(f=(u[4]-T[2])/A[2],p=(u[5]-T[2])/A[2]):(f=(u[5]-T[2])/A[2],p=(u[4]-T[2])/A[2]),l>p||f>h)continue;f>l&&(l=f),p<h&&(h=p),t[o]=m,o+=1}return o},this},inherit(e.picker,e.object),e.shapefileReader=function(){"use strict";if(!(this instanceof e.shapefileReader))return new e.shapefileReader;var t=this,i=0,n=1,r=5,o=3;return this.int8=function(t,e){return t.charCodeAt(e)},this.bint32=function(t,e){return((255&t.charCodeAt(e))<<24)+((255&t.charCodeAt(e+1))<<16)+((255&t.charCodeAt(e+2))<<8)+(255&t.charCodeAt(e+3))},this.lint32=function(t,e){return((255&t.charCodeAt(e+3))<<24)+((255&t.charCodeAt(e+2))<<16)+((255&t.charCodeAt(e+1))<<8)+(255&t.charCodeAt(e))},this.bint16=function(t,e){return((255&t.charCodeAt(e))<<8)+(255&t.charCodeAt(e+1))},this.lint16=function(t,e){return((255&t.charCodeAt(e+1))<<8)+(255&t.charCodeAt(e))},this.ldbl64=function(t,e){var i=255&t.charCodeAt(e),n=255&t.charCodeAt(e+1),r=255&t.charCodeAt(e+2),o=255&t.charCodeAt(e+3),a=255&t.charCodeAt(e+4),s=255&t.charCodeAt(e+5),u=255&t.charCodeAt(e+6),l=255&t.charCodeAt(e+7),h=1-2*(l>>7),c=((127&l)<<4)+((240&u)>>4)-1023,d=(15&u)*Math.pow(2,48)+s*Math.pow(2,40)+a*Math.pow(2,32)+o*Math.pow(2,24)+r*Math.pow(2,16)+n*Math.pow(2,8)+i;return h*(1+d*Math.pow(2,-52))*Math.pow(2,c)},this.lfloat32=function(t,e){var i=255&t.charCodeAt(e),n=255&t.charCodeAt(e+1),r=255&t.charCodeAt(e+2),o=255&t.charCodeAt(e+3),a=1-2*(o>>7),s=((127&o)<<1)+((254&r)>>7)-127,u=(127&r)*Math.pow(2,16)+n*Math.pow(2,8)+i;return a*(1+u*Math.pow(2,-23))*Math.pow(2,s)},this.str=function(t,e,i){for(var n=[],r=e;r<e+i;){var o=t[r];if(0===o.charCodeAt(0))break;n.push(o),r+=1}return n.join("")},this.readHeader=function(t){var e=this.bint32(t,0),i=this.bint32(t,24),n=this.lint32(t,28),r=this.lint32(t,32);return{code:e,length:i,version:n,shapetype:r}},this.loadShx=function(e){for(var i=[],n=function(n){return i.push(2*t.bint32(e,n)),n+8},r=100;r<e.length;)r=n(r);return i},this.Shapefile=function(t){var e=t.path;l.ajax({url:e+".shx",mimeType:"text/plain; charset=x-user-defined",success:function(i){var n=this.loadShx(i);l.ajax({url:e+".shp",mimeType:"text/plain; charset=x-user-defined",success:function(i){l.ajax({url:e+".dbf",mimeType:"text/plain; charset=x-user-defined",success:function(e){var r=this.loadShp(i,e,n,t);t.success(r)}})}})}})},this.localShapefile=function(e){var i=e.shx,n=e.shp,r=e.dbf,o=new FileReader;o.onloadend=function(){var i=t.loadShx(o.result),a=new FileReader;a.onloadend=function(){var n=a.result,o=new FileReader;o.onloadend=function(){var r=o.result,a=t.loadShp(n,r,i,e);e.success(a)},o.readAsBinaryString(r)},a.readAsBinaryString(n)},o.readAsBinaryString(i)},this.loadDBF=function(e){var i=function(i){var n=t.str(e,i,10),r=t.str(e,i+11,1),o=t.int8(e,i+16);return{name:n,type:r,length:o}},n=t.int8(e,0);if(4===n)throw"Level 7 dBASE not supported";for(var r=t.lint32(e,4),o=t.lint16(e,8),a=t.lint16(e,10),s=32,u=32,l=s,h=[];l<o-1;)h.push(i(l)),l+=u;for(var c=[],d=o;d<o+r*a;){var f=t.str(e,d,1);if("*"===f)d+=a;else{d+=1;for(var p={},m=0;m<h.length;m+=1){var v,g=h[m];"C"===g.type?v=t.str(e,d,g.length).trim():"N"===g.type&&(v=parseFloat(t.str(e,d,g.length))),d+=g.length,p[g.name]=v}c.push(p)}}return c},this.loadShp=function(e,a,s,u){u=u;var l,h=[],c=function(i,n,r){for(var o=[],a=r-1;a>=n;a-=1){var s=t.ldbl64(e,i+16*a),u=t.ldbl64(e,i+16*a+8);o.push([s,u])}return o},d=function(a){var s,u,l,d,f,p,m,v,g,y=a+8,x=t.lint32(e,y);if(x===i)console.log("NULL Shape");else if(x===n){var _=t.ldbl64(e,y+4),b=t.ldbl64(e,y+12);h.push({type:"Point",attr:{},geom:[[_,b]]})}else if(x===r){for(s=t.lint32(e,y+36),u=t.lint32(e,y+40),l=a+52,d=a+52+4*s,g=[],f=0;f<s;f+=1)p=t.lint32(e,l+4*f),m=f+1<s?t.lint32(e,l+4*(f+1)):u,v=c(d,p,m),g.push(v);h.push({type:"Polygon",attr:{},geom:[g]})}else{if(x!==o)throw"Not Implemented: "+x;for(s=t.lint32(e,y+36),u=t.lint32(e,y+40),l=a+52,d=a+52+4*s,g=[],f=0;f<s;f+=1)p=t.lint32(e,l+4*f),m=f+1<s?t.lint32(e,l+4*(f+1)):u,v=c(d,p,m),g.push(v);h.push({type:"Polyline",attr:{},geom:[g]})}},f=this.loadDBF(a);for(l=0;l<s.length;l+=1){var p=s[l];d(p)}var m=[];for(l=0;l<h.length;l+=1){var v=h[l];v.attr=f[l],m.push(v)}return m},this},e.vtkReader=function(){"use strict";if(!(this instanceof e.vtkReader))return new e.vtkReader;var t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],i=[],n={},r=0,a=null,s=null,u=-1,l="",h=0,c=0,d=null,f=0;if(0===i.length)for(f=0;f<t.length;f+=1)i[t[f]]=f;return this.ntos=function(t){var e;return e=t.toString(16),1===e.length&&(e="0"+e),e="%"+e,unescape(e)},this.readReverseBase64=function(){var t;if(!l)return u;for(;;){if(h>=l.length)return u;if(t=l.charAt(h),h+=1,i[t])return i[t];if("A"===t)return 0}return u},this.decode64=function(t){var e="",i=new Array(4),n=!1;for(l=t,h=0;!n&&(i[0]=this.readReverseBase64())!==u&&(i[1]=this.readReverseBase64())!==u;)i[2]=this.readReverseBase64(),i[3]=this.readReverseBase64(),e+=this.ntos(i[0]<<2&255|i[1]>>4),i[2]!==u?(e+=this.ntos(i[1]<<4&255|i[2]>>2),i[3]!==u?e+=this.ntos(i[2]<<6&255|i[3]):n=!0):n=!0;return e},this.readNumber=function(t){var e=t[c++]+(t[c++]<<8)+(t[c++]<<16)+(t[c++]<<24);return e},this.readF3Array=function(t,e){var i,n=4*t*3,r=new Int8Array(n),o=null;for(i=0;i<n;i+=1)r[i]=e[c],c+=1;return o=new Float32Array(r.buffer)},this.readColorArray=function(t,e,i){var n,r=0,o=new Array(3*t);for(n=0;n<t;n+=1)o[r++]=e[c++]/255,o[r++]=e[c++]/255,o[r++]=e[c++]/255,c++;i.insert(o)},this.parseObject=function(t){var i,n,r,a,s,u,l,h,p,m,v,g=new e.geometryData,y=e.mapper(),x=[],_=null,b=null,w=null,M=null;for(b=atob(t.data),f=0;f<b.length;f+=1)x[f]=255&b.charCodeAt(f);if(c=0,i=this.readNumber(x),_=String.fromCharCode(x[c]),c+=1,g.setName(_),"L"===_)w=this.parseLineData(g,x),M=e.utils.createGeometryMaterial();else if("M"===_)w=this.parseMeshData(g,x),M=e.utils.createPhongMaterial();else if("P"===_)w=this.parsePointData(g,x),M=e.utils.createGeometryMaterial();else{if("C"===_){for(r=this.parseColorMapData(g,x,i),l=[],f=0;f<r.colors.length;f+=1)l.push(r.colors[f][1]),l.push(r.colors[f][2]),l.push(r.colors[f][3]),l.push(255*r.colors[f][0]);return u=new e.lookupTable,u.setColorTable(l),h=d.renderWindow().windowSize(),p=r.size[0]*h[0],m=r.size[1]*h[1],v=[r.position[0]*h[0],(1-r.position[1])*h[1],0],v[1]=v[1]-m,m=30,e.utils.createColorLegend(r.title,u,v,p,m,3,0)}console.log("Ignoring unrecognized encoded data type "+_)}return y.setGeometryData(g),t.hasTransparency&&(a=M.shaderProgram(),s=a.uniform("opacity"),console.log("opacity ",t.opacity),s.set(t.opacity),M.setBinNumber(1e3)),n=e.actor(),n.setMapper(y),n.setMaterial(M),n.setMatrix(o.transpose(o.create(),w)),[n]},this.parseLineData=function(t,i){var n,r,a,s,u,l,h,d,f=null,p=null,m=null,v=o.create(),g=null,y=0;for(r=this.readNumber(i),g=new Array(3*r),f=new e.sourceDataP3fv,a=this.readF3Array(r,i),d=0;d<r;d+=1)g[y++]=a[3*d],g[y++]=a[3*d+1],g[y++]=a[3*d+2];for(f.insert(g),t.addSource(f),p=new e.sourceDataC3fv,this.readColorArray(r,i,p),t.addSource(p),m=new e.lines,t.addPrimitive(m),n=this.readNumber(i),s=new Int8Array(2*n),d=0;d<2*n;d+=1)s[d]=i[c],c+=1;for(u=new Uint16Array(s.buffer),m.setIndices(u),m.setPrimitiveType(e.GL.LINES),l=64,s=new Int8Array(l),d=0;d<l;d+=1)s[d]=i[c],c+=1;return h=new Float32Array(s.buffer),o.copy(v,h),v},this.parseMeshData=function(t,i){var n,r,a,s,u,l,h,d,f=null,p=null,m=null,v=o.create(),g=null,y=null,x=0;for(r=this.readNumber(i),y=new Array(6*r),f=new e.sourceDataP3N3f,a=this.readF3Array(r,i),m=this.readF3Array(r,i),d=0;d<r;d+=1)y[x++]=a[3*d],y[x++]=a[3*d+1],y[x++]=a[3*d+2],y[x++]=m[3*d],y[x++]=m[3*d+1],y[x++]=m[3*d+2];for(f.insert(y),t.addSource(f),p=new e.sourceDataC3fv,this.readColorArray(r,i,p),t.addSource(p),s=[],g=new e.triangles,n=this.readNumber(i),s=new Int8Array(2*n),d=0;d<2*n;d+=1)s[d]=i[c],c+=1;for(u=new Uint16Array(s.buffer),g.setIndices(u),t.addPrimitive(g),l=64,s=new Int8Array(l),d=0;d<l;d+=1)s[d]=i[c],c+=1;return h=new Float32Array(s.buffer),o.copy(v,h),v},this.parsePointData=function(t,i){var n,r,a,s,u,l,h=o.create(),d=null,p=null,m=null,v=null,g=0;for(n=this.readNumber(i),v=new Array(3*n),d=new e.sourceDataP3fv,r=this.readF3Array(n,i),a=new Uint16Array(n),f=0;f<n;f+=1)a[f]=f,v[g++]=r[3*f],v[g++]=r[3*f+1],v[g++]=r[3*f+2];for(d.insert(v),t.addSource(d),p=new e.sourceDataC3fv,this.readColorArray(n,i,p),t.addSource(p),m=new e.points,m.setIndices(a),t.addPrimitive(m),u=64,s=new Int8Array(u),f=0;f<u;f+=1)s[f]=i[c],c+=1;return l=new Float32Array(s.buffer),o.copy(h,l),h},this.parseColorMapData=function(t,e,i){var n,r,o,a,s,u={};for(u.numOfColors=i,r=8,n=new Int8Array(r),a=0;a<r;a+=1)n[a]=e[c],c+=1;for(u.position=new Float32Array(n.buffer),r=8,n=new Int8Array(r),a=0;a<r;a+=1)n[a]=e[c],c+=1;for(u.size=new Float32Array(n.buffer),u.colors=[],s=0;s<u.numOfColors;s+=1){for(n=new Int8Array(4),a=0;a<4;a+=1)n[a]=e[c],c+=1;o=[new Float32Array(n.buffer)[0],e[c++],e[c++],e[c++]],u.colors[s]=o}for(u.orientation=e[c++],u.numOfLabels=e[c++],u.title="";c<e.length;)u.title+=String.fromCharCode(e[c++]);return u},this.parseSceneMetadata=function(t,e){var i,n,r,o=a.Renderers[e],u=t.camera();n=(o.size[0]-o.origin[0])*s.width,r=(o.size[1]-o.origin[1])*s.height,t.resize(n,r),u.setCenterOfRotation([o.LookAt[1],o.LookAt[2],o.LookAt[3]]),u.setViewAngleDegrees(o.LookAt[0]),u.setPosition(o.LookAt[7],o.LookAt[8],o.LookAt[9]),u.setFocalPoint(o.LookAt[1],o.LookAt[2],o.LookAt[3]),u.setViewUpDirection(o.LookAt[4],o.LookAt[5],o.LookAt[6]),0===e?(i=o.Background1,t.setBackgroundColor(i[0],i[1],i[2],1)):t.setResizable(!1),t.setLayer(e)},this.initScene=function(){var t,e;if(null===a)return d;for(e=a.Renderers.length-1;e>=0;e-=1)t=this.getRenderer(e),this.parseSceneMetadata(t,e);return d},this.createViewer=function(t){var i;return null===d&&(s=t,d=e.viewer(t),d.init(),d.renderWindow().removeRenderer(d.renderWindow().activeRenderer()),d.renderWindow().addRenderer(new e.depthPeelRenderer),n[0]=d.renderWindow().activeRenderer(),d.renderWindow().resize(t.width,t.height),i=e.pvwInteractorStyle(),d.setInteractorStyle(i)),d},this.deleteViewer=function(){n={},d=null},this.updateCanvas=function(t){return s=t,d.renderWindow().resize(t.width,t.height),d},this.numObjects=function(){return r},this.getRenderer=function(t){var i;return i=n[t],null!==i&&"undefined"!=typeof i||(i=new e.renderer,i.setResetScene(!1),i.setResetClippingRange(!1),d.renderWindow().addRenderer(i),0!==t&&i.camera().setClearMask(e.GL.DepthBufferBit),n[t]=i),i},this.setVtkScene=function(t){a=t},this},e.DataBuffers=function(t){"use strict";if(!(this instanceof e.DataBuffers))return new e.DataBuffers(t);var i,n={};i=t||0===t?t:256;var r=0,o=function(t,e,i,n){if(!t)throw"No destination";i||(i=0),n||(n=e.length);for(var r=0;r<n;r+=1)t[i+r]=e[r]},a=function(t){var e=i;for(2*e<t&&(e=t);e<t;)e*=2;i=e;for(var r in n)if(n.hasOwnProperty(r)){var a=new Float32Array(e*n[r].len),s=n[r].array;o(a,s),n[r].array=a,n[r].dirty=!0}};this.create=function(t,e){if(!e||e<0)throw"Length of buffer must be a positive integer";var r=new Float32Array(i*e);return n[t]={array:r,len:e,dirty:!1},n[t].array},this.alloc=function(t){r+t>=i&&a(r+t);var e=r;return r+=t,e},this.get=function(t){return n[t].array},this.write=function(t,e,r,a){if(r+a>i)throw"Write would exceed buffer size";o(n[t].array,e,r*n[t].len,a*n[t].len),n[t].dirty=!0},this.repeat=function(t,e,r,a){if(r+a>i)throw"Repeat would exceed buffer size";for(var s=0;s<a;s+=1)o(n[t].array,e,(r+s)*n[t].len,n[t].len);n[t].dirty=!0},this.count=function(){return r},this.data=function(t){return n[t].array}},e.depthPeelRenderer=function(){"use strict";function t(t,e){L.setMaterial(e),t.m_mapper=L.mapper(),t.m_material=e,t.m_material.bind(t),t.m_mapper.render(t),t.m_material.undoBind(t),L.setMaterial(null)}function i(t,i,n){console.log(i),console.log(n),L=e.utils.createPlane(0,0,0,1,0,0,0,1,0)}function n(t){var i,n,r,o,a,s,u,l,h,_,b,w,M;r=new e.vertexAttribute("vertexPosition"),s=new e.vertexAttribute("vertexNormal"),o=new e.vertexAttribute("vertexColor"),i=new e.modelViewUniform("modelViewMatrix"),u=new e.modelViewUniform("normalMatrix"),n=new e.projectionUniform("projectionMatrix"),d=new e.floatUniform("width"),f=new e.floatUniform("height"),y=new e.floatUniform("opacity",1),a=new e.uniform(e.GL.INT,"depthTexture"),a.set(0),S=new e.shaderProgram,S.loadShader(e.GL.VERTEX_SHADER,"front_peel.vert"),S.loadShader(e.GL.FRAGMENT_SHADER,"front_peel.frag"),S.addUniform(i),S.addUniform(u),S.addUniform(n),S.addUniform(a),S.addUniform(d),S.addUniform(f),S.addUniform(y),S.addVertexAttribute(r,e.vertexAttributeKeys.Position),S.addVertexAttribute(s,e.vertexAttributeKeys.Normal),S.addVertexAttribute(o,e.vertexAttributeKeys.Color),S.compileAndLink(t),A.addAttribute(S),R=new e.shaderProgram,R.loadShader(e.GL.VERTEX_SHADER,"blend.vert"),R.loadShader(e.GL.FRAGMENT_SHADER,"blend.frag"),h=new e.uniform(e.GL.INT,"currColorTexture"),_=new e.uniform(e.GL.INT,"prevDepthTexture"),b=new e.uniform(e.GL.INT,"currDepthTexture"),p=new e.floatUniform("width"),m=new e.floatUniform("height"),h.set(0),_.set(1),b.set(2),l=new e.vertexAttribute("vertexPosition"),R.addUniform(h),R.addUniform(_),R.addUniform(_),R.addUniform(p),R.addUniform(m),R.addVertexAttribute(l,e.vertexAttributeKeys.Position),R.compileAndLink(t),E.addAttribute(R),c=new e.shaderProgram,c.loadShader(e.GL.VERTEX_SHADER,"blend.vert"),c.loadShader(e.GL.FRAGMENT_SHADER,"final.frag"),M=new e.uniform(e.GL.INT,"colorTexture"),v=new e.floatUniform("width"),g=new e.floatUniform("height"),x=new e.uniform(e.GL.FLOAT_VEC3,"backgroundColor"),M.set(0),w=new e.vertexAttribute("vertexPosition"),c.addUniform(M),c.addUniform(v),c.addUniform(g),c.addUniform(x),c.addVertexAttribute(w,e.vertexAttributeKeys.Position),c.compileAndLink(t),C.addAttribute(c)}function r(t,i,n){var r,o,a,s,u;s=t.m_context.getExtension("WEBKIT_WEBGL_depth_texture"),s||(s=t.m_context.getExtension("WEBGL_depth_texture"),s||console.log("Depth textures are not supported"));var c=t.m_context.getExtension("OES_texture_float");if(c||console.log("float textures are not supported"),o=t.m_context.getExtension("OES_texture_float"),!o)return console.log("Extension Texture Float is not working"),void window.alert(":( Sorry, Your browser doesn't support texture float extension.");if(a=t.m_context.getExtension("OES_texture_float_linear"),s=t.m_context.getExtension("WEBGL_depth_texture"),!s)return console.log("Extension Depth texture is not working"),void window.alert(":( Sorry, Your browser doesn't support depth texture extension.");for(u=a?e.GL.LINEAR:e.GL.NEAREST,b.push(t.m_context.createFramebuffer()),b.push(t.m_context.createFramebuffer()),w.push(t.m_context.createTexture()),w.push(t.m_context.createTexture()),M.push(t.m_context.createTexture()),M.push(t.m_context.createTexture()),r=0;r<2;r+=1)t.m_context.bindTexture(e.GL.TEXTURE_2D,M[r]),t.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MAG_FILTER,e.GL.NEAREST),t.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MIN_FILTER,e.GL.NEAREST),t.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_S,e.GL.CLAMP_TO_EDGE),t.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_T,e.GL.CLAMP_TO_EDGE),t.m_context.texImage2D(e.GL.TEXTURE_2D,0,e.GL.DEPTH_COMPONENT,i,n,0,e.GL.DEPTH_COMPONENT,e.GL.UNSIGNED_SHORT,null),t.m_context.bindTexture(e.GL.TEXTURE_2D,w[r]),t.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MAG_FILTER,u),t.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MIN_FILTER,u),t.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_S,e.GL.CLAMP_TO_EDGE),t.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_T,e.GL.CLAMP_TO_EDGE),t.m_context.texImage2D(e.GL.TEXTURE_2D,0,e.GL.RGBA,i,n,0,e.GL.RGBA,e.GL.FLOAT,null),t.m_context.bindFramebuffer(e.GL.FRAMEBUFFER,b[r]),t.m_context.framebufferTexture2D(e.GL.FRAMEBUFFER,e.GL.DEPTH_ATTACHMENT,e.GL.TEXTURE_2D,M[r],0),t.m_context.framebufferTexture2D(e.GL.FRAMEBUFFER,e.GL.COLOR_ATTACHMENT0,e.GL.TEXTURE_2D,w[r],0);l=t.m_context.createTexture(),t.m_context.bindTexture(e.GL.TEXTURE_2D,l),t.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_S,e.GL.CLAMP_TO_EDGE),t.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_T,e.GL.CLAMP_TO_EDGE),t.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MIN_FILTER,e.GL.NEAREST),t.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MAG_FILTER,e.GL.NEAREST),t.m_context.texImage2D(e.GL.TEXTURE_2D,0,e.GL.RGBA,i,n,0,e.GL.RGBA,e.GL.FLOAT,null),h=t.m_context.createFramebuffer(),t.m_context.bindFramebuffer(e.GL.FRAMEBUFFER,h),t.m_context.framebufferTexture2D(e.GL.FRAMEBUFFER,e.GL.DEPTH_ATTACHMENT,e.GL.TEXTURE_2D,M[0],0),t.m_context.framebufferTexture2D(e.GL.FRAMEBUFFER,e.GL.COLOR_ATTACHMENT0,e.GL.TEXTURE_2D,l,0);var d=t.m_context.checkFramebufferStatus(e.GL.FRAMEBUFFER);d===e.GL.FRAMEBUFFER_COMPLETE?console.log("FBO setup successful !!! \n"):console.log("Problem with FBO setup"),t.m_context.bindFramebuffer(e.GL.FRAMEBUFFER,null)}function a(t){T.getMTime()<_.getMTime()&&(i(t,_.width(),_.height()),n(t,_.width(),_.height()),r(t,_.width(),_.height()),T.modified())}function s(t,i,n){var r,a,s=o.create();for(r=0;r<i.length;r+=1)if(a=i[r][2],a.referenceFrame()===e.boundingObject.ReferenceFrame.Relative?(o.multiply(t.m_modelViewMatrix,_.m_camera.viewMatrix(),a.matrix()),t.m_projectionMatrix=_.m_camera.projectionMatrix()):(t.m_modelViewMatrix=a.matrix(),t.m_projectionMatrix=o.create(),o.ortho(t.m_projectionMatrix,0,_.m_width,0,_.m_height,-1,1)),o.invert(s,t.m_modelViewMatrix),o.transpose(t.m_normalMatrix,s),t.m_mapper=a.mapper(),n){var u=a.material().shaderProgram().uniform("opacity");u?y.set(u.get()[0]):y.set(1),t.m_material=n,t.m_material.bind(t),t.m_mapper.render(t),t.m_material.undoBind(t)}else t.m_material=a.material(),t.m_material.bind(t),t.m_mapper.render(t),t.m_material.undoBind(t)}function u(i,n){var r;d.set(_.width()),f.set(_.height()),p.set(_.width()),m.set(_.height()),v.set(_.width()),g.set(_.height()),i.m_context.clearColor(0,0,0,0),i.m_context.clear(e.GL.OLOR_BUFFER_BIT|e.GL.DEPTH_BUFFER_BIT),i.m_context.bindFramebuffer(e.GL.FRAMEBUFFER,h),i.m_context.enable(e.GL.DEPTH_TEST),i.m_context.disable(e.GL.BLEND);var o=_.m_camera.clearColor();i.m_context.clearColor(o[0],o[1],o[2],0),i.m_context.clear(e.GL.COLOR_BUFFER_BIT|e.GL.DEPTH_BUFFER_BIT),s(i,n);var a=2*(P-1);for(r=1;r<a;r+=1){var u=r%2,c=1-u;i.m_context.bindFramebuffer(e.GL.FRAMEBUFFER,b[u]),i.m_context.disable(e.GL.BLEND),i.m_context.enable(e.GL.DEPTH_TEST),i.m_context.bindTexture(e.GL.TEXTURE_2D,M[c]),i.m_context.clearColor(0,0,0,0),i.m_context.clear(e.GL.COLOR_BUFFER_BIT|e.GL.DEPTH_BUFFER_BIT),s(i,n,A),i.m_context.bindFramebuffer(e.GL.FRAMEBUFFER,h),i.m_context.disable(e.GL.DEPTH_TEST),i.m_context.enable(e.GL.BLEND),i.m_context.blendEquation(e.GL.FUNC_ADD),i.m_context.blendFuncSeparate(e.GL.DST_ALPHA,e.GL.ONE,e.GL.ZERO,e.GL.ONE_MINUS_SRC_ALPHA),i.m_context.activeTexture(e.GL.TEXTURE0),i.m_context.bindTexture(e.GL.TEXTURE_2D,w[u]),i.m_context.activeTexture(e.GL.TEXTURE1),i.m_context.bindTexture(e.GL.TEXTURE_2D,M[c]),i.m_context.activeTexture(e.GL.TEXTURE2),i.m_context.bindTexture(e.GL.TEXTURE_2D,M[u]),t(i,E),i.m_context.activeTexture(e.GL.TEXTURE0),i.m_context.disable(e.GL.BLEND)}i.m_context.bindFramebuffer(e.GL.FRAMEBUFFER,null),i.m_context.disable(e.GL.DEPTH_TEST),i.m_context.disable(e.GL.BLEND),i.m_context.bindTexture(e.GL.TEXTURE_2D,l),x.set(_.m_camera.clearColor()),t(i,C),i.m_context.bindTexture(e.GL.TEXTURE_2D,null)}if(!(this instanceof e.depthPeelRenderer))return new e.depthPeelRenderer;e.renderer.call(this);var l,h,c,d,f,p,m,v,g,y,x,_=this,b=[],w=[],M=[],T=e.timestamp(),A=e.material(),E=e.material(),C=e.material(),S=null,R=null,P=6,L=null;this.render=function(){var t,i,n,r=null,o=[];for(i=new e.renderState,i.m_renderer=_,i.m_context=_.renderWindow().context(),i.m_contextChanged=_.m_contextChanged,i.m_context.viewport(_.m_x,_.m_y,_.m_width,_.m_height),a(i),n=_.m_sceneRoot.children(),n.length>0&&_.m_resetScene&&(this.resetCamera(),_.m_resetScene=!1),t=0;t<n.length;t+=1)r=n[t],r.computeBounds(),r.visible()&&o.push([r.material().binNumber(),r.material().shaderProgram().uniform("opacity").get()[0],r]);o.sort(function(t,e){return t[0]-e[0]}),o.sort(function(t,e){return e[1]-t[1]}),u(i,o)}},inherit(e.depthPeelRenderer,e.renderer),e})},function(t,e,i){t.exports={create:i(9),clone:i(10),copy:i(11),identity:i(12),transpose:i(13),invert:i(14),adjoint:i(15),determinant:i(16),multiply:i(17),translate:i(18),scale:i(19),rotate:i(20),rotateX:i(21),rotateY:i(22),rotateZ:i(23),fromRotationTranslation:i(24),fromQuat:i(25),frustum:i(26),perspective:i(27),perspectiveFromFieldOfView:i(28),ortho:i(29),lookAt:i(30),str:i(31)}},function(t,e){function i(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}t.exports=i},function(t,e){function i(t){var e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}t.exports=i},function(t,e){function i(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}t.exports=i},function(t,e){function i(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}t.exports=i},function(t,e){function i(t,e){if(t===e){var i=e[1],n=e[2],r=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=r,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}t.exports=i},function(t,e){function i(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8],c=e[9],d=e[10],f=e[11],p=e[12],m=e[13],v=e[14],g=e[15],y=i*s-n*a,x=i*u-r*a,_=i*l-o*a,b=n*u-r*s,w=n*l-o*s,M=r*l-o*u,T=h*m-c*p,A=h*v-d*p,E=h*g-f*p,C=c*v-d*m,S=c*g-f*m,R=d*g-f*v,P=y*R-x*S+_*C+b*E-w*A+M*T;return P?(P=1/P,t[0]=(s*R-u*S+l*C)*P,t[1]=(r*S-n*R-o*C)*P,t[2]=(m*M-v*w+g*b)*P,t[3]=(d*w-c*M-f*b)*P,t[4]=(u*E-a*R-l*A)*P,t[5]=(i*R-r*E+o*A)*P,t[6]=(v*_-p*M-g*x)*P,t[7]=(h*M-d*_+f*x)*P,t[8]=(a*S-s*E+l*T)*P,t[9]=(n*E-i*S-o*T)*P,t[10]=(p*w-m*_+g*y)*P,t[11]=(c*_-h*w-f*y)*P,t[12]=(s*A-a*C-u*T)*P,t[13]=(i*C-n*A+r*T)*P,t[14]=(m*x-p*b-v*y)*P,t[15]=(h*b-c*x+d*y)*P,t):null}t.exports=i},function(t,e){function i(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8],c=e[9],d=e[10],f=e[11],p=e[12],m=e[13],v=e[14],g=e[15];return t[0]=s*(d*g-f*v)-c*(u*g-l*v)+m*(u*f-l*d),t[1]=-(n*(d*g-f*v)-c*(r*g-o*v)+m*(r*f-o*d)),t[2]=n*(u*g-l*v)-s*(r*g-o*v)+m*(r*l-o*u),t[3]=-(n*(u*f-l*d)-s*(r*f-o*d)+c*(r*l-o*u)),t[4]=-(a*(d*g-f*v)-h*(u*g-l*v)+p*(u*f-l*d)),t[5]=i*(d*g-f*v)-h*(r*g-o*v)+p*(r*f-o*d),t[6]=-(i*(u*g-l*v)-a*(r*g-o*v)+p*(r*l-o*u)),t[7]=i*(u*f-l*d)-a*(r*f-o*d)+h*(r*l-o*u),t[8]=a*(c*g-f*m)-h*(s*g-l*m)+p*(s*f-l*c),t[9]=-(i*(c*g-f*m)-h*(n*g-o*m)+p*(n*f-o*c)),t[10]=i*(s*g-l*m)-a*(n*g-o*m)+p*(n*l-o*s),t[11]=-(i*(s*f-l*c)-a*(n*f-o*c)+h*(n*l-o*s)),t[12]=-(a*(c*v-d*m)-h*(s*v-u*m)+p*(s*d-u*c)),t[13]=i*(c*v-d*m)-h*(n*v-r*m)+p*(n*d-r*c),t[14]=-(i*(s*v-u*m)-a*(n*v-r*m)+p*(n*u-r*s)),t[15]=i*(s*d-u*c)-a*(n*d-r*c)+h*(n*u-r*s),t}t.exports=i},function(t,e){function i(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],h=t[9],c=t[10],d=t[11],f=t[12],p=t[13],m=t[14],v=t[15],g=e*a-i*o,y=e*s-n*o,x=e*u-r*o,_=i*s-n*a,b=i*u-r*a,w=n*u-r*s,M=l*p-h*f,T=l*m-c*f,A=l*v-d*f,E=h*m-c*p,C=h*v-d*p,S=c*v-d*m;return g*S-y*C+x*E+_*A-b*T+w*M}t.exports=i},function(t,e){function i(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],d=e[9],f=e[10],p=e[11],m=e[12],v=e[13],g=e[14],y=e[15],x=i[0],_=i[1],b=i[2],w=i[3];return t[0]=x*n+_*s+b*c+w*m,t[1]=x*r+_*u+b*d+w*v,t[2]=x*o+_*l+b*f+w*g,t[3]=x*a+_*h+b*p+w*y,x=i[4],_=i[5],b=i[6],w=i[7],t[4]=x*n+_*s+b*c+w*m,t[5]=x*r+_*u+b*d+w*v,t[6]=x*o+_*l+b*f+w*g,t[7]=x*a+_*h+b*p+w*y,x=i[8],_=i[9],b=i[10],w=i[11],t[8]=x*n+_*s+b*c+w*m,t[9]=x*r+_*u+b*d+w*v,t[10]=x*o+_*l+b*f+w*g,t[11]=x*a+_*h+b*p+w*y,x=i[12],_=i[13],b=i[14],w=i[15],t[12]=x*n+_*s+b*c+w*m,t[13]=x*r+_*u+b*d+w*v,t[14]=x*o+_*l+b*f+w*g,t[15]=x*a+_*h+b*p+w*y,t}t.exports=i},function(t,e){function i(t,e,i){var n,r,o,a,s,u,l,h,c,d,f,p,m=i[0],v=i[1],g=i[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*g+e[12],t[13]=e[1]*m+e[5]*v+e[9]*g+e[13],t[14]=e[2]*m+e[6]*v+e[10]*g+e[14],t[15]=e[3]*m+e[7]*v+e[11]*g+e[15]):(n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],d=e[9],f=e[10],p=e[11],t[0]=n,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=l,t[7]=h,t[8]=c,t[9]=d,t[10]=f,t[11]=p,t[12]=n*m+s*v+c*g+e[12],t[13]=r*m+u*v+d*g+e[13],t[14]=o*m+l*v+f*g+e[14],t[15]=a*m+h*v+p*g+e[15]),t}t.exports=i},function(t,e){function i(t,e,i){var n=i[0],r=i[1],o=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}t.exports=i},function(t,e){function i(t,e,i,n){var r,o,a,s,u,l,h,c,d,f,p,m,v,g,y,x,_,b,w,M,T,A,E,C,S=n[0],R=n[1],P=n[2],L=Math.sqrt(S*S+R*R+P*P);return Math.abs(L)<1e-6?null:(L=1/L,S*=L,R*=L,P*=L,r=Math.sin(i),o=Math.cos(i),a=1-o,s=e[0],u=e[1],l=e[2],h=e[3],c=e[4],d=e[5],f=e[6],p=e[7],m=e[8],v=e[9],g=e[10],y=e[11],x=S*S*a+o,_=R*S*a+P*r,b=P*S*a-R*r,w=S*R*a-P*r,M=R*R*a+o,T=P*R*a+S*r,A=S*P*a+R*r,E=R*P*a-S*r,C=P*P*a+o,t[0]=s*x+c*_+m*b,t[1]=u*x+d*_+v*b,t[2]=l*x+f*_+g*b,t[3]=h*x+p*_+y*b,t[4]=s*w+c*M+m*T,t[5]=u*w+d*M+v*T,t[6]=l*w+f*M+g*T,t[7]=h*w+p*M+y*T,t[8]=s*A+c*E+m*C,t[9]=u*A+d*E+v*C,t[10]=l*A+f*E+g*C,t[11]=h*A+p*E+y*C,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}t.exports=i},function(t,e){function i(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[4],a=e[5],s=e[6],u=e[7],l=e[8],h=e[9],c=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+l*n,t[5]=a*r+h*n,t[6]=s*r+c*n,t[7]=u*r+d*n,t[8]=l*r-o*n,t[9]=h*r-a*n,t[10]=c*r-s*n,t[11]=d*r-u*n,t}t.exports=i},function(t,e){function i(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],a=e[1],s=e[2],u=e[3],l=e[8],h=e[9],c=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-l*n,t[1]=a*r-h*n,t[2]=s*r-c*n,t[3]=u*r-d*n,t[8]=o*n+l*r,t[9]=a*n+h*r,t[10]=s*n+c*r,t[11]=u*n+d*r,t}t.exports=i},function(t,e){function i(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],a=e[1],s=e[2],u=e[3],l=e[4],h=e[5],c=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+l*n,t[1]=a*r+h*n,t[2]=s*r+c*n,t[3]=u*r+d*n,t[4]=l*r-o*n,t[5]=h*r-a*n,t[6]=c*r-s*n,t[7]=d*r-u*n,t}t.exports=i},function(t,e){function i(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=n+n,u=r+r,l=o+o,h=n*s,c=n*u,d=n*l,f=r*u,p=r*l,m=o*l,v=a*s,g=a*u,y=a*l;return t[0]=1-(f+m),t[1]=c+y,t[2]=d-g,t[3]=0,t[4]=c-y,t[5]=1-(h+m),t[6]=p+v,t[7]=0,t[8]=d+g,t[9]=p-v,t[10]=1-(h+f),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}t.exports=i},function(t,e){function i(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=i+i,s=n+n,u=r+r,l=i*a,h=n*a,c=n*s,d=r*a,f=r*s,p=r*u,m=o*a,v=o*s,g=o*u;return t[0]=1-c-p,t[1]=h+g,t[2]=d-v,t[3]=0,t[4]=h-g,t[5]=1-l-p,t[6]=f+m,t[7]=0,t[8]=d+v,t[9]=f-m,t[10]=1-l-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}t.exports=i},function(t,e){function i(t,e,i,n,r,o,a){var s=1/(i-e),u=1/(r-n),l=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(i+e)*s,t[9]=(r+n)*u,t[10]=(a+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*l,t[15]=0,t}t.exports=i},function(t,e){function i(t,e,i,n,r){var o=1/Math.tan(e/2),a=1/(n-r);return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+n)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*n*a,t[15]=0,t}t.exports=i},function(t,e){function i(t,e,i,n){var r=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),l=2/(r+o);
return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-((a-s)*u*.5),t[9]=(r-o)*l*.5,t[10]=n/(i-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*i/(i-n),t[15]=0,t}t.exports=i},function(t,e){function i(t,e,i,n,r,o,a){var s=1/(e-i),u=1/(n-r),l=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+i)*s,t[13]=(r+n)*u,t[14]=(a+o)*l,t[15]=1,t}t.exports=i},function(t,e,i){function n(t,e,i,n){var o,a,s,u,l,h,c,d,f,p,m=e[0],v=e[1],g=e[2],y=n[0],x=n[1],_=n[2],b=i[0],w=i[1],M=i[2];return Math.abs(m-b)<1e-6&&Math.abs(v-w)<1e-6&&Math.abs(g-M)<1e-6?r(t):(c=m-b,d=v-w,f=g-M,p=1/Math.sqrt(c*c+d*d+f*f),c*=p,d*=p,f*=p,o=x*f-_*d,a=_*c-y*f,s=y*d-x*c,p=Math.sqrt(o*o+a*a+s*s),p?(p=1/p,o*=p,a*=p,s*=p):(o=0,a=0,s=0),u=d*s-f*a,l=f*o-c*s,h=c*a-d*o,p=Math.sqrt(u*u+l*l+h*h),p?(p=1/p,u*=p,l*=p,h*=p):(u=0,l=0,h=0),t[0]=o,t[1]=u,t[2]=c,t[3]=0,t[4]=a,t[5]=l,t[6]=d,t[7]=0,t[8]=s,t[9]=h,t[10]=f,t[11]=0,t[12]=-(o*m+a*v+s*g),t[13]=-(u*m+l*v+h*g),t[14]=-(c*m+d*v+f*g),t[15]=1,t)}var r=i(12);t.exports=n},function(t,e){function i(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}t.exports=i},function(t,e,i){t.exports={create:i(33),clone:i(34),fromValues:i(35),copy:i(36),set:i(37),add:i(38),subtract:i(39),multiply:i(40),divide:i(41),min:i(42),max:i(43),scale:i(44),scaleAndAdd:i(45),distance:i(46),squaredDistance:i(47),length:i(48),squaredLength:i(49),negate:i(50),inverse:i(51),normalize:i(52),dot:i(53),lerp:i(54),random:i(55),transformMat4:i(56),transformQuat:i(57)}},function(t,e){function i(){var t=new Float32Array(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}t.exports=i},function(t,e){function i(t){var e=new Float32Array(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}t.exports=i},function(t,e){function i(t,e,i,n){var r=new Float32Array(4);return r[0]=t,r[1]=e,r[2]=i,r[3]=n,r}t.exports=i},function(t,e){function i(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}t.exports=i},function(t,e){function i(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}t.exports=i},function(t,e){function i(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t}t.exports=i},function(t,e){function i(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(i*i+n*n+r*r+o*o)}t.exports=i},function(t,e){function i(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return i*i+n*n+r*r+o*o}t.exports=i},function(t,e){function i(t){var e=t[0],i=t[1],n=t[2],r=t[3];return Math.sqrt(e*e+i*i+n*n+r*r)}t.exports=i},function(t,e){function i(t){var e=t[0],i=t[1],n=t[2],r=t[3];return e*e+i*i+n*n+r*r}t.exports=i},function(t,e){function i(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}t.exports=i},function(t,e){function i(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}t.exports=i},function(t,e){function i(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=i*i+n*n+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=i*a,t[1]=n*a,t[2]=r*a,t[3]=o*a),t}t.exports=i},function(t,e){function i(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}t.exports=i},function(t,e){function i(t,e,i,n){var r=e[0],o=e[1],a=e[2],s=e[3];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=a+n*(i[2]-a),t[3]=s+n*(i[3]-s),t}t.exports=i},function(t,e,i){function n(t,e){return e=e||1,t[0]=Math.random(),t[1]=Math.random(),t[2]=Math.random(),t[3]=Math.random(),r(t,t),o(t,t,e),t}var r=i(52),o=i(44);t.exports=n},function(t,e){function i(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*o+i[12]*a,t[1]=i[1]*n+i[5]*r+i[9]*o+i[13]*a,t[2]=i[2]*n+i[6]*r+i[10]*o+i[14]*a,t[3]=i[3]*n+i[7]*r+i[11]*o+i[15]*a,t}t.exports=i},function(t,e){function i(t,e,i){var n=e[0],r=e[1],o=e[2],a=i[0],s=i[1],u=i[2],l=i[3],h=l*n+s*o-u*r,c=l*r+u*n-a*o,d=l*o+a*r-s*n,f=-a*n-s*r-u*o;return t[0]=h*l+f*-a+c*-u-d*-s,t[1]=c*l+f*-s+d*-a-h*-u,t[2]=d*l+f*-u+h*-s-c*-a,t[3]=e[3],t}t.exports=i},function(t,e,i){t.exports={create:i(59),clone:i(60),angle:i(61),fromValues:i(62),copy:i(65),set:i(66),add:i(67),subtract:i(68),multiply:i(69),divide:i(70),min:i(71),max:i(72),scale:i(73),scaleAndAdd:i(74),distance:i(75),squaredDistance:i(76),length:i(77),squaredLength:i(78),negate:i(79),inverse:i(80),normalize:i(63),dot:i(64),cross:i(81),lerp:i(82),random:i(83),transformMat4:i(84),transformMat3:i(85),transformQuat:i(86),rotateX:i(87),rotateY:i(88),rotateZ:i(89),forEach:i(90)}},function(t,e){function i(){var t=new Float32Array(3);return t[0]=0,t[1]=0,t[2]=0,t}t.exports=i},function(t,e){function i(t){var e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}t.exports=i},function(t,e,i){function n(t,e){var i=r(t[0],t[1],t[2]),n=r(e[0],e[1],e[2]);o(i,i),o(n,n);var s=a(i,n);return s>1?0:Math.acos(s)}t.exports=n;var r=i(62),o=i(63),a=i(64)},function(t,e){function i(t,e,i){var n=new Float32Array(3);return n[0]=t,n[1]=e,n[2]=i,n}t.exports=i},function(t,e){function i(t,e){var i=e[0],n=e[1],r=e[2],o=i*i+n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}t.exports=i},function(t,e){function i(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}t.exports=i},function(t,e){function i(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}t.exports=i},function(t,e){function i(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}t.exports=i},function(t,e){function i(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t}t.exports=i},function(t,e){function i(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(i*i+n*n+r*r)}t.exports=i},function(t,e){function i(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return i*i+n*n+r*r}t.exports=i},function(t,e){function i(t){var e=t[0],i=t[1],n=t[2];return Math.sqrt(e*e+i*i+n*n)}t.exports=i},function(t,e){function i(t){var e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n}t.exports=i},function(t,e){function i(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}t.exports=i},function(t,e){function i(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}t.exports=i},function(t,e){function i(t,e,i){var n=e[0],r=e[1],o=e[2],a=i[0],s=i[1],u=i[2];return t[0]=r*u-o*s,t[1]=o*a-n*u,t[2]=n*s-r*a,t}t.exports=i},function(t,e){function i(t,e,i,n){var r=e[0],o=e[1],a=e[2];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=a+n*(i[2]-a),t}t.exports=i},function(t,e){function i(t,e){e=e||1;var i=2*Math.random()*Math.PI,n=2*Math.random()-1,r=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(i)*r,t[1]=Math.sin(i)*r,t[2]=n*e,t}t.exports=i},function(t,e){function i(t,e,i){var n=e[0],r=e[1],o=e[2],a=i[3]*n+i[7]*r+i[11]*o+i[15];return a=a||1,t[0]=(i[0]*n+i[4]*r+i[8]*o+i[12])/a,t[1]=(i[1]*n+i[5]*r+i[9]*o+i[13])/a,t[2]=(i[2]*n+i[6]*r+i[10]*o+i[14])/a,t}t.exports=i},function(t,e){function i(t,e,i){var n=e[0],r=e[1],o=e[2];return t[0]=n*i[0]+r*i[3]+o*i[6],t[1]=n*i[1]+r*i[4]+o*i[7],t[2]=n*i[2]+r*i[5]+o*i[8],t}t.exports=i},function(t,e){function i(t,e,i){var n=e[0],r=e[1],o=e[2],a=i[0],s=i[1],u=i[2],l=i[3],h=l*n+s*o-u*r,c=l*r+u*n-a*o,d=l*o+a*r-s*n,f=-a*n-s*r-u*o;return t[0]=h*l+f*-a+c*-u-d*-s,t[1]=c*l+f*-s+d*-a-h*-u,t[2]=d*l+f*-u+h*-s-c*-a,t}t.exports=i},function(t,e){function i(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0],o[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),o[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t}t.exports=i},function(t,e){function i(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),o[1]=r[1],o[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t}t.exports=i},function(t,e){function i(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),o[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),o[2]=r[2],t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t}t.exports=i},function(t,e,i){function n(t,e,i,n,o,a){var s,u;for(e||(e=3),i||(i=0),u=n?Math.min(n*e+i,t.length):t.length,s=i;s<u;s+=e)r[0]=t[s],r[1]=t[s+1],r[2]=t[s+2],o(r,r,a),t[s]=r[0],t[s+1]=r[1],t[s+2]=r[2];return t}t.exports=n;var r=i(59)()},function(t,e,i){t.exports={create:i(92),clone:i(93),fromValues:i(94),copy:i(95),set:i(96),add:i(97),subtract:i(98),multiply:i(99),divide:i(100),min:i(101),max:i(102),scale:i(103),scaleAndAdd:i(104),distance:i(105),squaredDistance:i(106),length:i(107),squaredLength:i(108),negate:i(109),normalize:i(110),dot:i(111),cross:i(112),lerp:i(113),random:i(114),transformMat2:i(115),transformMat2d:i(116),transformMat3:i(117),transformMat4:i(118),forEach:i(119)}},function(t,e){function i(){var t=new Float32Array(2);return t[0]=0,t[1]=0,t}t.exports=i},function(t,e){function i(t){var e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}t.exports=i},function(t,e){function i(t,e){var i=new Float32Array(2);return i[0]=t,i[1]=e,i}t.exports=i},function(t,e){function i(t,e){return t[0]=e[0],t[1]=e[1],t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e,t[1]=i,t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t}t.exports=i},function(t,e){function i(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}t.exports=i},function(t,e){function i(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t}t.exports=i},function(t,e){function i(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)}t.exports=i},function(t,e){function i(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n}t.exports=i},function(t,e){function i(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)}t.exports=i},function(t,e){function i(t){var e=t[0],i=t[1];return e*e+i*i}t.exports=i},function(t,e){function i(t,e){return t[0]=-e[0],t[1]=-e[1],t}t.exports=i},function(t,e){function i(t,e){var i=e[0],n=e[1],r=i*i+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t}t.exports=i},function(t,e){function i(t,e){return t[0]*e[0]+t[1]*e[1]}t.exports=i},function(t,e){function i(t,e,i){var n=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=n,t}t.exports=i},function(t,e){function i(t,e,i,n){var r=e[0],o=e[1];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t}t.exports=i},function(t,e){function i(t,e){e=e||1;var i=2*Math.random()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t}t.exports=i},function(t,e){function i(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r,t[1]=i[1]*n+i[3]*r,t}t.exports=i},function(t,e){function i(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r+i[4],t[1]=i[1]*n+i[3]*r+i[5],t}t.exports=i},function(t,e){function i(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[3]*r+i[6],t[1]=i[1]*n+i[4]*r+i[7],t}t.exports=i},function(t,e){function i(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[4]*r+i[12],t[1]=i[1]*n+i[5]*r+i[13],t}t.exports=i},function(t,e,i){function n(t,e,i,n,o,a){var s,u;for(e||(e=2),i||(i=0),u=n?Math.min(n*e+i,t.length):t.length,s=i;s<u;s+=e)r[0]=t[s],r[1]=t[s+1],o(r,r,a),t[s]=r[0],t[s+1]=r[1];return t}t.exports=n;var r=i(92)()},function(t,e,i){var n=i(1),r=i(121);n.extend(r,i(122)),r.DistanceGrid=i(123),r.ClusterGroup=i(124),t.exports=r},function(t,e,i){!function(){"use strict";function e(){var t;for(t=0;t<arguments.length;t+=1)if(isFinite(arguments[t]))return arguments[t]}var n,r=i(1),o={util:{}},a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s={},u=200,l=15;o.util={pointInPolygon:function(t,e,i,n){var r,a,s=!1,u=e.length;if(!(n&&n.min&&n.max&&(t.x<n.min.x||t.y<n.min.y||t.x>n.max.x||t.y>n.max.y))){if(u<3)return!1;for(r=0,a=u-1;r<u;a=r,r+=1)e[r].y>t.y!=e[a].y>t.y&&t.x<(e[a].x-e[r].x)*(t.y-e[r].y)/(e[a].y-e[r].y)+e[r].x&&(s=!s);return i&&s&&(i||[]).forEach(function(e){s=s&&!o.util.pointInPolygon(t,e)}),s}},isFunction:function(t){return"function"==typeof t},ensureFunction:function(t){return o.util.isFunction(t)?t:function(){return t}},randomString:function(t){var e,i,n;for(t=t||8,e="",i=0;i<t;i+=1)n=Math.floor(Math.random()*a.length),e+=a.substring(n,n+1);return e},convertColor:function(t){return void 0!==t.r&&void 0!==t.g&&void 0!==t.b?t:("string"==typeof t&&(o.util.cssColors.hasOwnProperty(t)?t=o.util.cssColors[t]:"#"===t.charAt(0)&&(t=parseInt(t.slice(1),16))),isFinite(t)&&(t={r:((16711680&t)>>16)/255,g:((65280&t)>>8)/255,b:(255&t)/255}),t)},normalizeCoordinates:function(t){return t=t||{},Array.isArray(t)?{x:t[0],y:t[1],z:t[2]||0}:{x:e(t.x,t.longitude,t.lng,t.lon,0),y:e(t.y,t.latitude,t.lat,0),z:e(t.z,t.elevation,t.elev,t.height,0)}},radiusEarth:6378137,lincomb:function(t,e,i,n){return e.x=t*(e.x||0)+i*(n.x||0),e.y=t*(e.y||0)+i*(n.y||0),e.z=t*(e.x||0)+i*(n.x||0),e},scale:function(t,e,i){return t.x=(t.x||0)*Math.pow(e.x||1,i),t.y=(t.y||0)*Math.pow(e.y||1,i),t.z=(t.z||0)*Math.pow(e.z||1,i),t},compareArrays:function(t,e){return t.length===e.length&&t.every(function(t,i){return t===e[i]})},vec3AsArray:function(){return[0,0,0]},mat4AsArray:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},getGeomBuffer:function(t,e,i){var n,r=t.sourceByName(e);return n=r.data(),n instanceof Float32Array&&n.length===i?n:(n=new Float32Array(i),r.setData(n),n)},timeReport:function(t){return r.each(s,function(t,e){e.count?(e.stddev=Math.sqrt(Math.abs((e.sum2-e.sum*e.sum/e.count)/e.count)),e.average=e.sum/e.count):(e.stddev=0,e.average=0)}),t?s[t]:s},timeFunctionStart:function(t,e){s[t]&&!e||(s[t]={count:0,sum:0,sum2:0,max:0,recent:[]}),s[t].start=window.performance.now()},timeFunctionStop:function(t){if(s[t]&&s[t].start){var e=window.performance.now()-s[t].start;s[t].start=null,s[t].sum+=e,s[t].sum2+=e*e,s[t].count+=1,s[t].max=Math.max(s[t].max,e),s[t].recent.push(e),s[t].recent.length>u&&s[t].recent.splice(0,s[t].recent.length-u)}},timeRequestAnimationFrame:function(t,e,i,r){s.requestAnimationFrame&&!e||(s.requestAnimationFrame={count:0,sum:0,sum2:0,max:0,above_threshold:0,recent:[],recentsub:[]}),i&&(l=i),r&&(u=r),t&&n?(window.requestAnimationFrame=n,n=null):t||n||(n=window.requestAnimationFrame,window.requestAnimationFrame=function(t){n.call(window,function(e){var i,n=s.requestAnimationFrame;n.timestamp!==e&&(n.nowDelta=window.performance.now()-e,Math.abs(n.nowDelta)<1e3&&(n.nowDelta=0),n.timestamp=e,n.subcalls=n.subcalls||0,n.start={sum:n.sum,sum2:n.sum2,count:n.count,max:n.max,above_threshold:n.above_threshold},n.recent.push([0]),n.recentsub.push([]),n.recent.length>u&&(n.recent.splice(0,n.recent.length-u),n.recentsub.splice(0,n.recentsub.length-u))),n.subcalls+=1,t.apply(this,arguments);var r=window.performance.now()-e;r-=n.nowDelta,n.sum=n.start.sum+r,n.sum2=n.start.sum2+r*r,n.count=n.start.count+1,n.max=Math.max(n.max,r),n.above_threshold=n.start.above_threshold+(r>=l?1:0),n.recent[n.recent.length-1]=r,i=n.recentsub[n.recent.length-1],i.push({total_duration:r,duration:r-(i.length?i[i.length-1].total_duration:0),callback:t.name||t})})})}},o.util.cssColors={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},t.exports=o.util}()},function(t,e){/**
	 * @file
	 * Based on the following jquery throttle / debounce plugin:
	 *
	 * jQuery throttle / debounce - v1.1 - 3/7/2010
	 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
	 *
	 * @copyright 2010 "Cowboy" Ben Alman
	 * Dual licensed under the MIT and GPL licenses.
	 * http://benalman.com/about/license/
	 *
	 * The implementation included here is modified to support a callback
	 * method that can accumulate values between actual invocations of
	 * the throttled method.
	 */
!function(e){"use strict";var i=function(t,e,i,n,r){function o(){function o(){s=+new Date,i.apply(l,c)}function u(){a=void 0}var l=this,h=+new Date-s,c=arguments;n.apply(l,c),r&&!a&&o(),void(a&&clearTimeout(a)),void 0===r&&h>t?o():e!==!0&&(a=setTimeout(r?u:o,void 0===r?t-h:t))}var a,s=0;return"boolean"!=typeof e&&(r=n,n=i,i=e,e=void 0),"function"!=typeof n&&(r=n,n=function(){}),o},n=function(t,e,n,r){return"boolean"!=typeof e&&(r=n,n=e,e=!1),r=r||function(){},i(t,!1,n,r,!!e)};t.exports={throttle:i,debounce:n}}(this)},function(t,e,i){/**
	 * @file
	 * Code taken from https://github.com/Leaflet/Leaflet.markercluster
	 * to support faster hierarchical clustering of features.
	 * @copyright 2012, David Leaver
	 */
!function(){"use strict";var e=i(1),n={};n.Util={stamp:function(t){return t._leaflet_id=t._leaflet_id||++n.Util.lastId,t._leaflet_id},lastId:0};var r=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}};r.prototype={addObject:function(t,e){var i=this._getCoord(e.x),r=this._getCoord(e.y),o=this._grid,a=o[r]=o[r]||{},s=a[i]=a[i]||[],u=n.Util.stamp(t);e.obj=t,this._objectPoint[u]=e,s.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var i,r,o=this._getCoord(e.x),a=this._getCoord(e.y),s=this._grid,u=s[a]=s[a]||{},l=u[o]=u[o]||[];for(delete this._objectPoint[n.Util.stamp(t)],i=0,r=l.length;i<r;i++)if(l[i]===t)return l.splice(i,1),1===r&&delete u[o],!0},eachObject:function(t,e){var i,n,r,o,a,s,u,l=this._grid;for(i in l){a=l[i];for(n in a)for(s=a[n],r=0,o=s.length;r<o;r++)u=t.call(e,s[r]),u&&(r--,o--)}},getNearObject:function(t){var e,i,r,o,a,s,u,l,h=this._getCoord(t.x),c=this._getCoord(t.y),d=this._objectPoint,f=this._sqCellSize,p=null;for(e=c-1;e<=c+1;e++)if(o=this._grid[e])for(i=h-1;i<=h+1;i++)if(a=o[i])for(r=0,s=a.length;r<s;r++)u=a[r],l=this._sqDist(d[n.Util.stamp(u)],t),l<f&&(f=l,p=u);return p},contents:function(){return e.map(this._objectPoint,function(t){return t})},_getCoord:function(t){return Math.floor(t/this._cellSize)},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}},t.exports=r}()},function(t,e,i){!function(){"use strict";function e(t,e,i){this._group=t,this._zoom=e,this._points=[],this._clusters=[],this._count=0,this._parent=null,this._coord=null;var n=this;(i||[]).forEach(function(t){n._add(t)})}function n(t,n,o){var a=i(123);this._opts=r.extend({maxZoom:18,radius:.05},t),this._opts.width=this._opts.width||n||256,this._opts.height=this._opts.height||o||256,this._clusters={},this._points={};var s,u;for(s=this._opts.maxZoom;s>=0;s-=1)u=this._scaleAtLevel(s,this._opts.width,this._opts.height),this._clusters[s]=new a(u),this._points[s]=new a(u);this._topClusterLevel=new e(this,(-1))}var r=i(1),o=i(6);e.prototype._add=function(t){var i=1;t instanceof e?(this._clusters.push(t),i=t._count):this._points.push(t),t._parent=this,this._increment(i)},e.prototype._increment=function(t){this._coord=null,this._count+=t,this._parent&&this._parent._increment(t)},e.prototype.count=function(){return this._count},e.prototype.each=function(t){var e;for(e=0;e<this._points.length;e+=1)t.call(this,this._points[e],this._zoom);for(e=0;e<this._clusters.length;e+=1)this._clusters[e].each.call(this._clusters[e],t)},e.prototype.coords=function(){var t,e={x:0,y:0};if(this._coord)return this._coord;for(t=0;t<this._points.length;t+=1)e.x+=this._points[t].x,e.y+=this._points[t].y;for(t=0;t<this._clusters.length;t+=1)e.x+=this._clusters[t].coords().x*this._clusters[t].count(),e.y+=this._clusters[t].coords().y*this._clusters[t].count();return{x:e.x/this.count(),y:e.y/this.count()}},n.prototype._scaleAtLevel=function(t,e,i){return o.zoomToHeight(t,e,i)/2*this._opts.radius},n.prototype.addPoint=function(t){var i,n,o,a,s,u;for(i=this._opts.maxZoom;i>=0;i-=1){if(n=this._clusters[i].getNearObject(t))return void n._add(t);if(n=this._points[i].getNearObject(t)){if(o=n._parent)for(u=o._points.length-1;u>=0;u-=1)if(o._points[u]===n){o._points.splice(u,1),o._increment(-1);break}for(o||r.noop(),a=new e(this,i,[n,t]),this._clusters[i].addObject(a,a.coords()),s=a,u=i-1;u>o._zoom;u-=1)s=new e(this,u,[s]),this._clusters[u].addObject(s,s.coords());for(o._add(s),u=i;u>=0&&this._points[u].removeObject(n,n);u-=1);return}this._points[i].addObject(t,t)}this._topClusterLevel._add(t)},n.prototype.points=function(t){return t=Math.min(Math.max(Math.floor(t),0),this._opts.maxZoom-1),this._points[Math.floor(t)].contents()},n.prototype.clusters=function(t){return t=Math.min(Math.max(Math.floor(t),0),this._opts.maxZoom-1),this._clusters[Math.floor(t)].contents()},t.exports=n}()},function(t,e){var i={};i.layerAdd="geo_layerAdd",i.layerRemove="geo_layerRemove",i.zoom="geo_zoom",i.rotate="geo_rotate",i.pan="geo_pan",i.resize="geo_resize",i.worldChanged="geo_worldChanged",i.draw="geo_draw",i.drawEnd="geo_drawEnd",i.mousemove="geo_mousemove",i.mouseclick="geo_mouseclick",i.brush="geo_brush",i.brushend="geo_brushend",i.brushstart="geo_brushstart",i.select="geo_select",i.zoomselect="geo_zoomselect",i.unzoomselect="geo_unzoomselect",i.transitionstart="geo_transitionstart",i.transitionend="geo_transitionend",i.transitioncancel="geo_transitioncancel",i.parallelprojection="geo_parallelprojection",i.clock={play:"geo_clock_play",stop:"geo_clock_stop",pause:"geo_clock_pause",change:"geo_clock_change"},i.feature={mousemove:"geo_feature_mousemove",mouseover:"geo_feature_mouseover",mouseout:"geo_feature_mouseout",mouseon:"geo_feature_mouseon",mouseoff:"geo_feature_mouseoff",mouseclick:"geo_feature_mouseclick",brushend:"geo_feature_brushend",brush:"geo_feature_brush"},i.camera={},i.camera.view="geo_camera_view",i.camera.pan="geo_camera_pan",i.camera.zoom="geo_camera_zoom",i.camera.projection="geo_camera_projection",i.camera.viewport="geo_camera_viewport",t.exports=i},function(t,e,i){var n=i(4),r=i(127),o=function(t){"use strict";if(!(this instanceof o))return new o(t);t=t||{},r.call(this,t);var e=i(1),n=i(120).ensureFunction,a=i(132),s=this,u=this._init,l=e.extend({},{colorRange:[{r:.07514311,g:.468049805,b:1},{r:.468487184,g:.588057293,b:1},{r:.656658579,g:.707001303,b:1},{r:.821573924,g:.837809045,b:1},{r:.943467973,g:.943498599,b:.943398095},{r:1,g:.788626485,b:.750707739},{r:1,g:.6289553,b:.568237474},{r:1,g:.472800903,b:.404551679},{r:.916482116,g:.236630659,b:.209939162}],scale:a.scale.quantize(),accessors:{geoId:function(t){return t.properties.GEO_ID},scalarId:function(t){return t.id},scalarValue:function(t){return t.value}}},t.choropleth);return this.scalar=function(t,e){var i,n;return void 0===t?s.choropleth.get("scalar")():(i=s.choropleth.get("accessors")().scalarId,n=s.choropleth.get("accessors")().scalarValue,l.scalar=t,l.scalarAggregator=e||a.mean,l.scalar._dictionary=t.reduce(function(t,e){var r,o;return r=i(e),o=n(e),t[r]=t[r]?t[r].push(o):[o],t},{}),s.dataTime().modified(),s)},this.choropleth=function(t,i){var n;return void 0===t?l:"string"==typeof t&&void 0===i?l[t]:(void 0===i?(n=e.extend({},l,t),l=n):l[t]=i,s.modified(),s)},this.choropleth.get=function(t){var e,i={};if(void 0===t){for(e in l)l.hasOwnProperty(e)&&(i[e]=s.choropleth.get(e));return i}return n(l[t])},this._addPolygonFeature=function(t,e){var i=s.layer().createFeature("polygon",{});return"Polygon"===t.geometry.type?i.data([{type:"Polygon",coordinates:t.geometry.coordinates}]):"MultiPolygon"===t.geometry.type&&i.data(t.geometry.coordinates.map(function(t){return{type:"Polygon",coordinates:t}})),i.polygon(function(t){return{outer:t.coordinates[0],inner:t.coordinates[1]}}).position(function(t){return{x:t[0],y:t[1]}}).style({fillColor:e}),i},this._featureToPolygons=function(t,e){return s._addPolygonFeature(t,e)},this._generateScale=function(t){var e=a.extent(s.scalar(),t||void 0);return s.choropleth().scale.domain(e).range(s.choropleth().colorRange),s},this.createChoropleth=function(){var t=s.choropleth,e=s.data(),i=s.scalar(),n=t.get("accessors")().scalarValue,r=t.get("accessors")().geoId;return s._generateScale(n),e.map(function(e){var n=r(e),o=i._dictionary[n],a=t().scalarAggregator(o),u=s.choropleth().scale(a);return s._featureToPolygons(e,u)})},this._init=function(t){u.call(s,t),l&&s.dataTime().modified()},this._init(t),this};n(o,r),t.exports=o},function(t,e,i){var n=i(1),r=i(4),o=i(128),a=i(129),s=i(125),u=function(t){"use strict";if(!(this instanceof u))return new u(t);o.call(this);var e=i(120);t=t||{};var r=this,l=this._exit,h=void 0!==t.selectionAPI&&t.selectionAPI,c={},d=void 0===t.layer?null:t.layer,f=t.gcs,p=void 0===t.visible||t.visible,m=void 0===t.bin?0:t.bin,v=void 0===t.renderer?null:t.renderer,g=a(),y=a(),x=a(),_=[];return this._bindMouseHandlers=function(){h&&(r._unbindMouseHandlers(),r.geoOn(s.mousemove,r._handleMousemove),r.geoOn(s.mouseclick,r._handleMouseclick),r.geoOn(s.brushend,r._handleBrushend),r.geoOn(s.brush,r._handleBrush))},this._unbindMouseHandlers=function(){r.geoOff(s.mousemove,r._handleMousemove),r.geoOff(s.mouseclick,r._handleMouseclick),r.geoOff(s.brushend,r._handleBrushend),r.geoOff(s.brush,r._handleBrush)},this.pointSearch=function(){return{index:[],found:[]}},this._handleMousemove=function(){var t=r.layer().map().interactor().mouse(),e=r.data(),i=r.pointSearch(t.geo),n=[],o=[],a=-1,l=-1;_.length&&(a=_[_.length-1]),n=i.index.filter(function(t){return _.indexOf(t)<0}),o=_.filter(function(t){return i.index.indexOf(t)<0}),u.eventID+=1,n.forEach(function(i,o){r.geoTrigger(s.feature.mouseover,{data:e[i],index:i,mouse:t,eventID:u.eventID,top:o===n.length-1},!0)}),u.eventID+=1,o.forEach(function(i,n){r.geoTrigger(s.feature.mouseout,{data:e[i],index:i,mouse:t,eventID:u.eventID,top:n===o.length-1},!0)}),u.eventID+=1,i.index.forEach(function(n,o){r.geoTrigger(s.feature.mousemove,{data:e[n],index:n,mouse:t,eventID:u.eventID,top:o===i.index.length-1},!0)}),_=i.index,_.length&&(l=_[_.length-1]),a!==l&&(a!==-1&&r.geoTrigger(s.feature.mouseoff,{data:e[a],index:a,mouse:t},!0),l!==-1&&r.geoTrigger(s.feature.mouseon,{data:e[l],index:l,mouse:t},!0))},this._handleMouseclick=function(){var t=r.layer().map().interactor().mouse(),e=r.data(),i=r.pointSearch(t.geo);u.eventID+=1,i.index.forEach(function(n,o){r.geoTrigger(s.feature.mouseclick,{data:e[n],index:n,mouse:t,eventID:u.eventID,top:o===i.index.length-1},!0)})},this._handleBrush=function(t){var e=r.boxSearch(t.gcs.lowerLeft,t.gcs.upperRight),i=r.data();u.eventID+=1,e.forEach(function(e,n){r.geoTrigger(s.feature.brush,{data:i[e],index:e,mouse:t.mouse,brush:t,eventID:u.eventID,top:n===n.length-1},!0)})},this._handleBrushend=function(t){var e=r.boxSearch(t.gcs.lowerLeft,t.gcs.upperRight),i=r.data();u.eventID+=1,e.forEach(function(e,n){r.geoTrigger(s.feature.brushend,{data:i[e],index:e,mouse:t.mouse,brush:t,eventID:u.eventID,top:n===n.length-1},!0)})},this.style=function(t,e){return void 0===t?c:"string"==typeof t&&void 0===e?c[t]:void 0===e?(c=n.extend({},c,t),r.modified(),r):(c[t]=e,r.modified(),r)},this.style.get=function(t){var i;if(void 0===t){var n,o={};for(n in c)c.hasOwnProperty(n)&&(o[n]=r.style.get(n));return o}return i=t.toLowerCase().match(/color$/)?e.isFunction(c[t])?function(){return e.convertColor(c[t].apply(this,arguments))}:e.ensureFunction(e.convertColor(c[t])):e.ensureFunction(c[t])},this.layer=function(){return d},this.renderer=function(){return v},this.gcs=function(t){return void 0===t?void 0===f&&v?v.layer().map().ingcs():f:(f=t,r.modified(),r)},this.featureGcsToDisplay=function(t){var e=v.layer().map();return t=e.gcsToWorld(t,e.ingcs()),t=e.worldToDisplay(t),v.baseToLocal&&(t=v.baseToLocal(t)),t},this.visible=function(t){return void 0===t?p:(p=t,r.modified(),p?r._bindMouseHandlers():r._unbindMouseHandlers(),r)},this.bin=function(t){return void 0===t?m:(m=t,r.modified(),r)},this.dataTime=function(t){return void 0===t?g:(g=t,r.modified(),r)},this.buildTime=function(t){return void 0===t?y:(y=t,r.modified(),r)},this.updateTime=function(t){return void 0===t?x:(x=t,r.modified(),r)},this.data=function(t){return void 0===t?r.style("data")||[]:(r.style("data",t),r.dataTime().modified(),r.modified(),r)},this.selectionAPI=function(){return h},this._init=function(t){if(!d)throw"Feature requires a valid layer";c=n.extend({},{opacity:1},void 0===t.style?{}:t.style),r._bindMouseHandlers()},this._build=function(){},this._update=function(){},this._exit=function(){r._unbindMouseHandlers(),_=[],c={},t={},l()},this._init(t),this};u.eventID=0,u.create=function(t,e){"use strict";var n=e.type;if(!(t instanceof i(130)))return console.warn("Invalid layer"),null;if("object"!=typeof e)return console.warn("Invalid spec"),null;var r=t.createFeature(n);return r?(e=e||{},e.data=e.data||[],r.style(e)):(console.warn('Could not create feature type "'+n+'"'),null)},r(u,o),t.exports=u},function(t,e,i){var n=i(4),r=i(5),o=function(t){"use strict";if(!(this instanceof o))return new o;r.call(this,t);var e=this,i=null,n=[],a=this._exit,s=this.geoTrigger,u=this.addPromise,l=this.onIdle;return this.addPromise=function(t){i?i.addPromise(t):u(t)},this.onIdle=function(t){i?i.onIdle(t):l(t)},this.parent=function(t){return void 0===t?i:(i=t,e)},this.addChild=function(t){return Array.isArray(t)?(t.forEach(e.addChild),e):(t.parent(e),n.push(t),e)},this.removeChild=function(t){return Array.isArray(t)?(t.forEach(e.removeChild),e):(n=n.filter(function(e){return e!==t}),e)},this.children=function(){return n.slice()},this.draw=function(t){return e.children().forEach(function(e){e.draw(t)}),e},this.geoTrigger=function(t,r,o){var a;return r=r||{},a=r.geo||{},r.geo=a,a.stopPropagation?e:!o&&i&&a._triggeredBy!==i?(a._triggeredBy=e,i.geoTrigger(t,r),e):(s.call(e,t,r),a.stopPropagation?e:(n.forEach(function(i){i.geoTrigger&&(a._triggeredBy=e,i.geoTrigger(t,r))}),e))},this._exit=function(){e.children=[],delete e.parent,a()},this};n(o,r),t.exports=o},function(t,e,i){var n=i(6),r=i(4),o=function(){"use strict";return this instanceof o?void n.timestamp.call(this):new o};r(o,n.timestamp),t.exports=o},function(t,e,i){var n=i(4),r=i(128),o=i(127),a=i(131).checkRenderer,s=i(131).rendererForFeatures,u=function(t){"use strict";if(!(this instanceof u))return new u(t);t=t||{},r.call(this,t);var e,n=i(1),o=i(129),l=i(131).createRenderer,h=i(120).newLayerId,c=i(125),d=i(3),f=this,p=this._exit,m=void 0===t.id?u.newLayerId():t.id,v="",g=void 0===t.map?null:t.map,y=null,x=null,_=null,b=!1,w=void 0===t.renderer?s(t.features):t.renderer,M=o(),T=o(),A=void 0===t.sticky||t.sticky,E=void 0===t.active||t.active,C=void 0===t.opacity?1:t.opacity,S=t.attribution||null;if(w=a(w),!g)throw new Error("Layers must be initialized on a map.");return this.rendererName=function(){return w},this.zIndex=function(t){return void 0===t?e:(e=t,y.css("z-index",e),f)},this.moveUp=function(t){var e,i,n,r,o=null;for(void 0===t&&(t=1),r=1,t<0&&(r=-1,t=-t),e=f.map().layers().sort(function(t,e){return r*(t.zIndex()-e.zIndex())}),i=0;i<e.length;i+=1)if(null===o)e[i]===f&&(o=i);else{if(!(i-o<=t))break;n=f.zIndex(),f.zIndex(e[i].zIndex()),e[i].zIndex(n)}return f},this.moveDown=function(t){return void 0===t&&(t=1),f.moveUp(-t)},this.moveToTop=function(){return f.moveUp(f.map().children().length-1)},this.moveToBottom=function(){return f.moveDown(f.map().children().length-1)},this.sticky=function(){return A},this.active=function(){return E},this.node=function(){return y},this.id=function(t){return void 0===t?m:(m=h(),f.modified(),f)},this.name=function(t){return void 0===t?v:(v=t,f.modified(),f)},this.map=function(){return g},this.renderer=function(){return _},this.canvas=function(){return x},this.dataTime=function(){return M},this.updateTime=function(){return T},this.initialized=function(t){return void 0!==t?(b=t,f):b},this.toLocal=function(t){return f._toLocalMatrix&&d.applyTransform(f._toLocalMatrix,t),t},this.fromLocal=function(t){return f._fromLocalMatrix&&d.applyTransform(f._fromLocalMatrix,t),t},this.attribution=function(t){return void 0!==t?(S=t,f.map().updateAttribution(),f):S},this._init=function(e){if(b)return f;g.node().append(y);var i=n.extend({},t);return delete i.map,null===w?(_=null,x=y):x?_=l(w,f,x,i):(_=l(w,f,void 0,i),x=_.canvas()),f.active()||y.css("pointerEvents","none"),b=!0,e||(f.geoOn(c.resize,function(t){f._update({event:t})}),f.geoOn(c.pan,function(t){f._update({event:t})}),f.geoOn(c.rotate,function(t){f._update({event:t})}),f.geoOn(c.zoom,function(t){f._update({event:t})})),f},this._exit=function(){f.geoOff(),_&&_._exit(),y.off(),y.remove(),t={},x=null,_=null,p()},this._update=function(){},this.width=function(){return f.map().size().width},this.height=function(){return f.map().size().height},this.opacity=function(t){return void 0!==t?(C=t,y.css("opacity",C),f):C},void 0===t.zIndex&&(t.zIndex=g.children().length),e=t.zIndex,y=n(document.createElement("div")),y.attr("id",v),y.css("position","absolute"),y.css("width","100%"),y.css("height","100%"),f.opacity(C),f.zIndex(e),f};u.newLayerId=function(){"use strict";var t=1;return function(){var e=t;return t+=1,e}}(),u.create=function(t,e){"use strict";if(e=e||{},e.type="feature","feature"!==e.type)return console.warn("Unsupported layer type"),null;if(e.renderer=e.renderer||"vgl",e.renderer=a(e.renderer),!e.renderer)return console.warn("Invalid renderer"),null;var i=t.createLayer(e.type,e);return i?(e.features.forEach(function(t){t.data=t.data||e.data,t.feature=o.create(i,t)}),i):(console.warn("Unable to create a layer"),null)},n(u,r),t.exports=u},function(t,e,i){var n=i(1),r={dom:{}},o={},a={},s={},u={},l={},h={},c={},d={};d.registerFileReader=function(t,e){h[t]=e},d.createFileReader=function(t,e){return h.hasOwnProperty(t)?h[t](e):null},d.registerRenderer=function(t,e){s[t]=e},d.createRenderer=function(t,e,i,n){if(s.hasOwnProperty(t)){var r=s[t]({layer:e,canvas:i,options:n});return r._init(),r}return null},d.checkRenderer=function(t,e){if(null===t)return t;if(s.hasOwnProperty(t)){var i=s[t];if(!i.supported||i.supported())return t;if(!i.fallback||e)return!1;var n=d.checkRenderer(i.fallback(),!0);return n!==!1&&console.warn(t+" renderer is unavailable, using "+n+" renderer instead"),n}return!1},d.rendererForFeatures=function(t){var e,i,n,r,o,a,s=["vgl","canvas","d3",null];for(i=0;i<s.length;i+=1)if(e=s[i],d.checkRenderer(e,!0)!==!1){if(!t)return e;if(u[e]){for(a=!0,r=0;r<t.length;r+=1){if(n=t[r],o=null,n.indexOf(".")>=0&&(o=n,n=n.substr(0,n.indexOf("."))),void 0===u[e][n]){a=!1;break}if(o&&l[e][n]&&!l[e][n][o]){a=!1;break}}if(a)return e}}return console.warn('There is no renderer available for the feature list "'+(t||[]).join(", ")+'".'),!1},d.registerFeature=function(t,e,i,n){t in u||(u[t]={},l[t]={}),u[t][e]=i,l[t][e]=n},d.createFeature=function(t,e,i,r){var o=i.api(),a={layer:e,renderer:i};if(o in u&&t in u[o]){void 0!==r&&n.extend(!0,a,r);var s=u[o][t](a);return void 0===e.gcs&&(e.gcs=function(){return e.map().gcs()}),s}return null},d.registerLayerAdjustment=function(t,e,i){t in c||(c[t]={}),c[t][e]=i},d.adjustLayerForRenderer=function(t,e){var i=e.rendererName();i&&c&&c[i]&&c[i][t]&&c[i][t].apply(e)},d.registerLayer=function(t,e,i){o[t]=e,a[t]=i},d.createLayer=function(t,e,i){var r={map:e},s=null;return t in o?(i.renderer||i.features||!a||(r.features=a[t]),void 0!==i&&n.extend(!0,r,i),s=o[t](r),s._init(),s):null},d.registerWidget=function(t,e,i){t in r||(r[t]={}),r[t][e]=i},d.createWidget=function(t,e,i){var o={layer:e};if(t in r.dom)return void 0!==i&&n.extend(!0,o,i),r.dom[t](o);throw new Error("Cannot create unknown widget "+t)},t.exports=d},function(e,i){e.exports=t},function(t,e,i){var n=i(4),r=i(5),o=function(t){"use strict";if(!(this instanceof o))return new o(t);t=t||{},r.call(this,t);var e=i(125),n=this,a=new Date(0),s=null,u=null,l=null,h=null,c=Number.POSITIVE_INFINITY,d=0,f="stop",p=null,m=null;this.object=function(t){return void 0===t?m:(m=t,n)},this._attached=function(){return m instanceof r},this.now=function(t){var i=a;return void 0===t?a:(a=t,a!==i&&n._attached()&&n.object().geoTrigger(e.clock.change,{previous:i,current:a,clock:n}),n)},this.start=function(t){return void 0===t?s:(s=t,n)},this.end=function(t){return void 0===t?u:(u=t,n)},this.step=function(t){return void 0===t?l:(l=t,n)},this.loop=function(t){return void 0===t?c:(c=t,n)},this.state=function(t,e){return void 0===t?f:["stop","play","pause"].indexOf(t)<0?(console.log("WARNING: Ignored invalid state: "+t),n):("play"===t&&"stop"===f&&(d=0,n.now(n.start())),"play"===t&&"play"!==f&&(f=t,n._animate(e||1)),f=t,n)},this.framerate=function(t){return void 0===t?h:(h=t,n)},this.stepForward=function(){return n.state("pause"),n._setNextFrame(1),n},this.stepBackward=function(){return n.state("pause"),n._setNextFrame(-1),n},this._setNextFrame=function(t){var e=new Date(n.now().valueOf()+t*n.step());return e>=n.end()||e<=n.start()?n.loop()<=d?void n.state("stop"):(d+=1,void(t>=0?n.now(n.start()):n.now(n.end()))):void n.now(e)},this._animate=function(t){function i(){r===p&&(n._setNextFrame(t),"play"===n.state()?n.framerate()?window.setTimeout(i,1e3/n.framerate()):window.requestAnimationFrame(i):n._attached()&&n.object().geoTrigger(e.clock[n.state()],{current:n.now(),clock:n}))}var r={};p=r,n._attached()&&n.object().geoTrigger(e.clock.play,{current:n.now(),clock:n}),n.framerate()?window.setTimeout(i,1e3/n.framerate()):window.requestAnimationFrame(i)}};n(o,r),t.exports=o},function(t,e,i){var n=i(4),r=i(127),o=function(t){"use strict";if(!(this instanceof o))return new o(t);var e=i(1),n=i(120);t=t||{},r.call(this,t);var a=this,s={},u=this._init,l=this.data;return s=void 0===t.contour?function(t){return t}:t.contour,this.data=function(t){var e=l(t);return e},this.contour=function(t,i){if(void 0===t)return s;if("string"==typeof t&&void 0===i)return s[t];if(void 0===i){var n=e.extend({},{gridWidth:function(){return t.gridHeight?Math.floor(a.data().length/t.gridHeight):Math.floor(Math.sqrt(a.data().length))},gridHeight:function(){return t.gridWidth?Math.floor(a.data().length/t.gridWidth):Math.floor(Math.sqrt(a.data().length))},minColor:"black",minOpacity:0,maxColor:"black",maxOpacity:0,colorRange:[{r:.07514311,g:.468049805,b:1},{r:.468487184,g:.588057293,b:1},{r:.656658579,g:.707001303,b:1},{r:.821573924,g:.837809045,b:1},{r:.943467973,g:.943498599,b:.943398095},{r:1,g:.788626485,b:.750707739},{r:1,g:.6289553,b:.568237474},{r:1,g:.472800903,b:.404551679},{r:.916482116,g:.236630659,b:.209939162}]},s,t);s=n}else s[t]=i;return a.modified(),a},this.contour.get=function(t){if(void 0===t){var e,i={};for(e in s)s.hasOwnProperty(e)&&(i[e]=a.contour.get(e));return i}return n.ensureFunction(s[t])},this.position=function(t){return void 0===t?a.style("position"):(a.style("position",t),a.dataTime().modified(),a.modified(),a)},this.createContours=function(){var t,i,r,o,s,u,l,h,c,d,f,p,m,v,g,y,x,_=0,b={},w=a.contour,M=a.data(),T=a.position(),A=w.get("gridWidth")(),E=w.get("gridHeight")(),C=w.get("x0")(),S=w.get("y0")(),R=w.get("dx")(),P=w.get("dy")(),L=a.style.get("opacity"),D=w.get("opacityRange")(),O=w.get("rangeValues")(),I=a.style.get("value"),N=[],F=w.get("stepped")(),k=w.get("wrapLongitude")(),G=A,U={minValue:w.get("min")(),maxValue:w.get("max")(),stepped:!(void 0!==F&&!F),wrapLongitude:!(void 0!==k&&!k),colorMap:[],elements:[]};if(U.minColor=e.extend({a:w.get("minOpacity")()||0},n.convertColor(w.get("minColor")())),U.maxColor=e.extend({a:w.get("maxOpacity")()||0},n.convertColor(w.get("maxColor")())),w.get("colorRange")().forEach(function(t,i){U.colorMap.push(e.extend({a:D&&void 0!==D[i]?D[i]:1},n.convertColor(t)))}),A*E>M.length&&(E=Math.floor(M.length)/A),h=null===C||void 0===C||null===S||void 0===S||!R||!P,!h&&U.wrapLongitude&&(C<-180||C>180||C+R*(A-1)<-180||C+R*(A-1)>180)&&R>-180&&R<180){for(v=[],t=0;t<A;t+=1){for(y=C+t*R;y<-180;)y+=360;for(;y>180;)y-=360;t&&Math.abs(y-v[v.length-1])>180&&(y>v[v.length-1]?(v.push(y-360),v.push(v[v.length-2]+360)):(v.push(y+360),v.push(v[v.length-2]-360)),g=t),v.push(y)}if(A+=2,Math.abs(Math.abs(G*R)-360)<.01){for(A+=1,y=C+G*R;y<-180;)y+=360;for(;y>180;)y-=360;v.push(y)}}for(l=A*E,t=0;t<l;t+=1)void 0===g?u=parseFloat(I(M[t])):(r=Math.floor(t/A),x=t-r*A,x+=x>g?-2:0,x>=G&&(x-=G),x+=r*G,u=parseFloat(I(M[x]))),N[t]=isNaN(u)?null:u,null!==N[t]&&(b[t]=_,_+=1,void 0===d&&(d=f=N[t]),N[t]<d&&(d=N[t]),N[t]>f&&(f=N[t]));if(!_)return U;if(e.isNumeric(U.minValue)||(U.minValue=d),e.isNumeric(U.maxValue)||(U.maxValue=f),O&&O.length===U.colorMap.length+1||(O=null),O)for(s=1;s<O.length;s+=1)if(O[s]>O[s+1]){O=null;break}for(O&&(U.minValue=O[0],U.maxValue=O[O.length-1]),p=U.maxValue-U.minValue,p||(U.colorMap=U.colorMap.slice(0,1),p=1,O=null),U.rangeValues=O,U.factor=U.colorMap.length/p,r=o=0;r<E-1;r+=1,o+=1)for(t=0;t<A-1;t+=1,o+=1)null!==N[o]&&null!==N[o+1]&&null!==N[o+A]&&null!==N[o+A+1]&&t!==g&&(U.elements.push(b[o]),U.elements.push(b[o+1]),U.elements.push(b[o+A]),U.elements.push(b[o+A+1]),U.elements.push(b[o+A]),U.elements.push(b[o+1]));for(U.pos=new Array(3*_),U.value=new Array(_),U.opacity=new Array(_),r=t=i=0;r<l;r+=1)if(u=N[r],null!==u){if(c=M[r],h?(m=T(c),U.pos[i]=m.x,U.pos[i+1]=m.y,U.pos[i+2]=m.z||0):(void 0===g?U.pos[i]=C+R*(r%A):U.pos[i]=v[r%A],U.pos[i+1]=S+P*Math.floor(r/A),U.pos[i+2]=0),U.opacity[t]=L(c),O&&u>=U.minValue&&u<=U.maxValue){for(s=1;s<O.length;s+=1)if(u<=O[s]){U.value[t]=s-1+(u-O[s-1])/(O[s]-O[s-1]);break}}else U.value[t]=(u-U.minValue)*U.factor;t+=1,i+=3}return U},this._init=function(t){u.call(a,t);var i=e.extend({},{opacity:1,position:function(t){return{x:t.x,y:t.y,z:t.z}},value:function(t){return a.position()(t).z}},void 0===t.style?{}:t.style);a.style(i),s&&a.dataTime().modified()},this._init(t),this};n(o,r),t.exports=o},function(t,e,i){var n=i(4),r=i(136),o=i(131).registerRenderer,a=function(t){"use strict";if(!(this instanceof a))return new a(t);r.call(this,t),t=t||{};var e=this;return this.api=function(){return"dom"},this._init=function(){var t=e.layer().node();!e.canvas()&&t&&t.length&&e.canvas(t[0])},this._init(t),this};n(a,r),o("dom",a),t.exports=a},function(t,e,i){var n=i(4),r=i(5),o=function(t){"use strict";if(!(this instanceof o))return new o(t);r.call(this),t=t||{};var e=this,i=void 0===t.layer?null:t.layer,n=void 0===t.canvas?null:t.canvas,a=!1;return this.layer=function(){return i},this.canvas=function(t){return void 0===t?n:(n=t,void e.modified())},this.map=function(){return i?i.map():null},this.initialized=function(t){return void 0===t?a:(a=t,e)},this.api=function(){throw new Error("Should be implemented by derived classes")},this.reset=function(){return!0},this._init=function(){},this._resize=function(){},this._render=function(){},this};n(o,r),t.exports=o},function(t,e,i){var n=i(4),r=i(130),o=i(125),a=i(131),s=function(t){"use strict";if(!(this instanceof s))return new s(t);r.call(this,t);var e=this,i=[],n=this._init,u=this._exit,l=this._update,h=this.draw;return this.createFeature=function(t,n){var r=a.createFeature(t,e,e.renderer(),n);return e.addChild(r),i.push(r),e.features(i),e.modified(),r},this.deleteFeature=function(t){var n;for(n=0;n<i.length;n+=1)i[n]===t&&(i[n]._exit(),e.dataTime().modified(),e.modified());for(n=0;n<i.length;n+=1)i[n]===t&&i.splice(n,1);return e.removeChild(t),e},this.features=function(t){return void 0===t?i:(i=t.slice(0),e.dataTime().modified(),e.modified(),e)},this._init=function(){return e.initialized()?e:(n.call(e,!0),e.geoOn(o.resize,function(t){e.renderer()?(e.renderer()._resize(t.x,t.y,t.width,t.height),e._update({event:t}),e.renderer()._render()):e._update({event:t})}),e.geoOn(o.pan,function(t){e._update({event:t}),e.renderer()&&e.renderer()._render()}),e.geoOn(o.rotate,function(t){e._update({event:t}),e.renderer()&&e.renderer()._render()}),e.geoOn(o.zoom,function(t){e._update({event:t}),e.renderer()&&e.renderer()._render()}),e)},this._update=function(t){var n;if(!i.length)return e;if(l.call(e,t),i&&0===i.length)return void console.log("[info] No valid data source found.");if(e.dataTime().getMTime()>e.updateTime().getMTime())for(n=0;n<i.length;n+=1)i[n].renderer(e.renderer());for(n=0;n<i.length;n+=1)i[n]._update();return e.updateTime().modified(),e},this._exit=function(){e.clear(),u()},this.draw=function(){return h(),e.renderer()&&e.renderer()._render(),e},this.clear=function(){var t;if(!i.length)return e;for(t=0;t<i.length;t+=1)i[t]._exit(),e.removeChild(i[t]);return e.dataTime().modified(),e.modified(),i=[],e},e};n(s,r),a.registerLayer("feature",s),t.exports=s},function(t,e,i){t.exports=function(){"use strict";var t=i(1),e=function(i){if(!(this instanceof e))return new e(i);i=i||{},this._size=i.size||6,this._track=i.track||600,this._needed=i.needed||null,this._batch=!1;var n=this,r=1;return Object.defineProperty(this,"size",{get:function(){return this._size},set:function(t){this._size=t,this.next_item()}}),Object.defineProperty(this,"length",{get:function(){return this._queue.length}}),Object.defineProperty(this,"processing",{get:function(){return this._processing}}),this.clear=function(){return this._queue=[],this._processing=0,this},this.add=function(e,i,r){if(e.__fetchQueue){var o=t.inArray(e,this._queue);if(o>=0)return this._queue.splice(o,1),this._addToQueue(e,r),e}var a=new t.Deferred,s=new t.Deferred;return a.then(function(){t.when(i.call(e)).always(s.resolve)},s.resolve),e.__fetchQueue=a,this._addToQueue(e,r),t.when(a,s).always(function(){n._processing>0&&(n._processing-=1),n.next_item()}).promise(e),n.next_item(),e},this._addToQueue=function(t,e){if(t.__fetchQueue._batch=this._batch,e)this._queue.push(t);else if(this._batch){for(var i=0;i<this._queue.length&&this._queue[i].__fetchQueue._batch===this._batch;i+=1);this._queue.splice(i,0,t)}else this._queue.unshift(t)},this.get=function(e){return t.inArray(e,this._queue)},this.remove=function(e){var i=t.inArray(e,this._queue);return i>=0&&(this._queue.splice(i,1),!0)},this.batch=function(t){return void 0===t?this._batch:(t?(this._batch=r,r+=1):this._batch=!1,this)},this.next_item=function(){if(!n._innextitem){if(n._innextitem=!0,n._queue.length>n._track&&this._needed)for(var t=n._queue.length-1;t>=0;t-=1)if(!n._needed(n._queue[t])){var e=n._queue.splice(t,1)[0];n._processing+=1,e.__fetchQueue.reject(),delete e.__fetchQueue}for(;n._processing<n._size&&n._queue.length;){var i=n._queue.shift();if(i.__fetchQueue){n._processing+=1;var r=!n._needed||n._needed(i);r?i.__fetchQueue.resolve():i.__fetchQueue.reject(),delete i.__fetchQueue}}n._innextitem=!1}},this.clear(),this};return e}()},function(t,e,i){var n=i(4),r=i(137),o=i(5),a=function(t){"use strict";function e(t,e){var i=new FileReader;return e&&(i.onprogress=e),i.onloadend=function(){i.result||t(i.error),t(i.result)},i}if(!(this instanceof a))return new a(t);if(o.call(this),t=t||{},!(t.layer instanceof r))throw"fileReader must be given a feature layer";var i=t.layer;return this.layer=function(){return i},this.canRead=function(){return!1},this.read=function(t,e){e(!1)},this._getString=function(t,i,n){var r=e(i,n);r.readAsText(t)},this._getArrayBuffer=function(t,i,n){var r=e(i,n);r.readAsText(t)},this};n(a,o),t.exports=a},function(t,e,i){var n=i(4),r=i(127),o=function(t){"use strict";if(!(this instanceof o))return new o(t);var e=i(1);return t=t||{},r.call(this,t),t.style=void 0===t.style?e.extend({},{color:[1,1,1],point_sprites:!1,point_sprites_image:null},t.style):t.style,this.style(t.style),this};n(o,r),t.exports=o},function(t,e,i){var n=i(4),r=i(127),o=function(t){"use strict";if(!(this instanceof o))return new o(t);t=t||{},r.call(this,t);var e=i(1),n=i(120),a=i(131),s=this,u=this.draw,l=this.style,h=null,c=null,d=function(t){return t.children},f=[],p=this._init,m=this._exit;return this._init=function(t){p.call(s,t);var i=e.extend(!0,{},{nodes:{radius:5,fill:!0,fillColor:{r:1,g:0,b:0},strokeColor:{r:0,g:0,b:0}},links:{strokeColor:{r:0,g:0,b:0}},linkType:"path"},void 0===t.style?{}:t.style);s.style(i),s.nodes(function(t){return t})},this._build=function(){s.children().forEach(function(t){t._build()})},this._update=function(){s.children().forEach(function(t){t._update()})},this._exit=function(){return s.data([]),f.forEach(function(t){t._exit(),s.removeChild(t)}),f=[],c._exit(),s.removeChild(c),m(),s},this.style=function(t,e){var i=l.call(s,t,e);return i!==s?i:(c.style(t.nodes),f.forEach(function(e){e.style(t.links)}),s)},this.links=function(t){return void 0===t?d:(d=n.ensureFunction(t),s)},this.nodes=function(t){return void 0===t?h:(h=t,s.modified(),s)},this.nodeFeature=function(){return c},this.linkFeatures=function(){return f},this.draw=function(){var t,e=s.layer(),i=s.data(),n=0;return t=s.style(),c.data(i),c.style(t.nodes),i.forEach(function(i){(i.children||[]).forEach(function(r){var o;n+=1,f.length<n&&(o=a.createFeature(t.linkType,e,e.renderer()).style(t.links),s.addChild(o),f.push(o)),f[n-1].data([i,r])})}),f.splice(n,f.length-n).forEach(function(t){t._exit(),s.removeChild(t)}),u(),s},c=a.createFeature("point",this.layer(),this.layer().renderer()),s.addChild(c),t.nodes&&this.nodes(t.nodes),
this._init(t),this};n(o,r),t.exports=o},function(t,e,i){var n=i(4),r=i(143);t.exports=function(){"use strict";var t=function(e){if(!(this instanceof t))return new t(e);var n=i(1);return e.size=e.size||{x:256,y:256},this._image=null,this._cors=e.crossDomain||"anonymous",r.call(this,e),Object.defineProperty(this,"image",{get:function(){return this._image}}),this.fetch=function(){var t;return this._image||(this._image=new Image(this.size.x,this.size.y),this._url.indexOf(":")>=0&&this._url.indexOf("/")>=0&&this._url.indexOf(":")<this._url.indexOf("/")&&(this._image.crossOrigin=this._cors),t=new n.Deferred,this._image.onload=t.resolve,this._image.onerror=t.reject,this._image.src=this._url,t.then(function(){this._fetched=!0}.bind(this)).promise(this)),this},this.fadeIn=function(t){var e=this.fetch(),i=new n.Deferred;return n(this._image).css("display","none"),e.then(function(){n(this._image).fadeIn(t,function(){i.resolve()})}.bind(this)),i.promise(this)},this};return n(t,r),t}()},function(t,e,i){t.exports=function(){"use strict";var t=i(1),e=function(i){return this instanceof e?(this._index=i.index,this._size=i.size,this._overlap=i.overlap||{x:0,y:0},this._wrap=i.wrap||{x:1,y:1},this._url=i.url,this._fetched=!1,this._queue=i.queue||null,Object.defineProperty(this,"index",{get:function(){return this._index}}),Object.defineProperty(this,"size",{get:function(){return this._size}}),Object.defineProperty(this,"overlap",{get:function(){return this._overlap}}),this.fetch=function(){return this._fetched||t.get(this._url).then(function(){this._fetched=!0}.bind(this)).promise(this),this},this.fetched=function(){return this._fetched},this.then=function(t,e){return this.fetched()||!this._queue||!this._queue.add||this.state&&"pending"!==this.state()?this.fetch():this._queue.add(this,this.fetch),this.then(t,e),this},this["catch"]=function(t){return this.then(void 0,t),this},this.toString=function(){return[this._index.level||0,this._index.y,this._index.x].join("_")},this.bounds=function(t,e){var i,n,r,o;return i=this.size.x*(this.index.x-t.x)-this.overlap.x-e.x,n=i+this.size.x+2*this.overlap.x,o=this.size.y*(this.index.y-t.y)-this.overlap.y-e.y,r=o+this.size.y+2*this.overlap.y,{left:i,right:n,bottom:r,top:o}},Object.defineProperty(this,"bottom",{get:function(){return this.size.y*(this.index.y+1)+this.overlap.y}}),Object.defineProperty(this,"top",{get:function(){return this.size.y*this.index.y-this.overlap.y}}),Object.defineProperty(this,"left",{get:function(){return this.size.x*this.index.x-this.overlap.x}}),Object.defineProperty(this,"right",{get:function(){return this.size.x*(this.index.x+1)+this.overlap.x}}),Object.defineProperty(this,"levelSize",{value:{width:Math.pow(2,this.index.level||0)*this.size.x,height:Math.pow(2,this.index.level||0)*this.size.y}}),void(this.fadeIn=function(e){return t.noop(e),this})):new e(i)};return e}()},function(t,e,i){var n=i(4),r=i(131).registerFileReader,o=i(139),a=function(t){"use strict";if(!(this instanceof a))return new a(t);var e=i(1),n=i(120).convertColor,r=this;o.call(this,t),this.canRead=function(t){if(t instanceof File)return"application/json"===t.type||t.name.match(/\.json$/);if("string"==typeof t){try{JSON.parse(t)}catch(e){return!1}return!0}try{if(Array.isArray(r._featureArray(t)))return!0}catch(e){}return!1},this._readObject=function(t,i,n){function o(t){"string"!=typeof t&&i(!1);try{a=JSON.parse(t),i(a)}catch(n){a||e.ajax({type:"GET",url:t,dataType:"text"}).done(function(t){a=JSON.parse(t),i(a)}).fail(function(){i(!1)})}}var a;t instanceof File?r._getString(t,o,n):"string"==typeof t?o(t):i(t)},this._featureArray=function(t){var e,i=[];switch(t.type){case"FeatureCollection":e=t.features;break;case"Feature":e=[t];break;case"GeometryCollection":e=t.geometries.map(function(t){return{type:"Feature",geometry:t,properties:{}}});break;case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":e=[{type:"Feature",geometry:t,properties:{}}];break;default:throw new Error("Invalid json type")}return e.forEach(function(t){Array.prototype.push.apply(i,r._feature(t))}),i},this._feature=function(t){if("Feature"!==t.type)throw new Error("Invalid feature object");switch(t.geometry.type){case"Point":case"LineString":case"Polygon":return[t];case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.geometry.coordinates.map(function(e){return{type:"Feature",geometry:{type:t.geometry.type.replace("Multi",""),coordinates:e},properties:t.properties}});default:throw new Error("Invalid geometry type")}},this._position=function(t){return{x:t[0],y:t[1],z:t[2]||0}},this._style=function(t,e,i,n){return n=n||function(t){return t},e=n(e),function(r,o,a,s){var u;return u=i?i[s].properties:r.properties,u.hasOwnProperty(t)?n(u[t]):e}},this.read=function(t,e,i){function o(t){var i,o,a,s,u=[];i=r._featureArray(t),o=i.filter(function(t){return"Point"===t.geometry.type}),o.length&&u.push(r.layer().createFeature("point").data(o).position(function(t){return r._position(t.geometry.coordinates)}).style({fill:r._style("fill",!0),fillColor:r._style("fillColor","#ff7800",null,n),fillOpacity:r._style("fillOpacity",.8),stroke:r._style("stroke",!0),strokeColor:r._style("strokeColor","#000000",null,n),strokeWidth:r._style("strokeWidth",1),strokeOpacity:r._style("strokeOpacity",1),radius:r._style("radius",8)})),a=i.filter(function(t){return"LineString"===t.geometry.type}),a.length&&u.push(r.layer().createFeature("line").data(a).line(function(t){return t.geometry.coordinates}).position(r._position).style({strokeColor:r._style("strokeColor","#ff7800",a,n),strokeWidth:r._style("strokeWidth",4,a),strokeOpacity:r._style("strokeOpacity",.5,a)})),s=i.filter(function(t){return"Polygon"===t.geometry.type}),s.length&&u.push(r.layer().createFeature("polygon").data(s).polygon(function(t,e){return{outer:t.geometry.coordinates[0],inner:t.geometry.coordinates.slice(1)}}).position(r._position).style({fill:r._style("fill",!0),fillColor:r._style("fillColor","#b0de5c",s,n),fillOpacity:r._style("fillOpacity",.8,s),stroke:r._style("stroke",!0),strokeColor:r._style("strokeColor","#999999",s,n),strokeWidth:r._style("strokeWidth",2,s),strokeOpacity:r._style("strokeOpacity",1,s)})),e&&e(u)}r._readObject(t,o,i)}};n(a,o),r("jsonReader",a),t.exports=a},function(t,e,i){var n=i(4),r=i(127),o=function(t){"use strict";if(!(this instanceof o))return new o(t);var e=i(1);t=t||{},r.call(this,t);var n=this,a=this._init;return this.line=function(t){return void 0===t?n.style("line"):(n.style("line",t),n.dataTime().modified(),n.modified(),n)},this.position=function(t){return void 0===t?n.style("position"):(n.style("position",t),n.dataTime().modified(),n.modified(),n)},this.pointSearch=function(t){function e(t,e,n){var r,o=i(e,n);return o<1?i(t,e):(r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/o,r<0?i(t,e):r>1?i(t,n):i(t,{x:e.x+r*(n.x-e.x),y:e.y+r*(n.y-e.y)}))}function i(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n}var r,o,a,s,u,l=[],h=[];return r=n.data(),r&&r.length?(a=n.line(),s=n.style.get("strokeWidth"),u=n.position(),o=n.featureGcsToDisplay(t),r.forEach(function(t,i){var r=null;try{a(t,i).forEach(function(a,l){var h=u(a,l,t,i),c=n.featureGcsToDisplay(h),d=Math.ceil(s(h,l,t,i)/2)+2;if(d*=d,r&&e(o,c,r)<=d)throw"found";r=c})}catch(c){if("found"!==c)throw c;h.push(t),l.push(i)}}),{data:h,index:l}):{found:[],index:[]}},this.boxSearch=function(t,e,i){var r=n.position(),o=[],a=n.line();if(i=i||{},i.partial=i.partial||!1,i.partial)throw"Unimplemented query method.";return n.data().forEach(function(i,n){var s=!0;a(i,n).forEach(function(o,a){if(s){var u=r(o,a,i,n);u.x>=t.x&&u.x<=e.x&&u.y>=t.y&&u.y<=e.y||(s=!1)}}),s&&o.push(n)}),o},this._init=function(t){a.call(n,t);var i=e.extend({},{strokeWidth:1,strokeColor:{r:1,g:.8431372549,b:0},strokeStyle:"solid",strokeOpacity:1,line:function(t){return t},position:function(t){return t}},void 0===t.style?{}:t.style);void 0!==t.line&&(i.line=t.line),void 0!==t.position&&(i.position=t.position),n.style(i),n.dataTime().modified()},this._init(t),this};o.create=function(t,e){"use strict";return e.type="line",r.create(t,e)},o.capabilities={basic:"line.basic",multicolor:"line.multicolor"},n(o,r),t.exports=o},function(t,e,i){var n=i(1),r=i(6),o=i(4),a=i(128),s=function(t){"use strict";function e(t){var e,i,n=t.right-t.left,r=t.top-t.bottom,o=Math.abs(n/r),a=I/N;return o>a?(e=1,i=o/a):(i=1,e=a/o),{x:e,y:i}}function o(t,e){if(e){var i={x:(t.left+t.right)/2,y:(t.top+t.bottom)/2},n={width:Math.abs(t.left-t.right),height:Math.abs(t.top-t.bottom)};t=u(i,n,e)}return t}function u(t,e,i){var n=e.width/2,r=e.height/2,o=Math.sin(i),a=Math.cos(i),s={},u={},l={},h={};return s.x=t.x+-n*a- -r*o,s.y=t.y+-n*o+-r*a,u.x=t.x+n*a- -r*o,u.y=t.y+n*o+-r*a,l.x=t.x+-n*a-r*o,l.y=t.y+-n*o+r*a,h.x=t.x+n*a-r*o,h.y=t.y+n*o+r*a,{left:Math.min(s.x,u.x,l.x,h.x),right:Math.max(s.x,u.x,l.x,h.x),bottom:Math.min(s.y,u.y,l.y,h.y),top:Math.max(s.y,u.y,l.y,h.y)}}function l(t,i){void 0===i&&(i=z),t=o(t,i);var n,r=e(t);return n=r.y>r.x?-Math.log2(Math.abs(t.right-t.left)*r.x/(I*v)):-Math.log2(Math.abs(t.top-t.bottom)*r.y/(N*v))}function h(){x?V.min=Math.max(V.origMin,l(Q)):V.min=V.origMin}function c(t,e){return t=Math.max(Math.min(V.max,t),V.min),X&&!e&&(t=Math.round(t),t<V.min&&(t=Math.ceil(V.min))),t}function d(t,e,i){if(!K)return 0;if(e||"function"!=typeof K||(t=K(t)),!i){var n=2*Math.PI;t=t%n+(t>=0?0:n),Math.min(Math.abs(t),Math.abs(t-n))<1e-5&&(t=0)}return t}function f(t,e){if(!g&&!y)return t;var i,r,o=Q;if(e){o=n.extend({},Q);var a,s,u=Math.abs(t.right-t.left),l=Math.abs(t.top-t.bottom),h=Math.abs(Math.sin(e)),c=Math.abs(Math.cos(e));if(t.width&&t.height)a=t.width,s=t.height;else if(Math.abs(h-c)<5e-4)if(I&&N){var d=Math.abs(I/N),f=Math.pow(1+Math.pow(d,2),.5);a=Math.max(u,l)/f,s=a*d}else a=u*c,s=l*h;else a=(c*u-h*l)/(c*c-h*h),s=(c*l-h*u)/(c*c-h*h);var p=u-Math.max(c*a,h*s),m=l-Math.max(c*s,h*a);o.left-=p,o.right+=p,o.top+=m,o.bottom-=m}return g&&(t.right-t.left>o.right-o.left?i=o.left-(t.right-t.left-(o.right-o.left))/2-t.left:t.left<o.left?i=o.left-t.left:t.right>o.right&&(i=o.right-t.right),i&&(t={left:t.left+=i,right:t.right+=i,top:t.top,bottom:t.bottom})),y&&(t.top-t.bottom>o.top-o.bottom?r=o.bottom-(t.top-t.bottom-(o.top-o.bottom))/2-t.bottom:t.top>o.top?r=o.top-t.top:t.bottom<o.bottom&&(r=o.bottom-t.bottom),r&&(t={top:t.top+=r,bottom:t.bottom+=r,left:t.left,right:t.right})),t}function p(t,e){if(Y.rotation=e||0,t.width&&t.height&&e){var i=(t.left+t.right)/2,n=(t.top+t.bottom)/2;Y.viewFromCenterSizeRotation({x:i,y:n},t,e)}else Y.bounds=t}function m(){R.resize(0,0,O.width(),O.height())}if(!(this instanceof s))return new s(t);if(t=t||{},void 0===t.node||null===t.node)return console.warn("map creation requires a node"),this;a.call(this,t);var v,g,y,x,_,b=i(3),w=i(147),M=i(120),T=i(131),A=i(125),E=i(217),C=i(133),S=i(219),R=this,P=this._exit,L=0,D=0,O=n(t.node),I=t.width||O.width()||512,N=t.height||O.height()||512,F=void 0===t.gcs?"EPSG:3857":t.gcs,k=void 0===t.ingcs?"EPSG:4326":t.ingcs,G={x:0,y:0},U=void 0===t.zoom?4:t.zoom,z=0,B=null,j=null,V={min:0,max:16,origMin:0},q=null,W=null,H=null,X=!!t.discreteZoom,K="function"==typeof t.allowRotation?t.allowRotation:void 0===t.allowRotation||!!t.allowRotation,Q=t.maxBounds||{},Y=t.camera||b(),Z={x:1,y:1,z:1},$=((Q.left||0)+(Q.right||0))/2,J=((Q.bottom||0)+(Q.top||0))/2;return Q.left=w.transformCoordinates(k,F,{x:void 0!==Q.left?Q.left:-180,y:J}).x,Q.right=w.transformCoordinates(k,F,{x:void 0!==Q.right?Q.right:180,y:J}).x,Q.top=void 0!==Q.top?w.transformCoordinates(k,F,{x:$,y:Q.top}).y:Q.right,Q.bottom=void 0!==Q.bottom?w.transformCoordinates(k,F,{x:$,y:Q.bottom}).y:Q.left,v=t.unitsPerPixel||(Q.right-Q.left)/256,Y.viewport={width:I,height:N},t.center=M.normalizeCoordinates(t.center),t.autoResize=void 0===t.autoResize||t.autoResize,g=void 0!==t.clampBoundsX&&t.clampBoundsX,y=void 0===t.clampBoundsY||t.clampBoundsY,x=void 0===t.clampZoom||t.clampZoom,this.unitsPerPixel=function(t,e){return t=t||0,e?(v=Math.pow(2,t)*e,R.draw(),R):Math.pow(2,-t)*v},this.clampBoundsX=function(t){return void 0===t?g:(t!==g&&(g=!!t,R.pan({x:0,y:0})),R)},this.clampBoundsY=function(t){return void 0===t?y:(t!==y&&(y=!!t,R.pan({x:0,y:0})),R)},this.clampZoom=function(t){return void 0===t?x:(t!==x&&(x=!!t,h(),R.zoom(U)),R)},this.allowRotation=function(t){return void 0===t?K:("function"!=typeof t&&(t=!!t),t!==K&&(K=t,R.rotation(z)),R)},this.origin=function(){return n.extend({},_)},this.scale=function(){return n.extend({},Z)},this.camera=function(){return Y},this.gcs=function(t){if(void 0===t)return F;if(t!==F){var e=R.center(void 0,void 0);F=t,h();var i=c(U);i!==U&&R.zoom(i),R.center(e,void 0)}return R},this.ingcs=function(t){return void 0===t?k:(k=t,R)},this.node=function(){return O},this.zoom=function(t,e,i){if(void 0===t)return U;var n,r;if(t=c(t,i),t===U)return R;if(U=t,r=R.boundsFromZoomAndCenter(t,G,z,null,i),R.modified(),p(r,z),n={geo:{},zoomLevel:U,screenPosition:e?e.map:void 0},R.geoTrigger(A.zoom,n),e&&e.geo&&e.map){var o=R.gcsToDisplay(e.geo);R.pan({x:e.map.x-o.x,y:e.map.y-o.y},i)}else R.pan({x:0,y:0},i);return R},this.pan=function(t,e){var i={geo:{},screenDelta:t};if(t.x||t.y){var n=R.unitsPerPixel(U),r=Math.sin(z),o=Math.cos(z);Y.pan({x:(t.x*o- -t.y*r)*n,y:(t.x*r+-t.y*o)*n})}var a=f(Y.bounds,z);if(a!==Y.bounds){var s=R.gcsToDisplay({x:Y.bounds.left,y:Y.bounds.top},null);a=R.boundsFromZoomAndCenter(U,{x:(a.left+a.right)/2,y:(a.top+a.bottom)/2},z,null,e),p(a,z);var u=R.gcsToDisplay({x:Y.bounds.left,y:Y.bounds.top},null);i.screenDelta.x+=u.x-s.x,i.screenDelta.y+=u.y-s.y}return G=Y.displayToWorld({x:I/2,y:N/2}),R.geoTrigger(A.pan,i),R.modified(),R},this.rotation=function(t,e,i){if(void 0===t)return z;if(t=d(t,i),t===z)return R;z=t;var n=R.boundsFromZoomAndCenter(U,G,z,null,i);R.modified(),p(n,z);var r={geo:{},rotation:z,screenPosition:e?e.map:void 0};if(R.geoTrigger(A.rotate,r),e&&e.geo&&e.map){var o=R.gcsToDisplay(e.geo);R.pan({x:e.map.x-o.x,y:e.map.y-o.y})}else R.pan({x:0,y:0});return h(),R.zoom(U,i),R},this.center=function(t,e,i){var r;return void 0===t?r=n.extend({},R.worldToGcs(G,e)):(G=n.extend({},R.gcsToWorld(t,e)),p(R.boundsFromZoomAndCenter(U,G,z,null,i),z),R.modified(),R.geoTrigger(A.pan,{geo:t,screenDelta:null}),R)},this.createLayer=function(t,e){e=e||{};var i=T.createLayer(t,R,e);return i&&(R.addChild(i),R.children().forEach(function(t){t instanceof S&&t.moveToTop()}),i._update(),R.modified(),R.geoTrigger(A.layerAdd,{type:A.layerAdd,target:R,layer:i})),i},this.deleteLayer=function(t){return null!==t&&void 0!==t&&(t._exit(),R.removeChild(t),R.modified(),R.geoTrigger(A.layerRemove,{type:A.layerRemove,target:R,layer:t})),t},this.size=function(t){return void 0===t?{width:I,height:N}:(R.resize(0,0,t.width,t.height),R)},this.rotatedSize=function(){if(!this.rotation())return{width:I,height:N};var t=u({x:0,y:0},{width:I,height:N},this.rotation());return{width:Math.abs(t.right-t.left),height:Math.abs(t.top-t.bottom)}},this.resize=function(t,e,i,n){var r=R.center();L=t,D=e,I=i,N=n,h();var o=c(U);return o!==U&&R.zoom(o),R.camera().viewport={width:i,height:n},R.center(r),R.geoTrigger(A.resize,{type:A.resize,target:R,x:L,y:D,width:i,height:n}),R.modified(),R},this.gcsToWorld=function(t,e){return e=null===e?F:void 0===e?k:e,e!==F&&(t=w.transformCoordinates(e,F,t)),_.x||_.y||_.z?t=w.affineForward({origin:_},[t])[0]:"z"in t||(t={x:t.x,y:t.y,z:0}),t},this.worldToGcs=function(t,e){return _.x||_.y||_.z?t=w.affineInverse({origin:_},[t])[0]:"z"in t||(t={x:t.x,y:t.y,z:0}),e=null===e?F:void 0===e?k:e,e!==F&&(t=w.transformCoordinates(F,e,t)),t},this.gcsToDisplay=function(t,e){return t=R.gcsToWorld(t,e),R.worldToDisplay(t)},this.worldToDisplay=function(t){return Y.worldToDisplay(t)},this.displayToGcs=function(t,e){return t=R.displayToWorld(t),R.worldToGcs(t,e)},this.displayToWorld=function(t){return Y.displayToWorld(t)},this.draw=function(){var t,e=R.children();for(R.geoTrigger(A.draw,{type:A.draw,target:R}),R._update(),t=0;t<e.length;t+=1)e[t].draw();return R.geoTrigger(A.drawEnd,{type:A.drawEnd,target:R}),R},this.fileReader=function(t,e){var i,n;return e=e||{},t?(i=e.layer,i||(n=e.renderer,n||(n="d3"),i=R.createLayer("feature",{renderer:n})),e.layer=i,e.renderer=n,B=T.createFileReader(t,e),R):B},this._init=function(){if(void 0===O||null===O)throw"Map require DIV node";return O.css("position","relative"),R},this._update=function(t){var e,i=R.children();for(e=0;e<i.length;e+=1)i[e]._update(t);return R},this.exit=function(){var t,e=R.children();for(t=0;t<e.length;t+=1)e[t]._exit();R.interactor()&&(R.interactor().destroy(),R.interactor(null)),R.node().off(".geo"),R.node().empty(),n(window).off("resize",m),P()},this._init(t),this.node().on("dragover.geo",function(t){var e=t.originalEvent;R.fileReader()&&(e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy")}).on("drop.geo",function(t){function e(){R.draw()}var i,n,r=t.originalEvent,o=R.fileReader();if(o)for(r.stopPropagation(),r.preventDefault(),i=0;i<r.dataTransfer.files.length;i+=1)n=r.dataTransfer.files[i],o.canRead(n)&&o.read(n,e)}),this.interactor=function(t){return void 0===t?j:(j=t,j&&j.map(R),R)},this.clock=function(t){return void 0===t?H:(H=t,H&&H.object(R),R)},this.zoomRange=function(t,e){return void 0===t?n.extend({},V):(void 0!==t.max&&(V.max=t.max),void 0!==t.min&&(V.min=V.origMin=t.min),h(),e||R.zoom(U),R)},this.transition=function(t,e,i){function o(t,e,i){return t+(e-t)*i}function a(t,e){return function(i){var r=[];return n.each(t,function(n){r.push(o(t[n],e[n],i))}),r}}function s(t){return r.zoomToHeight(t+1,I,N)*f}function u(t){return r.heightToZoom(t/f,I,N)-1}function l(e){var i=q.done,n=W;if(q.cancel===!0)return R.geoTrigger(A.transitioncancel,t),i&&i({cancel:!0,source:q.cancelSource,transition:q}),q=null,void(W&&(n=W,W=null,R.transition(n,void 0,e)));if(q.start.time||(q.start.time=e,q.end.time=e+t.duration),q.time=e-q.start.time,e>=q.end.time||n)return n||(R.center(q.end.center,null),R.zoom(q.end.zoom,q.zoomOrigin),R.rotation(d(q.end.rotation))),R.geoTrigger(A.transitionend,t),i&&i({next:!!n}),q=null,void(W&&(n=W,W=null,R.transition(n,void 0,e)));var r=q.ease((e-q.start.time)/t.duration),o=q.interp(r);q.zCoord&&(o[2]=u(o[2])),c(o[2],!0)===U?R.center({x:o[0],y:o[1]},null,!0):(G=R.gcsToWorld({x:o[0],y:o[1]},null),R.zoom(o[2],q.zoomOrigin,!0)),R.rotation(o[3],void 0,!0),window.requestAnimationFrame(l)}if(void 0===t)return q;if(q){var h=n.extend(!0,{},q.end);return h.center&&F!==k&&(h.center=w.transformCoordinates(F,k,h.center)),W=n.extend({},h||{},W||{},t),R}var f=R.unitsPerPixel(0),p={center:R.center(void 0,null),zoom:R.zoom(),rotation:R.rotation(),duration:1e3,ease:function(t){return t},interp:a,done:null,zCoord:!0};return t.center&&(e=null===e?F:void 0===e?k:e,t=n.extend(!0,{},t),t.center=M.normalizeCoordinates(t.center),e!==F&&(t.center=w.transformCoordinates(e,F,t.center))),t=n.extend(!0,{},p,t),q={start:{center:R.center(void 0,null),zoom:R.zoom(),rotation:R.rotation()},end:{center:t.center,zoom:c(t.zoom),rotation:d(t.rotation,void 0,!0)},ease:t.ease,zCoord:t.zCoord,done:t.done,duration:t.duration,zoomOrigin:t.zoomOrigin},q.interp=t.interp([q.start.center.x,q.start.center.y,t.zCoord?s(q.start.zoom):q.start.zoom,q.start.rotation],[q.end.center.x,q.end.center.y,t.zCoord?s(q.end.zoom):q.end.zoom,q.end.rotation]),R.geoTrigger(A.transitionstart,t),A.cancelNavigation?(q=null,R.geoTrigger(A.transitionend,t),R):(A.cancelAnimation?(t.duration=0,l(0)):i?l(i):window.requestAnimationFrame(l),R)},this.transitionCancel=function(t){return!(!q||q.cancel===!0&&!W)&&(q.cancel=!0,q.cancelSource=t||q.cancelSource||"",W=null,!0)},this.bounds=function(t,e){var i;if(e=null===e?F:void 0===e?k:e,void 0!==t){if(e!==F){var n=w.transformCoordinates(e,F,[{x:t.left,y:t.top},{x:t.right,y:t.bottom}]);t={left:n[0].x,top:n[0].y,right:n[1].x,bottom:n[1].y}}t=f(t,z),i=R.zoomAndCenterFromBounds(t,z,null),R.zoom(i.zoom),R.center(i.center,null)}return R.boundsFromZoomAndCenter(U,G,z,e,!0)},this.maxBounds=function(t,e){if(e=null===e?F:void 0===e?k:e,void 0===t)return{left:w.transformCoordinates(F,e,{x:Q.left,y:0}).x,right:w.transformCoordinates(F,e,{x:Q.right,y:0}).x,bottom:w.transformCoordinates(F,e,{x:0,y:Q.bottom}).y,top:w.transformCoordinates(F,e,{x:0,y:Q.top}).y};var i=((t.left||0)+(t.right||0))/2,n=((t.bottom||0)+(t.top||0))/2;return void 0!==t.left&&(Q.left=w.transformCoordinates(e,F,{x:t.left,y:n}).x),void 0!==t.right&&(Q.right=w.transformCoordinates(e,F,{x:t.right,y:n}).x),void 0!==t.bottom&&(Q.bottom=w.transformCoordinates(e,F,{x:i,y:t.bottom}).y),void 0!==t.top&&(Q.top=w.transformCoordinates(e,F,{x:i,y:t.top}).y),h(),R.zoom(U),R.pan({x:0,y:0}),this},this.zoomAndCenterFromBounds=function(t,e,i){var n,r;if(i=null===i?F:void 0===i?k:i,i!==F){var o=w.transformCoordinates(i,F,[{x:t.left,y:t.top},{x:t.right,y:t.bottom}]);t={left:o[0].x,top:o[0].y,right:o[1].x,bottom:o[1].y}}if(t.left>=t.right||t.bottom>=t.top)throw new Error("Invalid bounds provided");return r=c(l(t,e)),t=f(t,e),n={x:(t.left+t.right)/2-_.x,y:(t.top+t.bottom)/2-_.y},i!==F&&(n=w.transformCoordinates(F,i,n)),{zoom:r,center:n}},this.boundsFromZoomAndCenter=function(t,e,i,n,r){var o,a,s,l,h,d;if(n=null===n?F:void 0===n?k:n,t=c(t,r),d=R.unitsPerPixel(t),e=R.gcsToWorld(e,n),o=I*d,a=N*d,s=o/2,l=a/2,i?(e.x+=_.x,e.y+=_.y,h=u(e,{width:o,height:a},i),h.width=o,h.height=a,h=f(h,i)):(h={left:e.x-s+_.x,right:e.x+s+_.x,bottom:e.y-l+_.y,top:e.y+l+_.y},h=f(h,0)),n!==F){var p=w.transformCoordinates(F,n,[[h.left,h.top],[h.right,h.bottom]]);h={left:p[0][0],top:p[0][1],right:p[1][0],bottom:p[1][1]}}return h.width=o,h.height=a,h},this.discreteZoom=function(t){return void 0===t?X:(t=!!t,X!==t&&(X=t,X&&R.zoom(Math.round(R.zoom())),R.interactor().options({discreteZoom:X})),R)},this.layers=this.children,this.updateAttribution=function(){R.node().find(".geo-attribution").remove();var t=n("<div/>").addClass("geo-attribution").css({position:"absolute",right:"0px",bottom:"0px","padding-right":"5px",cursor:"auto",font:'11px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif',"z-index":"1001",background:"rgba(255,255,255,0.7)",clear:"both",display:"block","pointer-events":"auto"}).on("mousedown",function(t){t.stopPropagation()});return R.children().forEach(function(e){var i=e.attribution();i&&n("<span/>").addClass("geo-attribution-layer").css({"padding-left":"5px"}).html(i).appendTo(t)}),t.appendTo(R.node()),R},_={x:0,y:0},this.zoomRange(t,!0),U=c(U),z=d(z),this.center(n.extend({},t.center||G),void 0),this.interactor(t.interactor||E({discreteZoom:X})),this.clock(t.clock||C()),t.autoResize&&n(window).resize(m),R.geoOn([A.layerAdd,A.layerRemove],R.updateAttribution),this};s.create=function(t){"use strict";var e=s(t),n=i(130);return e&&e.zoom?(t.data=t.data||[],t.layers=t.layers||[],t.layers.forEach(function(i){i.data=i.data||t.data,i.layer=n.create(e,i)}),e):(console.warn("Could not create map."),null)},o(s,a),t.exports=s},function(t,e,i){var n=i(148),r={},o=10,a=function(t){"use strict";function e(){i=new n(l.source(),l.target())}if(!(this instanceof a))return t=t||{},t.source in r||(Object.size(r)>=o&&(r={}),r[t.source]={}),t.target in r[t.source]||(Object.size(r[t.source])>=o&&(r[t.source]={}),r[t.source][t.target]=new a(t)),r[t.source][t.target];var i,s,u,l=this;this.source=function(t){return void 0===t?s||"EPSG:4326":(s=t,e(),l)},this.target=function(t){return void 0===t?u||"EPSG:3857":(u=t,e(),l)},this._forward=function(t){var e=i.forward(t);return e.z=t.z||0,e},this._inverse=function(t){var e=i.inverse(t);return e.z=t.z||0,e},this.forward=function(t){return Array.isArray(t)?t.map(l._forward):l._forward(t)},this.inverse=function(t){return Array.isArray(t)?t.map(l._inverse):l._inverse(t)},t=t||{};try{this.source(t.source)}catch(h){console.error("Can't use transform source: "+t.source),this.source("EPSG:4326")}try{this.target(t.target)}catch(h){console.error("Can't use transform target: "+t.target),this.target("EPSG:3857")}return this};a.defs=n.defs,a.lookup=function(t){var e,r,o=i(1),a=new o.Deferred;return n.defs.hasOwnProperty(t)?a.resolve(n.defs[t]):(r=t.split(":"),2!==r.length||"EPSG"!==r[0].toUpperCase()?a.reject("Invalid projection code").promise():(e=r[1],o.ajax({url:"http://epsg.io/?q="+e+"&format=json"}).then(function(e){var i=(e.results||[])[0];return i&&i.proj4?(n.defs(t,i.proj4),o.when(n.defs[t])):a.reject(e).promise()})))},a.transformCoordinates=function(t,e,i,n){"use strict";if(t===e)return i;var r,o=a({source:t,target:e});return i instanceof Object&&"x"in i&&"y"in i?(r=o.forward({x:i.x,y:i.y,z:i.z||0}),"z"in i?r:{x:r.x,y:r.y}):i instanceof Array&&1===i.length&&i[0]instanceof Object&&"x"in i[0]&&"y"in i[0]?(r=o.forward({x:i[0].x,y:i[0].y,z:i[0].z||0}),"z"in i[0]?[r]:[{x:r.x,y:r.y}]):a.transformCoordinatesArray(o,i,n)},a.transformCoordinatesArray=function(t,e,i){function n(){if(e[0]instanceof Array)if(2===e[0].length)u=function(t){return e[t][0]},l=function(t){return e[t][1]},c=function(t,e,i){d[t]=[e,i]};else{if(3!==e[0].length)throw new Error("Invalid coordinates. Requires two or three components per array");u=function(t){return e[t][0]},l=function(t){return e[t][1]},h=function(t){return e[t][2]},c=function(t,e,i,n){d[t]=[e,i,n]}}else if(2===e.length)s=2,u=function(t){return e[t*s]},l=function(t){return e[t*s+1]},c=function(t,e,i){d[t]=e,d[t+1]=i};else if(3===e.length)s=3,u=function(t){return e[t*s]},l=function(t){return e[t*s+1]},h=function(t){return e[t*s+2]},c=function(t,e,i,n){d[t]=e,d[t+1]=i,d[t+2]=n};else{if(!i)throw new Error("Invalid coordinates");if(2!==i&&3!==i)throw new Error("Number of components should be two or three");s=i,u=function(t){return e[t]},l=function(t){return e[t+1]},2===i?c=function(t,e,i){d[t]=e,d[t+1]=i}:(h=function(t){return e[t+2]},c=function(t,e,i,n){d[t]=e,d[t+1]=i,d[t+2]=n})}}function r(){if(!(e[0]&&"x"in e[0]&&"y"in e[0]))throw new Error("Invalid coordinates");u=function(t){return e[t].x},l=function(t){return e[t].y},"z"in e[0]?(h=function(t){return e[t].z},c=function(t,e,i,n){d[o]={x:e,y:i,z:n}}):c=function(t,e,i){d[t]={x:e,y:i}}}var o,a,s,u,l,h,c,d,f;if(h=function(){return 0},!(e instanceof Array))throw new Error("Coordinates are not valid");if(d=[],d.length=e.length,a=e.length,!e.length)return d;for(e[0]instanceof Array||e[0]instanceof Object?(s=1,e[0]instanceof Array?n():e[0]instanceof Object&&r()):n(),o=0;o<a;o+=s)f=t.forward({x:u(o),y:l(o),z:h(o)}),c(o,f.x,f.y,f.z);return d},a.affineForward=function(t,e){"use strict";var i,n=t.origin,r=t.scale||{x:1,y:1,z:1};for(i=0;i<e.length;i+=1)e[i].x=(e[i].x-n.x)*r.x,e[i].y=(e[i].y-n.y)*r.y,e[i].z=((e[i].z||0)-(n.z||0))*r.z;return e},a.affineInverse=function(t,e){"use strict";var i,n=t.origin,r=t.scale||{x:1,y:1,z:1};for(i=0;i<e.length;i+=1)e[i].x=e[i].x/r.x+n.x,e[i].y=e[i].y/r.y+n.y,e[i].z=(e[i].z||0)/r.z+(n.z||0);return e},t.exports=a},function(t,e,i){var n=i(149);n.defaultDatum="WGS84",n.Proj=i(150),n.WGS84=new n.Proj("WGS84"),n.Point=i(175),n.toPoint=i(174),n.defs=i(152),n.transform=i(171),n.mgrs=i(176),n.version=i(177).version,i(178)(n),t.exports=n},function(t,e,i){function n(t,e,i){var n;return Array.isArray(i)?(n=s(t,e,i),3===i.length?[n.x,n.y,n.z]:[n.x,n.y]):s(t,e,i)}function r(t){return t instanceof a?t:t.oProj?t.oProj:a(t)}function o(t,e,i){t=r(t);var o,a=!1;return"undefined"==typeof e?(e=t,t=u,a=!0):("undefined"!=typeof e.x||Array.isArray(e))&&(i=e,e=t,t=u,a=!0),e=r(e),i?n(t,e,i):(o={forward:function(i){return n(t,e,i)},inverse:function(i){return n(e,t,i)}},a&&(o.oProj=e),o)}var a=i(150),s=i(171),u=a("WGS84");t.exports=o},function(t,e,i){function n(t,e){if(!(this instanceof n))return new n(t);e=e||function(t){if(t)throw t};var i=r(t);if("object"!=typeof i)return void e(t);var a=s(i),u=n.projections.get(a.projName);u?(o(this,a),o(this,u),this.init(),e(null,this)):e(t)}var r=i(151),o=i(158),a=i(159),s=i(167);n.projections=a,n.projections.start(),t.exports=n},function(t,e,i){function n(t){return"string"==typeof t}function r(t){return t in u}function o(t){var e=["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"];return e.reduce(function(e,i){return e+1+t.indexOf(i)},0)}function a(t){return"+"===t[0]}function s(t){return n(t)?r(t)?u[t]:o(t)?l(t):a(t)?h(t):void 0:t}var u=i(152),l=i(157),h=i(154);t.exports=s},function(t,e,i){function n(t){var e=this;if(2===arguments.length){var i=arguments[1];"string"==typeof i?"+"===i.charAt(0)?n[t]=o(arguments[1]):n[t]=a(arguments[1]):n[t]=i}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){Array.isArray(t)?n.apply(e,t):n(t)});if("string"==typeof t){if(t in n)return n[t]}else"EPSG"in t?n["EPSG:"+t.EPSG]=t:"ESRI"in t?n["ESRI:"+t.ESRI]=t:"IAU2000"in t?n["IAU2000:"+t.IAU2000]=t:console.log(t);return}}var r=i(153),o=i(154),a=i(157);r(n),t.exports=n},function(t,e){t.exports=function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}},function(t,e,i){var n=.017453292519943295,r=i(155),o=i(156);t.exports=function(t){var e={},i={};t.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).forEach(function(t){var e=t.split("=");e.push(!0),i[e[0].toLowerCase()]=e[1]});var a,s,u,l={proj:"projName",datum:"datumCode",rf:function(t){e.rf=parseFloat(t)},lat_0:function(t){e.lat0=t*n},lat_1:function(t){e.lat1=t*n},lat_2:function(t){e.lat2=t*n},lat_ts:function(t){e.lat_ts=t*n},lon_0:function(t){e.long0=t*n},lon_1:function(t){e.long1=t*n},lon_2:function(t){e.long2=t*n},alpha:function(t){e.alpha=parseFloat(t)*n},lonc:function(t){e.longc=t*n},x_0:function(t){e.x0=parseFloat(t)},y_0:function(t){e.y0=parseFloat(t)},k_0:function(t){e.k0=parseFloat(t)},k:function(t){e.k0=parseFloat(t)},a:function(t){e.a=parseFloat(t)},b:function(t){e.b=parseFloat(t)},r_a:function(){e.R_A=!0},zone:function(t){e.zone=parseInt(t,10)},south:function(){e.utmSouth=!0},towgs84:function(t){e.datum_params=t.split(",").map(function(t){return parseFloat(t)})},to_meter:function(t){e.to_meter=parseFloat(t)},units:function(t){e.units=t,o[t]&&(e.to_meter=o[t].to_meter)},from_greenwich:function(t){e.from_greenwich=t*n},pm:function(t){e.from_greenwich=(r[t]?r[t]:parseFloat(t))*n},nadgrids:function(t){"@null"===t?e.datumCode="none":e.nadgrids=t},axis:function(t){var i="ewnsud";3===t.length&&i.indexOf(t.substr(0,1))!==-1&&i.indexOf(t.substr(1,1))!==-1&&i.indexOf(t.substr(2,1))!==-1&&(e.axis=t)}};for(a in i)s=i[a],a in l?(u=l[a],"function"==typeof u?u(s):e[u]=s):e[a]=s;return"string"==typeof e.datumCode&&"WGS84"!==e.datumCode&&(e.datumCode=e.datumCode.toLowerCase()),e}},function(t,e){e.greenwich=0,e.lisbon=-9.131906111111,e.paris=2.337229166667,e.bogota=-74.080916666667,e.madrid=-3.687938888889,e.rome=12.452333333333,e.bern=7.439583333333,e.jakarta=106.807719444444,e.ferro=-17.666666666667,e.brussels=4.367975,e.stockholm=18.058277777778,e.athens=23.7163375,e.oslo=10.722916666667},function(t,e){e.ft={to_meter:.3048},e["us-ft"]={to_meter:1200/3937}},function(t,e,i){function n(t,e,i){t[e]=i.map(function(t){var e={};return r(t,e),e}).reduce(function(t,e){return l(t,e)},{})}function r(t,e){var i;return Array.isArray(t)?(i=t.shift(),"PARAMETER"===i&&(i=t.shift()),1===t.length?Array.isArray(t[0])?(e[i]={},r(t[0],e[i])):e[i]=t[0]:t.length?"TOWGS84"===i?e[i]=t:(e[i]={},["UNIT","PRIMEM","VERT_DATUM"].indexOf(i)>-1?(e[i]={name:t[0].toLowerCase(),convert:t[1]},3===t.length&&(e[i].auth=t[2])):"SPHEROID"===i?(e[i]={name:t[0],a:t[1],rf:t[2]},4===t.length&&(e[i].auth=t[3])):["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(i)>-1?(t[0]=["name",t[0]],n(e,i,t)):t.every(function(t){return Array.isArray(t)})?n(e,i,t):r(t,e[i])):e[i]=!0,void 0):void(e[t]=!0)}function o(t,e){var i=e[0],n=e[1];!(i in t)&&n in t&&(t[i]=t[n],
3===e.length&&(t[i]=e[2](t[i])))}function a(t){return t*u}function s(t){function e(e){var i=t.to_meter||1;return parseFloat(e,10)*i}"GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=parseFloat(t.UNIT.convert,10)*t.DATUM.SPHEROID.a):t.to_meter=parseFloat(t.UNIT.convert,10))),t.GEOGCS&&(t.GEOGCS.DATUM?t.datumCode=t.GEOGCS.DATUM.name.toLowerCase():t.datumCode=t.GEOGCS.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"===t.datumCode&&("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),t.GEOGCS.DATUM&&t.GEOGCS.DATUM.SPHEROID&&(t.ellps=t.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=t.GEOGCS.DATUM.SPHEROID.a,t.rf=parseFloat(t.GEOGCS.DATUM.SPHEROID.rf,10)),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36")),t.b&&!isFinite(t.b)&&(t.b=t.a);var i=function(e){return o(t,e)},n=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",a],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",a],["x0","false_easting",e],["y0","false_northing",e],["long0","central_meridian",a],["lat0","latitude_of_origin",a],["lat0","standard_parallel_1",a],["lat1","standard_parallel_1",a],["lat2","standard_parallel_2",a],["alpha","azimuth",a],["srsCode","name"]];n.forEach(i),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=a(t.lat1>0?90:-90),t.lat_ts=t.lat1)}var u=.017453292519943295,l=i(158);t.exports=function(t,e){var i=JSON.parse((","+t).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]').replace(/,\["VERTCS".+/,"")),n=i.shift(),o=i.shift();i.unshift(["name",o]),i.unshift(["type",n]),i.unshift("output");var a={};return r(i,a),s(a.output),l(e,a.output)}},function(t,e){t.exports=function(t,e){t=t||{};var i,n;if(!e)return t;for(n in e)i=e[n],void 0!==i&&(t[n]=i);return t}},function(t,e,i){function n(t,e){var i=a.length;return t.names?(a[i]=t,t.names.forEach(function(t){o[t.toLowerCase()]=i}),this):(console.log(e),!0)}var r=[i(160),i(166)],o={},a=[];e.add=n,e.get=function(t){if(!t)return!1;var e=t.toLowerCase();return"undefined"!=typeof o[e]&&a[o[e]]?a[o[e]]:void 0},e.start=function(){r.forEach(n)}},function(t,e,i){var n=i(161),r=Math.PI/2,o=1e-10,a=57.29577951308232,s=i(162),u=Math.PI/4,l=i(164),h=i(165);e.init=function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=n(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},e.forward=function(t){var e=t.x,i=t.y;if(i*a>90&&i*a<-90&&e*a>180&&e*a<-180)return null;var n,h;if(Math.abs(Math.abs(i)-r)<=o)return null;if(this.sphere)n=this.x0+this.a*this.k0*s(e-this.long0),h=this.y0+this.a*this.k0*Math.log(Math.tan(u+.5*i));else{var c=Math.sin(i),d=l(this.e,i,c);n=this.x0+this.a*this.k0*s(e-this.long0),h=this.y0-this.a*this.k0*Math.log(d)}return t.x=n,t.y=h,t},e.inverse=function(t){var e,i,n=t.x-this.x0,o=t.y-this.y0;if(this.sphere)i=r-2*Math.atan(Math.exp(-o/(this.a*this.k0)));else{var a=Math.exp(-o/(this.a*this.k0));if(i=h(this.e,a),i===-9999)return null}return e=s(this.long0+n/(this.a*this.k0)),t.x=e,t.y=i,t},e.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},function(t,e){t.exports=function(t,e,i){var n=t*e;return i/Math.sqrt(1-n*n)}},function(t,e,i){var n=2*Math.PI,r=3.14159265359,o=i(163);t.exports=function(t){return Math.abs(t)<=r?t:t-o(t)*n}},function(t,e){t.exports=function(t){return t<0?-1:1}},function(t,e){var i=Math.PI/2;t.exports=function(t,e,n){var r=t*n,o=.5*t;return r=Math.pow((1-r)/(1+r),o),Math.tan(.5*(i-e))/r}},function(t,e){var i=Math.PI/2;t.exports=function(t,e){for(var n,r,o=.5*t,a=i-2*Math.atan(e),s=0;s<=15;s++)if(n=t*Math.sin(a),r=i-2*Math.atan(e*Math.pow((1-n)/(1+n),o))-a,a+=r,Math.abs(r)<=1e-10)return a;return-9999}},function(t,e){function i(t){return t}e.init=function(){},e.forward=i,e.inverse=i,e.names=["longlat","identity"]},function(t,e,i){var n=i(168),r=i(169),o=i(158),a=i(170),s=1e-10,u=.16666666666666666,l=.04722222222222222,h=.022156084656084655;t.exports=function(t){if(t.datumCode&&"none"!==t.datumCode){var e=n[t.datumCode];e&&(t.datum_params=e.towgs84?e.towgs84.split(","):null,t.ellps=e.ellipse,t.datumName=e.datumName?e.datumName:t.datumCode)}if(!t.a){var i=r[t.ellps]?r[t.ellps]:r.WGS84;o(t,i)}return t.rf&&!t.b&&(t.b=(1-1/t.rf)*t.a),(0===t.rf||Math.abs(t.a-t.b)<s)&&(t.sphere=!0,t.b=t.a),t.a2=t.a*t.a,t.b2=t.b*t.b,t.es=(t.a2-t.b2)/t.a2,t.e=Math.sqrt(t.es),t.R_A&&(t.a*=1-t.es*(u+t.es*(l+t.es*h)),t.a2=t.a*t.a,t.b2=t.b*t.b,t.es=0),t.ep2=(t.a2-t.b2)/t.b2,t.k0||(t.k0=1),t.axis||(t.axis="enu"),t.datum||(t.datum=a(t)),t}},function(t,e){e.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},e.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},e.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},e.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},e.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},e.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},e.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},e.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},e.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},e.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},e.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},e.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},e.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},e.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},e.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},e.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},function(t,e){e.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},e.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},e.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},e.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},e.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},e.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},e.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},e.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},e.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},e.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},e.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},e.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},e.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},e.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},e.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},e.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},e.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},e.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},e.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},e.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},e.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},e.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},e.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},e.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},e.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},e.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},e.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},e.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},e.hough={a:6378270,rf:297,ellipseName:"Hough"},e.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},e.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},e.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},e.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},e.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},e.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},e.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},e.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},e.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},e.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},e.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},e.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},e.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},e.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},function(t,e){var i=Math.PI/2,n=1,r=2,o=3,a=4,s=5,u=484813681109536e-20,l=1.0026,h=.3826834323650898,c=function(t){return this instanceof c?(this.datum_type=a,void(t&&(t.datumCode&&"none"===t.datumCode&&(this.datum_type=s),t.datum_params&&(this.datum_params=t.datum_params.map(parseFloat),0===this.datum_params[0]&&0===this.datum_params[1]&&0===this.datum_params[2]||(this.datum_type=n),this.datum_params.length>3&&(0===this.datum_params[3]&&0===this.datum_params[4]&&0===this.datum_params[5]&&0===this.datum_params[6]||(this.datum_type=r,this.datum_params[3]*=u,this.datum_params[4]*=u,this.datum_params[5]*=u,this.datum_params[6]=this.datum_params[6]/1e6+1))),this.datum_type=t.grids?o:this.datum_type,this.a=t.a,this.b=t.b,this.es=t.es,this.ep2=t.ep2,this.datum_type===o&&(this.grids=t.grids)))):new c(t)};c.prototype={compare_datums:function(t){return this.datum_type===t.datum_type&&(!(this.a!==t.a||Math.abs(this.es-t.es)>5e-11)&&(this.datum_type===n?this.datum_params[0]===t.datum_params[0]&&this.datum_params[1]===t.datum_params[1]&&this.datum_params[2]===t.datum_params[2]:this.datum_type===r?this.datum_params[0]===t.datum_params[0]&&this.datum_params[1]===t.datum_params[1]&&this.datum_params[2]===t.datum_params[2]&&this.datum_params[3]===t.datum_params[3]&&this.datum_params[4]===t.datum_params[4]&&this.datum_params[5]===t.datum_params[5]&&this.datum_params[6]===t.datum_params[6]:this.datum_type!==o&&t.datum_type!==o||this.nadgrids===t.nadgrids))},geodetic_to_geocentric:function(t){var e,n,r,o,a,s,u,l=t.x,h=t.y,c=t.z?t.z:0,d=0;if(h<-i&&h>-1.001*i)h=-i;else if(h>i&&h<1.001*i)h=i;else if(h<-i||h>i)return null;return l>Math.PI&&(l-=2*Math.PI),a=Math.sin(h),u=Math.cos(h),s=a*a,o=this.a/Math.sqrt(1-this.es*s),e=(o+c)*u*Math.cos(l),n=(o+c)*u*Math.sin(l),r=(o*(1-this.es)+c)*a,t.x=e,t.y=n,t.z=r,d},geocentric_to_geodetic:function(t){var e,n,r,o,a,s,u,l,h,c,d,f,p,m,v,g,y,x=1e-12,_=x*x,b=30,w=t.x,M=t.y,T=t.z?t.z:0;if(p=!1,e=Math.sqrt(w*w+M*M),n=Math.sqrt(w*w+M*M+T*T),e/this.a<x){if(p=!0,v=0,n/this.a<x)return g=i,void(y=-this.b)}else v=Math.atan2(M,w);r=T/n,o=e/n,a=1/Math.sqrt(1-this.es*(2-this.es)*o*o),l=o*(1-this.es)*a,h=r*a,m=0;do m++,u=this.a/Math.sqrt(1-this.es*h*h),y=e*l+T*h-u*(1-this.es*h*h),s=this.es*u/(u+y),a=1/Math.sqrt(1-s*(2-s)*o*o),c=o*(1-s)*a,d=r*a,f=d*l-c*h,l=c,h=d;while(f*f>_&&m<b);return g=Math.atan(d/Math.abs(c)),t.x=v,t.y=g,t.z=y,t},geocentric_to_geodetic_noniter:function(t){var e,n,r,o,a,s,u,c,d,f,p,m,v,g,y,x,_,b=t.x,w=t.y,M=t.z?t.z:0;if(b=parseFloat(b),w=parseFloat(w),M=parseFloat(M),_=!1,0!==b)e=Math.atan2(w,b);else if(w>0)e=i;else if(w<0)e=-i;else if(_=!0,e=0,M>0)n=i;else{if(!(M<0))return n=i,void(r=-this.b);n=-i}return a=b*b+w*w,o=Math.sqrt(a),s=M*l,c=Math.sqrt(s*s+a),f=s/c,m=o/c,p=f*f*f,u=M+this.b*this.ep2*p,x=o-this.a*this.es*m*m*m,d=Math.sqrt(u*u+x*x),v=u/d,g=x/d,y=this.a/Math.sqrt(1-this.es*v*v),r=g>=h?o/g-y:g<=-h?o/-g-y:M/v+y*(this.es-1),_===!1&&(n=Math.atan(v/g)),t.x=e,t.y=n,t.z=r,t},geocentric_to_wgs84:function(t){if(this.datum_type===n)t.x+=this.datum_params[0],t.y+=this.datum_params[1],t.z+=this.datum_params[2];else if(this.datum_type===r){var e=this.datum_params[0],i=this.datum_params[1],o=this.datum_params[2],a=this.datum_params[3],s=this.datum_params[4],u=this.datum_params[5],l=this.datum_params[6],h=l*(t.x-u*t.y+s*t.z)+e,c=l*(u*t.x+t.y-a*t.z)+i,d=l*(-s*t.x+a*t.y+t.z)+o;t.x=h,t.y=c,t.z=d}},geocentric_from_wgs84:function(t){if(this.datum_type===n)t.x-=this.datum_params[0],t.y-=this.datum_params[1],t.z-=this.datum_params[2];else if(this.datum_type===r){var e=this.datum_params[0],i=this.datum_params[1],o=this.datum_params[2],a=this.datum_params[3],s=this.datum_params[4],u=this.datum_params[5],l=this.datum_params[6],h=(t.x-e)/l,c=(t.y-i)/l,d=(t.z-o)/l;t.x=h+u*c-s*d,t.y=-u*h+c+a*d,t.z=s*h-a*c+d}}},t.exports=c},function(t,e,i){var n=.017453292519943295,r=57.29577951308232,o=1,a=2,s=i(172),u=i(173),l=i(150),h=i(174);t.exports=function c(t,e,i){function d(t,e){return(t.datum.datum_type===o||t.datum.datum_type===a)&&"WGS84"!==e.datumCode}var f;return Array.isArray(i)&&(i=h(i)),t.datum&&e.datum&&(d(t,e)||d(e,t))&&(f=new l("WGS84"),c(t,f,i),t=f),"enu"!==t.axis&&u(t,!1,i),"longlat"===t.projName?(i.x*=n,i.y*=n):(t.to_meter&&(i.x*=t.to_meter,i.y*=t.to_meter),t.inverse(i)),t.from_greenwich&&(i.x+=t.from_greenwich),i=s(t.datum,e.datum,i),e.from_greenwich&&(i.x-=e.from_greenwich),"longlat"===e.projName?(i.x*=r,i.y*=r):(e.forward(i),e.to_meter&&(i.x/=e.to_meter,i.y/=e.to_meter)),"enu"!==e.axis&&u(e,!0,i),i}},function(t,e){var i=1,n=2,r=3,o=5,a=6378137,s=.006694379990141316;t.exports=function(t,e,u){function l(t){return t===i||t===n}var h,c,d;if(t.compare_datums(e))return u;if(t.datum_type===o||e.datum_type===o)return u;var f=t.a,p=t.es,m=e.a,v=e.es,g=t.datum_type;if(g===r)if(0===this.apply_gridshift(t,0,u))t.a=a,t.es=s;else{if(!t.datum_params)return t.a=f,t.es=t.es,u;for(h=1,c=0,d=t.datum_params.length;c<d;c++)h*=t.datum_params[c];if(0===h)return t.a=f,t.es=t.es,u;g=t.datum_params.length>3?n:i}return e.datum_type===r&&(e.a=a,e.es=s),(t.es!==e.es||t.a!==e.a||l(g)||l(e.datum_type))&&(t.geodetic_to_geocentric(u),l(t.datum_type)&&t.geocentric_to_wgs84(u),l(e.datum_type)&&e.geocentric_from_wgs84(u),e.geocentric_to_geodetic(u)),e.datum_type===r&&this.apply_gridshift(e,1,u),t.a=f,t.es=p,e.a=m,e.es=v,u}},function(t,e){t.exports=function(t,e,i){var n,r,o,a=i.x,s=i.y,u=i.z||0;for(o=0;o<3;o++)if(!e||2!==o||void 0!==i.z)switch(0===o?(n=a,r="x"):1===o?(n=s,r="y"):(n=u,r="z"),t.axis[o]){case"e":i[r]=n;break;case"w":i[r]=-n;break;case"n":i[r]=n;break;case"s":i[r]=-n;break;case"u":void 0!==i[r]&&(i.z=n);break;case"d":void 0!==i[r]&&(i.z=-n);break;default:return null}return i}},function(t,e){t.exports=function(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}},function(t,e,i){function n(t,e,i){if(!(this instanceof n))return new n(t,e,i);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&"undefined"==typeof e){var r=t.split(",");this.x=parseFloat(r[0],10),this.y=parseFloat(r[1],10),this.z=parseFloat(r[2],10)||0}else this.x=t,this.y=e,this.z=i||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var r=i(176);n.fromMGRS=function(t){return new n(r.toPoint(t))},n.prototype.toMGRS=function(t){return r.forward([this.x,this.y],t)},t.exports=n},function(t,e){function i(t){return t*(Math.PI/180)}function n(t){return 180*(t/Math.PI)}function r(t){var e,n,r,o,s,u,l,h,c,d=t.lat,f=t.lon,p=6378137,m=.00669438,v=.9996,g=i(d),y=i(f);c=Math.floor((f+180)/6)+1,180===f&&(c=60),d>=56&&d<64&&f>=3&&f<12&&(c=32),d>=72&&d<84&&(f>=0&&f<9?c=31:f>=9&&f<21?c=33:f>=21&&f<33?c=35:f>=33&&f<42&&(c=37)),e=6*(c-1)-180+3,h=i(e),n=m/(1-m),r=p/Math.sqrt(1-m*Math.sin(g)*Math.sin(g)),o=Math.tan(g)*Math.tan(g),s=n*Math.cos(g)*Math.cos(g),u=Math.cos(g)*(y-h),l=p*((1-m/4-3*m*m/64-5*m*m*m/256)*g-(3*m/8+3*m*m/32+45*m*m*m/1024)*Math.sin(2*g)+(15*m*m/256+45*m*m*m/1024)*Math.sin(4*g)-35*m*m*m/3072*Math.sin(6*g));var x=v*r*(u+(1-o+s)*u*u*u/6+(5-18*o+o*o+72*s-58*n)*u*u*u*u*u/120)+5e5,_=v*(l+r*Math.tan(g)*(u*u/2+(5-o+9*s+4*s*s)*u*u*u*u/24+(61-58*o+o*o+600*s-330*n)*u*u*u*u*u*u/720));return d<0&&(_+=1e7),{northing:Math.round(_),easting:Math.round(x),zoneNumber:c,zoneLetter:a(d)}}function o(t){var e=t.northing,i=t.easting,r=t.zoneLetter,a=t.zoneNumber;if(a<0||a>60)return null;var s,u,l,h,c,d,f,p,m,v,g=.9996,y=6378137,x=.00669438,_=(1-Math.sqrt(1-x))/(1+Math.sqrt(1-x)),b=i-5e5,w=e;r<"N"&&(w-=1e7),p=6*(a-1)-180+3,s=x/(1-x),f=w/g,m=f/(y*(1-x/4-3*x*x/64-5*x*x*x/256)),v=m+(3*_/2-27*_*_*_/32)*Math.sin(2*m)+(21*_*_/16-55*_*_*_*_/32)*Math.sin(4*m)+151*_*_*_/96*Math.sin(6*m),u=y/Math.sqrt(1-x*Math.sin(v)*Math.sin(v)),l=Math.tan(v)*Math.tan(v),h=s*Math.cos(v)*Math.cos(v),c=y*(1-x)/Math.pow(1-x*Math.sin(v)*Math.sin(v),1.5),d=b/(u*g);var M=v-u*Math.tan(v)/c*(d*d/2-(5+3*l+10*h-4*h*h-9*s)*d*d*d*d/24+(61+90*l+298*h+45*l*l-252*s-3*h*h)*d*d*d*d*d*d/720);M=n(M);var T=(d-(1+2*l+h)*d*d*d/6+(5-2*h+28*l-3*h*h+8*s+24*l*l)*d*d*d*d*d/120)/Math.cos(v);T=p+n(T);var A;if(t.accuracy){var E=o({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});A={top:E.lat,right:E.lon,bottom:M,left:T}}else A={lat:M,lon:T};return A}function a(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function s(t,e){var i="00000"+t.easting,n="00000"+t.northing;return t.zoneNumber+t.zoneLetter+u(t.easting,t.northing,t.zoneNumber)+i.substr(i.length-5,e)+n.substr(n.length-5,e)}function u(t,e,i){var n=l(i),r=Math.floor(t/1e5),o=Math.floor(e/1e5)%20;return h(r,o,n)}function l(t){var e=t%m;return 0===e&&(e=m),e}function h(t,e,i){var n=i-1,r=v.charCodeAt(n),o=g.charCodeAt(n),a=r+t-1,s=o+e,u=!1;a>w&&(a=a-w+y-1,u=!0),(a===x||r<x&&a>x||(a>x||r<x)&&u)&&a++,(a===_||r<_&&a>_||(a>_||r<_)&&u)&&(a++,a===x&&a++),a>w&&(a=a-w+y-1),s>b?(s=s-b+y-1,u=!0):u=!1,(s===x||o<x&&s>x||(s>x||o<x)&&u)&&s++,(s===_||o<_&&s>_||(s>_||o<_)&&u)&&(s++,s===x&&s++),s>b&&(s=s-b+y-1);var l=String.fromCharCode(a)+String.fromCharCode(s);return l}function c(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,i=t.length,n=null,r="",o=0;!/[A-Z]/.test(e=t.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+t;r+=e,o++}var a=parseInt(r,10);if(0===o||o+3>i)throw"MGRSPoint bad conversion from: "+t;var s=t.charAt(o++);if(s<="A"||"B"===s||"Y"===s||s>="Z"||"I"===s||"O"===s)throw"MGRSPoint zone letter "+s+" not handled: "+t;n=t.substring(o,o+=2);for(var u=l(a),h=d(n.charAt(0),u),c=f(n.charAt(1),u);c<p(s);)c+=2e6;var m=i-o;if(m%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var v,g,y,x,_,b=m/2,w=0,M=0;return b>0&&(v=1e5/Math.pow(10,b),g=t.substring(o,o+b),w=parseFloat(g)*v,y=t.substring(o+b),M=parseFloat(y)*v),x=w+h,_=M+c,{easting:x,northing:_,zoneLetter:s,zoneNumber:a,accuracy:v}}function d(t,e){for(var i=v.charCodeAt(e-1),n=1e5,r=!1;i!==t.charCodeAt(0);){if(i++,i===x&&i++,i===_&&i++,i>w){if(r)throw"Bad character: "+t;i=y,r=!0}n+=1e5}return n}function f(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var i=g.charCodeAt(e-1),n=0,r=!1;i!==t.charCodeAt(0);){if(i++,i===x&&i++,i===_&&i++,i>b){if(r)throw"Bad character: "+t;i=y,r=!0}n+=1e5}return n}function p(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}var m=6,v="AJSAJS",g="AFAFAF",y=65,x=73,_=79,b=86,w=90;e.forward=function(t,e){return e=e||5,s(r({lat:t[1],lon:t[0]}),e)},e.inverse=function(t){var e=o(c(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},e.toPoint=function(t){var e=o(c(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}},function(t,e){t.exports={_args:[[{raw:"proj4@^2.3.14",scope:null,escapedName:"proj4",name:"proj4",rawSpec:"^2.3.14",spec:">=2.3.14 <3.0.0",type:"range"},"/Users/jbeezley/git/geojs2"]],_from:"proj4@>=2.3.14 <3.0.0",_id:"proj4@2.3.14",_inCache:!0,_installable:!0,_location:"/proj4",_nodeVersion:"4.2.6",_npmOperationalInternal:{host:"packages-13-west.internal.npmjs.com",tmp:"tmp/proj4-2.3.14.tgz_1457689264880_0.9409773757215589"},_npmUser:{name:"ahocevar",email:"andreas.hocevar@gmail.com"},_npmVersion:"2.14.12",_phantomChildren:{},_requested:{raw:"proj4@^2.3.14",scope:null,escapedName:"proj4",name:"proj4",rawSpec:"^2.3.14",spec:">=2.3.14 <3.0.0",type:"range"},_requiredBy:["#DEV:/"],_resolved:"https://registry.npmjs.org/proj4/-/proj4-2.3.14.tgz",_shasum:"928906144388980c914c5a357fc493aba59a747a",_shrinkwrap:null,_spec:"proj4@^2.3.14",_where:"/Users/jbeezley/git/geojs2",author:"",bugs:{url:"https://github.com/proj4js/proj4js/issues"},contributors:[{name:"Mike Adair",email:"madair@dmsolutions.ca"},{name:"Richard Greenwood",email:"rich@greenwoodmap.com"},{name:"Calvin Metcalf",email:"calvin.metcalf@gmail.com"},{name:"Richard Marsden",url:"http://www.winwaed.com"},{name:"T. Mittan"},{name:"D. Steinwand"},{name:"S. Nelson"}],dependencies:{mgrs:"~0.0.2"},description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",devDependencies:{browserify:"~12.0.1",chai:"~1.8.1",curl:"git://github.com/cujojs/curl.git",grunt:"~0.4.2","grunt-browserify":"~4.0.1","grunt-cli":"~0.1.13","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0","grunt-contrib-uglify":"~0.11.1","grunt-mocha-phantomjs":"~0.4.0",istanbul:"~0.2.4",mocha:"~1.17.1",tin:"~0.4.0"},directories:{test:"test",doc:"docs"},dist:{shasum:"928906144388980c914c5a357fc493aba59a747a",tarball:"http://registry.npmjs.org/proj4/-/proj4-2.3.14.tgz"},gitHead:"7619c8a63df1eae5bad0b9ad31ca1d87b0549243",homepage:"https://github.com/proj4js/proj4js#readme",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},license:"MIT",main:"lib/index.js",maintainers:[{name:"cwmma",email:"calvin.metcalf@gmail.com"},{name:"ahocevar",email:"andreas.hocevar@gmail.com"}],name:"proj4",optionalDependencies:{},readme:"ERROR: No README data found!",repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},version:"2.3.14"}},function(t,e,i){var n=[i(179),i(186),i(187),i(190),i(191),i(192),i(193),i(194),i(195),i(199),i(201),i(202),i(203),i(205),i(206),i(207),i(208),i(209),i(213),i(214),i(215),i(216)];t.exports=function(t){n.forEach(function(e){t.Proj.projections.add(e)})}},function(t,e,i){var n=i(180),r=i(181),o=i(182),a=i(183),s=i(184),u=i(162),l=Math.PI/2,h=1e-10,c=i(163),d=i(185);e.init=function(){this.e0=n(this.es),this.e1=r(this.es),this.e2=o(this.es),this.e3=a(this.es),this.ml0=this.a*s(this.e0,this.e1,this.e2,this.e3,this.lat0)},e.forward=function(t){var e,i,n,r=t.x,o=t.y,a=u(r-this.long0),l=Math.sin(o),h=Math.cos(o);if(this.sphere){var c=h*Math.sin(a);if(Math.abs(Math.abs(c)-1)<1e-10)return 93;i=.5*this.a*this.k0*Math.log((1+c)/(1-c)),e=Math.acos(h*Math.cos(a)/Math.sqrt(1-c*c)),o<0&&(e=-e),n=this.a*this.k0*(e-this.lat0)}else{var d=h*a,f=Math.pow(d,2),p=this.ep2*Math.pow(h,2),m=Math.tan(o),v=Math.pow(m,2);e=1-this.es*Math.pow(l,2);var g=this.a/Math.sqrt(e),y=this.a*s(this.e0,this.e1,this.e2,this.e3,o);i=this.k0*g*d*(1+f/6*(1-v+p+f/20*(5-18*v+Math.pow(v,2)+72*p-58*this.ep2)))+this.x0,n=this.k0*(y-this.ml0+g*m*(f*(.5+f/24*(5-v+9*p+4*Math.pow(p,2)+f/30*(61-58*v+Math.pow(v,2)+600*p-330*this.ep2)))))+this.y0}return t.x=i,t.y=n,t},e.inverse=function(t){var e,i,n,r,o,a,s=6;if(this.sphere){var f=Math.exp(t.x/(this.a*this.k0)),p=.5*(f-1/f),m=this.lat0+t.y/(this.a*this.k0),v=Math.cos(m);e=Math.sqrt((1-v*v)/(1+p*p)),o=d(e),m<0&&(o=-o),a=0===p&&0===v?this.long0:u(Math.atan2(p,v)+this.long0)}else{var g=t.x-this.x0,y=t.y-this.y0;for(e=(this.ml0+y/this.k0)/this.a,i=e,r=0;!0&&(n=(e+this.e1*Math.sin(2*i)-this.e2*Math.sin(4*i)+this.e3*Math.sin(6*i))/this.e0-i,i+=n,!(Math.abs(n)<=h));r++)if(r>=s)return 95;if(Math.abs(i)<l){var x=Math.sin(i),_=Math.cos(i),b=Math.tan(i),w=this.ep2*Math.pow(_,2),M=Math.pow(w,2),T=Math.pow(b,2),A=Math.pow(T,2);e=1-this.es*Math.pow(x,2);var E=this.a/Math.sqrt(e),C=E*(1-this.es)/e,S=g/(E*this.k0),R=Math.pow(S,2);o=i-E*b*R/C*(.5-R/24*(5+3*T+10*w-4*M-9*this.ep2-R/30*(61+90*T+298*w+45*A-252*this.ep2-3*M))),a=u(this.long0+S*(1-R/6*(1+2*T+w-R/20*(5-2*w+28*T-3*M+8*this.ep2+24*A)))/_)}else o=l*c(y),a=this.long0}return t.x=a,t.y=o,t},e.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},function(t,e){t.exports=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))}},function(t,e){t.exports=function(t){return.375*t*(1+.25*t*(1+.46875*t))}},function(t,e){t.exports=function(t){return.05859375*t*t*(1+.75*t)}},function(t,e){t.exports=function(t){return t*t*t*(35/3072)}},function(t,e){t.exports=function(t,e,i,n,r){return t*r-e*Math.sin(2*r)+i*Math.sin(4*r)-n*Math.sin(6*r)}},function(t,e){t.exports=function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}},function(t,e,i){var n=.017453292519943295,r=i(179);e.dependsOn="tmerc",e.init=function(){this.zone&&(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*n,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,r.init.apply(this),this.forward=r.forward,this.inverse=r.inverse)},e.names=["Universal Transverse Mercator System","utm"]},function(t,e,i){var n=i(188),r=i(162);e.init=function(){n.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},e.forward=function(t){var e,i,o,a;return t.x=r(t.x-this.long0),n.forward.apply(this,[t]),e=Math.sin(t.y),i=Math.cos(t.y),o=Math.cos(t.x),a=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*i*o),t.x=a*i*Math.sin(t.x),t.y=a*(this.cosc0*e-this.sinc0*i*o),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},e.inverse=function(t){var e,i,o,a,s;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,s=Math.sqrt(t.x*t.x+t.y*t.y)){var u=2*Math.atan2(s,this.R2);e=Math.sin(u),i=Math.cos(u),a=Math.asin(i*this.sinc0+t.y*e*this.cosc0/s),o=Math.atan2(t.x*e,s*this.cosc0*i-t.y*this.sinc0*e)}else a=this.phic0,o=0;return t.x=o,t.y=a,n.inverse.apply(this,[t]),t.x=r(t.x+this.long0),t},e.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},function(t,e,i){var n=Math.PI/4,r=i(189),o=Math.PI/2,a=20;e.init=function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+n)/(Math.pow(Math.tan(.5*this.lat0+n),this.C)*r(this.e*t,this.ratexp))},e.forward=function(t){var e=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+n),this.C)*r(this.e*Math.sin(i),this.ratexp))-o,t.x=this.C*e,t},e.inverse=function(t){for(var e=1e-14,i=t.x/this.C,s=t.y,u=Math.pow(Math.tan(.5*s+n)/this.K,1/this.C),l=a;l>0&&(s=2*Math.atan(u*r(this.e*Math.sin(t.y),-.5*this.e))-o,!(Math.abs(s-t.y)<e));--l)t.y=s;return l?(t.x=i,t.y=s,t):null},e.names=["gauss"]},function(t,e){t.exports=function(t,e){return Math.pow((1-t)/(1+t),e)}},function(t,e,i){var n=Math.PI/2,r=1e-10,o=i(163),a=i(161),s=i(164),u=i(165),l=i(162);e.ssfn_=function(t,e,i){return e*=i,Math.tan(.5*(n+t))*Math.pow((1-e)/(1+e),.5*i)},e.init=function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=r&&(this.k0=.5*(1+o(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=r&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=r&&(this.k0=.5*this.cons*a(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/s(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=a(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-n,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},e.forward=function(t){var e,i,o,a,u,h,c=t.x,d=t.y,f=Math.sin(d),p=Math.cos(d),m=l(c-this.long0);return Math.abs(Math.abs(c-this.long0)-Math.PI)<=r&&Math.abs(d+this.lat0)<=r?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*f+this.coslat0*p*Math.cos(m)),t.x=this.a*e*p*Math.sin(m)+this.x0,t.y=this.a*e*(this.coslat0*f-this.sinlat0*p*Math.cos(m))+this.y0,t):(i=2*Math.atan(this.ssfn_(d,f,this.e))-n,a=Math.cos(i),o=Math.sin(i),Math.abs(this.coslat0)<=r?(u=s(this.e,d*this.con,this.con*f),h=2*this.a*this.k0*u/this.cons,t.x=this.x0+h*Math.sin(c-this.long0),t.y=this.y0-this.con*h*Math.cos(c-this.long0),t):(Math.abs(this.sinlat0)<r?(e=2*this.a*this.k0/(1+a*Math.cos(m)),t.y=e*o):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*a*Math.cos(m))),t.y=e*(this.cosX0*o-this.sinX0*a*Math.cos(m))+this.y0),t.x=e*a*Math.sin(m)+this.x0,t))},e.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,i,o,a,s,h=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var c=2*Math.atan(h/(.5*this.a*this.k0));return e=this.long0,i=this.lat0,h<=r?(t.x=e,t.y=i,t):(i=Math.asin(Math.cos(c)*this.sinlat0+t.y*Math.sin(c)*this.coslat0/h),e=l(Math.abs(this.coslat0)<r?this.lat0>0?this.long0+Math.atan2(t.x,-1*t.y):this.long0+Math.atan2(t.x,t.y):this.long0+Math.atan2(t.x*Math.sin(c),h*this.coslat0*Math.cos(c)-t.y*this.sinlat0*Math.sin(c))),t.x=e,t.y=i,t)}if(Math.abs(this.coslat0)<=r){if(h<=r)return i=this.lat0,e=this.long0,t.x=e,t.y=i,t;t.x*=this.con,t.y*=this.con,o=h*this.cons/(2*this.a*this.k0),i=this.con*u(this.e,o),e=this.con*l(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else a=2*Math.atan(h*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,h<=r?s=this.X0:(s=Math.asin(Math.cos(a)*this.sinX0+t.y*Math.sin(a)*this.cosX0/h),e=l(this.long0+Math.atan2(t.x*Math.sin(a),h*this.cosX0*Math.cos(a)-t.y*this.sinX0*Math.sin(a)))),i=-1*u(this.e,Math.tan(.5*(n+s)));
return t.x=e,t.y=i,t},e.names=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"]},function(t,e){e.init=function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),i=this.a,n=this.rf,r=1/n,o=2*r-Math.pow(r,2),a=this.e=Math.sqrt(o);this.R=this.k0*i*Math.sqrt(1-o)/(1-o*Math.pow(e,2)),this.alpha=Math.sqrt(1+o/(1-o)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),u=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+a*e)/(1-a*e));this.K=s-this.alpha*u+this.alpha*a/2*l},e.forward=function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),n=-this.alpha*(e+i)+this.K,r=2*(Math.atan(Math.exp(n))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),a=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(o))),s=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,t.x=this.R*a+this.x0,t},e.inverse=function(t){for(var e=t.x-this.x0,i=t.y-this.y0,n=e/this.R,r=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(n)),a=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(r))),s=this.lambda0+a/this.alpha,u=0,l=o,h=-1e3,c=0;Math.abs(l-h)>1e-7;){if(++c>20)return;u=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),h=l,l=2*Math.atan(Math.exp(u))-Math.PI/2}return t.x=s,t.y=l,t},e.names=["somerc"]},function(t,e,i){var n=i(164),r=i(162),o=i(165),a=Math.PI/2,s=Math.PI/4,u=1e-10;e.init=function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var t=Math.sin(this.lat0),e=Math.cos(this.lat0),i=this.e*t;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(e,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-i*i);var o=n(this.e,this.lat0,t),a=this.bl/e*Math.sqrt((1-this.es)/(1-i*i));a*a<1&&(a=1);var s,u;if(isNaN(this.longc)){var l=n(this.e,this.lat1,Math.sin(this.lat1)),h=n(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(a+Math.sqrt(a*a-1))*Math.pow(o,this.bl):this.el=(a-Math.sqrt(a*a-1))*Math.pow(o,this.bl);var c=Math.pow(l,this.bl),d=Math.pow(h,this.bl);s=this.el/c,u=.5*(s-1/s);var f=(this.el*this.el-d*c)/(this.el*this.el+d*c),p=(d-c)/(d+c),m=r(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(f*Math.tan(.5*this.bl*m)/p)/this.bl,this.long0=r(this.long0);var v=r(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*v)/u),this.alpha=Math.asin(a*Math.sin(this.gamma0))}else s=this.lat0>=0?a+Math.sqrt(a*a-1):a-Math.sqrt(a*a-1),this.el=s*Math.pow(o,this.bl),u=.5*(s-1/s),this.gamma0=Math.asin(Math.sin(this.alpha)/a),this.long0=this.longc-Math.asin(u*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha))},e.forward=function(t){var e,i,o,l=t.x,h=t.y,c=r(l-this.long0);if(Math.abs(Math.abs(h)-a)<=u)o=h>0?-1:1,i=this.al/this.bl*Math.log(Math.tan(s+o*this.gamma0*.5)),e=-1*o*a*this.al/this.bl;else{var d=n(this.e,h,Math.sin(h)),f=this.el/Math.pow(d,this.bl),p=.5*(f-1/f),m=.5*(f+1/f),v=Math.sin(this.bl*c),g=(p*Math.sin(this.gamma0)-v*Math.cos(this.gamma0))/m;i=Math.abs(Math.abs(g)-1)<=u?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-g)/(1+g))/this.bl,e=Math.abs(Math.cos(this.bl*c))<=u?this.al*this.bl*c:this.al*Math.atan2(p*Math.cos(this.gamma0)+v*Math.sin(this.gamma0),Math.cos(this.bl*c))/this.bl}return this.no_rot?(t.x=this.x0+e,t.y=this.y0+i):(e-=this.uc,t.x=this.x0+i*Math.cos(this.alpha)+e*Math.sin(this.alpha),t.y=this.y0+e*Math.cos(this.alpha)-i*Math.sin(this.alpha)),t},e.inverse=function(t){var e,i;this.no_rot?(i=t.y-this.y0,e=t.x-this.x0):(i=(t.x-this.x0)*Math.cos(this.alpha)-(t.y-this.y0)*Math.sin(this.alpha),e=(t.y-this.y0)*Math.cos(this.alpha)+(t.x-this.x0)*Math.sin(this.alpha),e+=this.uc);var n=Math.exp(-1*this.bl*i/this.al),s=.5*(n-1/n),l=.5*(n+1/n),h=Math.sin(this.bl*e/this.al),c=(h*Math.cos(this.gamma0)+s*Math.sin(this.gamma0))/l,d=Math.pow(this.el/Math.sqrt((1+c)/(1-c)),1/this.bl);return Math.abs(c-1)<u?(t.x=this.long0,t.y=a):Math.abs(c+1)<u?(t.x=this.long0,t.y=-1*a):(t.y=o(this.e,d),t.x=r(this.long0-Math.atan2(s*Math.cos(this.gamma0)-h*Math.sin(this.gamma0),Math.cos(this.bl*e/this.al))/this.bl)),t},e.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},function(t,e,i){var n=1e-10,r=i(161),o=i(164),a=Math.PI/2,s=i(163),u=i(162),l=i(165);e.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<n)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),i=Math.cos(this.lat1),a=r(this.e,e,i),s=o(this.e,this.lat1,e),u=Math.sin(this.lat2),l=Math.cos(this.lat2),h=r(this.e,u,l),c=o(this.e,this.lat2,u),d=o(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>n?this.ns=Math.log(a/h)/Math.log(s/c):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=a/(this.ns*Math.pow(s,this.ns)),this.rh=this.a*this.f0*Math.pow(d,this.ns),this.title||(this.title="Lambert Conformal Conic")}},e.forward=function(t){var e=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=n&&(i=s(i)*(a-2*n));var r,l,h=Math.abs(Math.abs(i)-a);if(h>n)r=o(this.e,i,Math.sin(i)),l=this.a*this.f0*Math.pow(r,this.ns);else{if(h=i*this.ns,h<=0)return null;l=0}var c=this.ns*u(e-this.long0);return t.x=this.k0*(l*Math.sin(c))+this.x0,t.y=this.k0*(this.rh-l*Math.cos(c))+this.y0,t},e.inverse=function(t){var e,i,n,r,o,s=(t.x-this.x0)/this.k0,h=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(s*s+h*h),i=1):(e=-Math.sqrt(s*s+h*h),i=-1);var c=0;if(0!==e&&(c=Math.atan2(i*s,i*h)),0!==e||this.ns>0){if(i=1/this.ns,n=Math.pow(e/(this.a*this.f0),i),r=l(this.e,n),r===-9999)return null}else r=-a;return o=u(c/this.ns+this.long0),t.x=o,t.y=r,t},e.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},function(t,e,i){var n=i(162);e.init=function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},e.forward=function(t){var e,i,r,o,a,s,u,l=t.x,h=t.y,c=n(l-this.long0);return e=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/e)-this.s45),r=-c*this.alfa,o=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),a=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(o)),s=this.n*a,u=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(o/2+this.s45),this.n),t.y=u*Math.cos(s)/1,t.x=u*Math.sin(s)/1,this.czech||(t.y*=-1,t.x*=-1),t},e.inverse=function(t){var e,i,n,r,o,a,s,u,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),a=Math.sqrt(t.x*t.x+t.y*t.y),o=Math.atan2(t.y,t.x),r=o/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),i=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(e)),t.x=this.long0-i/this.alfa,s=e,u=0;var h=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-t.y)<1e-10&&(u=1),s=t.y,h+=1;while(0===u&&h<15);return h>=15?null:t},e.names=["Krovak","krovak"]},function(t,e,i){var n=i(184),r=i(180),o=i(181),a=i(182),s=i(183),u=i(196),l=i(162),h=i(197),c=i(198),d=Math.PI/2,f=1e-10;e.init=function(){this.sphere||(this.e0=r(this.es),this.e1=o(this.es),this.e2=a(this.es),this.e3=s(this.es),this.ml0=this.a*n(this.e0,this.e1,this.e2,this.e3,this.lat0))},e.forward=function(t){var e,i,r=t.x,o=t.y;if(r=l(r-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(o)*Math.sin(r)),i=this.a*(Math.atan2(Math.tan(o),Math.cos(r))-this.lat0);else{var a=Math.sin(o),s=Math.cos(o),h=u(this.a,this.e,a),c=Math.tan(o)*Math.tan(o),d=r*Math.cos(o),f=d*d,p=this.es*s*s/(1-this.es),m=this.a*n(this.e0,this.e1,this.e2,this.e3,o);e=h*d*(1-f*c*(1/6-(8-c+8*p)*f/120)),i=m-this.ml0+h*a/s*f*(.5+(5-c+6*p)*f/24)}return t.x=e+this.x0,t.y=i+this.y0,t},e.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n=t.x/this.a,r=t.y/this.a;if(this.sphere){var o=r+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(n)),i=Math.atan2(Math.tan(n),Math.cos(o))}else{var a=this.ml0/this.a+r,s=c(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-d)<=f)return t.x=this.long0,t.y=d,r<0&&(t.y*=-1),t;var p=u(this.a,this.e,Math.sin(s)),m=p*p*p/this.a/this.a*(1-this.es),v=Math.pow(Math.tan(s),2),g=n*this.a/p,y=g*g;e=s-p*Math.tan(s)/m*g*g*(.5-(1+3*v)*g*g/24),i=g*(1-y*(v/3+(1+3*v)*v*y/15))/Math.cos(s)}return t.x=l(i+this.long0),t.y=h(e),t},e.names=["Cassini","Cassini_Soldner","cass"]},function(t,e){t.exports=function(t,e,i){var n=e*i;return t/Math.sqrt(1-n*n)}},function(t,e,i){var n=Math.PI/2,r=i(163);t.exports=function(t){return Math.abs(t)<n?t:t-r(t)*Math.PI}},function(t,e){t.exports=function(t,e,i,n,r){var o,a;o=t/e;for(var s=0;s<15;s++)if(a=(t-(e*o-i*Math.sin(2*o)+n*Math.sin(4*o)-r*Math.sin(6*o)))/(e-2*i*Math.cos(2*o)+4*n*Math.cos(4*o)-6*r*Math.cos(6*o)),o+=a,Math.abs(a)<=1e-10)return o;return NaN}},function(t,e,i){var n=Math.PI/2,r=Math.PI/4,o=1e-10,a=i(200),s=i(162);e.S_POLE=1,e.N_POLE=2,e.EQUIT=3,e.OBLIQ=4,e.init=function(){var t=Math.abs(this.lat0);if(Math.abs(t-n)<o?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<o?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=a(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=a(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},e.forward=function(t){var e,i,u,l,h,c,d,f,p,m,v=t.x,g=t.y;if(v=s(v-this.long0),this.sphere){if(h=Math.sin(g),m=Math.cos(g),u=Math.cos(v),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(i=this.mode===this.EQUIT?1+m*u:1+this.sinph0*h+this.cosph0*m*u,i<=o)return null;i=Math.sqrt(2/i),e=i*m*Math.sin(v),i*=this.mode===this.EQUIT?h:this.cosph0*h-this.sinph0*m*u}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(u=-u),Math.abs(g+this.phi0)<o)return null;i=r-.5*g,i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)),e=i*Math.sin(v),i*=u}}else{switch(d=0,f=0,p=0,u=Math.cos(v),l=Math.sin(v),h=Math.sin(g),c=a(this.e,h),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(d=c/this.qp,f=Math.sqrt(1-d*d)),this.mode){case this.OBLIQ:p=1+this.sinb1*d+this.cosb1*f*u;break;case this.EQUIT:p=1+f*u;break;case this.N_POLE:p=n+g,c=this.qp-c;break;case this.S_POLE:p=g-n,c=this.qp+c}if(Math.abs(p)<o)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:p=Math.sqrt(2/p),i=this.mode===this.OBLIQ?this.ymf*p*(this.cosb1*d-this.sinb1*f*u):(p=Math.sqrt(2/(1+f*u)))*d*this.ymf,e=this.xmf*p*f*l;break;case this.N_POLE:case this.S_POLE:c>=0?(e=(p=Math.sqrt(c))*l,i=u*(this.mode===this.S_POLE?p:-p)):e=i=0}}return t.x=this.a*e+this.x0,t.y=this.a*i+this.y0,t},e.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,i,r,a,u,l,h,c=t.x/this.a,d=t.y/this.a;if(this.sphere){var f,p=0,m=0;if(f=Math.sqrt(c*c+d*d),i=.5*f,i>1)return null;switch(i=2*Math.asin(i),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(m=Math.sin(i),p=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(f)<=o?0:Math.asin(d*m/f),c*=m,d=p*f;break;case this.OBLIQ:i=Math.abs(f)<=o?this.phi0:Math.asin(p*this.sinph0+d*m*this.cosph0/f),c*=m*this.cosph0,d=(p-Math.sin(i)*this.sinph0)*f;break;case this.N_POLE:d=-d,i=n-i;break;case this.S_POLE:i-=n}e=0!==d||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(c,d):0}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c/=this.dd,d*=this.dd,l=Math.sqrt(c*c+d*d),l<o)return t.x=0,t.y=this.phi0,t;a=2*Math.asin(.5*l/this.rq),r=Math.cos(a),c*=a=Math.sin(a),this.mode===this.OBLIQ?(h=r*this.sinb1+d*a*this.cosb1/l,u=this.qp*h,d=l*this.cosb1*r-d*this.sinb1*a):(h=d*a/l,u=this.qp*h,d=l*r)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(d=-d),u=c*c+d*d,!u)return t.x=0,t.y=this.phi0,t;h=1-u/this.qp,this.mode===this.S_POLE&&(h=-h)}e=Math.atan2(c,d),i=this.authlat(Math.asin(h),this.apa)}return t.x=s(this.long0+e),t.y=i,t},e.P00=.3333333333333333,e.P01=.17222222222222222,e.P02=.10257936507936508,e.P10=.06388888888888888,e.P11=.0664021164021164,e.P20=.016415012942191543,e.authset=function(t){var e,i=[];return i[0]=t*this.P00,e=t*t,i[0]+=e*this.P01,i[1]=e*this.P10,e*=t,i[0]+=e*this.P02,i[1]+=e*this.P11,i[2]=e*this.P20,i},e.authlat=function(t,e){var i=t+t;return t+e[0]*Math.sin(i)+e[1]*Math.sin(i+i)+e[2]*Math.sin(i+i+i)},e.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},function(t,e){t.exports=function(t,e){var i;return t>1e-7?(i=t*e,(1-t*t)*(e/(1-i*i)-.5/t*Math.log((1-i)/(1+i)))):2*e}},function(t,e,i){var n=1e-10,r=i(161),o=i(200),a=i(162),s=i(185);e.init=function(){Math.abs(this.lat1+this.lat2)<n||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=r(this.e3,this.sin_po,this.cos_po),this.qs1=o(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=r(this.e3,this.sin_po,this.cos_po),this.qs2=o(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=o(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>n?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},e.forward=function(t){var e=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var n=o(this.e3,this.sin_phi,this.cos_phi),r=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,s=this.ns0*a(e-this.long0),u=r*Math.sin(s)+this.x0,l=this.rh-r*Math.cos(s)+this.y0;return t.x=u,t.y=l,t},e.inverse=function(t){var e,i,n,r,o,s;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),n=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),n=-1),r=0,0!==e&&(r=Math.atan2(n*t.x,n*t.y)),n=e*this.ns0/this.a,this.sphere?s=Math.asin((this.c-n*n)/(2*this.ns0)):(i=(this.c-n*n)/this.ns0,s=this.phi1z(this.e3,i)),o=a(r/this.ns0+this.long0),t.x=o,t.y=s,t},e.phi1z=function(t,e){var i,r,o,a,u,l=s(.5*e);if(t<n)return l;for(var h=t*t,c=1;c<=25;c++)if(i=Math.sin(l),r=Math.cos(l),o=t*i,a=1-o*o,u=.5*a*a/r*(e/(1-h)-i/a+.5/t*Math.log((1-o)/(1+o))),l+=u,Math.abs(u)<=1e-7)return l;return null},e.names=["Albers_Conic_Equal_Area","Albers","aea"]},function(t,e,i){var n=i(162),r=1e-10,o=i(185);e.init=function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},e.forward=function(t){var e,i,o,a,s,u,l,h,c=t.x,d=t.y;return o=n(c-this.long0),e=Math.sin(d),i=Math.cos(d),a=Math.cos(o),u=this.sin_p14*e+this.cos_p14*i*a,s=1,u>0||Math.abs(u)<=r?(l=this.x0+this.a*s*i*Math.sin(o)/u,h=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*i*a)/u):(l=this.x0+this.infinity_dist*i*Math.sin(o),h=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*i*a)),t.x=l,t.y=h,t},e.inverse=function(t){var e,i,r,a,s,u;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(a=Math.atan2(e,this.rc),i=Math.sin(a),r=Math.cos(a),u=o(r*this.sin_p14+t.y*i*this.cos_p14/e),s=Math.atan2(t.x*i,e*this.cos_p14*r-t.y*this.sin_p14*i),s=n(this.long0+s)):(u=this.phic0,s=0),t.x=s,t.y=u,t},e.names=["gnom"]},function(t,e,i){var n=i(162),r=i(200),o=i(161),a=i(204);e.init=function(){this.sphere||(this.k0=o(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},e.forward=function(t){var e,i,o=t.x,a=t.y,s=n(o-this.long0);if(this.sphere)e=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(a)/Math.cos(this.lat_ts);else{var u=r(this.e,Math.sin(a));e=this.x0+this.a*this.k0*s,i=this.y0+this.a*u*.5/this.k0}return t.x=e,t.y=i,t},e.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,i;return this.sphere?(e=n(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=a(this.e,2*t.y*this.k0/this.a),e=n(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=i,t},e.names=["cea"]},function(t,e){var i=Math.PI/2;t.exports=function(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*i:i;for(var r,o,a,s,u=Math.asin(.5*e),l=0;l<30;l++)if(o=Math.sin(u),a=Math.cos(u),s=t*o,r=Math.pow(1-s*s,2)/(2*a)*(e/(1-t*t)-o/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),u+=r,Math.abs(r)<=1e-10)return u;return NaN}},function(t,e,i){var n=i(162),r=i(197);e.init=function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},e.forward=function(t){var e=t.x,i=t.y,o=n(e-this.long0),a=r(i-this.lat0);return t.x=this.x0+this.a*o*this.rc,t.y=this.y0+this.a*a,t},e.inverse=function(t){var e=t.x,i=t.y;return t.x=n(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=r(this.lat0+(i-this.y0)/this.a),t},e.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},function(t,e,i){var n=i(180),r=i(181),o=i(182),a=i(183),s=i(162),u=i(197),l=i(184),h=1e-10,c=i(196),d=20;e.init=function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=n(this.es),this.e1=r(this.es),this.e2=o(this.es),this.e3=a(this.es),this.ml0=this.a*l(this.e0,this.e1,this.e2,this.e3,this.lat0)},e.forward=function(t){var e,i,n,r=t.x,o=t.y,a=s(r-this.long0);if(n=a*Math.sin(o),this.sphere)Math.abs(o)<=h?(e=this.a*a,i=-1*this.a*this.lat0):(e=this.a*Math.sin(n)/Math.tan(o),i=this.a*(u(o-this.lat0)+(1-Math.cos(n))/Math.tan(o)));else if(Math.abs(o)<=h)e=this.a*a,i=-1*this.ml0;else{var d=c(this.a,this.e,Math.sin(o))/Math.tan(o);e=d*Math.sin(n),i=this.a*l(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+d*(1-Math.cos(n))}return t.x=e+this.x0,t.y=i+this.y0,t},e.inverse=function(t){var e,i,n,r,o,a,u,c,f;if(n=t.x-this.x0,r=t.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=h)e=s(n/this.a+this.long0),i=0;else{a=this.lat0+r/this.a,u=n*n/this.a/this.a+a*a,c=a;var p;for(o=d;o;--o)if(p=Math.tan(c),f=-1*(a*(c*p+1)-c-.5*(c*c+u)*p)/((c-a)/p-1),c+=f,Math.abs(f)<=h){i=c;break}e=s(this.long0+Math.asin(n*Math.tan(c)/this.a)/Math.sin(i))}else if(Math.abs(r+this.ml0)<=h)i=0,e=s(this.long0+n/this.a);else{a=(this.ml0+r)/this.a,u=n*n/this.a/this.a+a*a,c=a;var m,v,g,y,x;for(o=d;o;--o)if(x=this.e*Math.sin(c),m=Math.sqrt(1-x*x)*Math.tan(c),v=this.a*l(this.e0,this.e1,this.e2,this.e3,c),g=this.e0-2*this.e1*Math.cos(2*c)+4*this.e2*Math.cos(4*c)-6*this.e3*Math.cos(6*c),y=v/this.a,f=(a*(m*y+1)-y-.5*m*(y*y+u))/(this.es*Math.sin(2*c)*(y*y+u-2*a*y)/(4*m)+(a-y)*(m*g-2/Math.sin(2*c))-g),c-=f,Math.abs(f)<=h){i=c;break}m=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),e=s(this.long0+Math.asin(n*m/this.a)/Math.sin(i))}return t.x=e,t.y=i,t},e.names=["Polyconic","poly"]},function(t,e){var i=484813681109536e-20;e.iterations=1,e.init=function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},e.forward=function(t){var e,n=t.x,r=t.y,o=r-this.lat0,a=n-this.long0,s=o/i*1e-5,u=a,l=1,h=0;for(e=1;e<=10;e++)l*=s,h+=this.A[e]*l;var c,d,f=h,p=u,m=1,v=0,g=0,y=0;for(e=1;e<=6;e++)c=m*f-v*p,d=v*f+m*p,m=c,v=d,g=g+this.B_re[e]*m-this.B_im[e]*v,y=y+this.B_im[e]*m+this.B_re[e]*v;return t.x=y*this.a+this.x0,t.y=g*this.a+this.y0,t},e.inverse=function(t){var e,n,r,o=t.x,a=t.y,s=o-this.x0,u=a-this.y0,l=u/this.a,h=s/this.a,c=1,d=0,f=0,p=0;for(e=1;e<=6;e++)n=c*l-d*h,r=d*l+c*h,c=n,d=r,f=f+this.C_re[e]*c-this.C_im[e]*d,p=p+this.C_im[e]*c+this.C_re[e]*d;for(var m=0;m<this.iterations;m++){var v,g,y=f,x=p,_=l,b=h;for(e=2;e<=6;e++)v=y*f-x*p,g=x*f+y*p,y=v,x=g,_+=(e-1)*(this.B_re[e]*y-this.B_im[e]*x),b+=(e-1)*(this.B_im[e]*y+this.B_re[e]*x);y=1,x=0;var w=this.B_re[1],M=this.B_im[1];for(e=2;e<=6;e++)v=y*f-x*p,g=x*f+y*p,y=v,x=g,w+=e*(this.B_re[e]*y-this.B_im[e]*x),M+=e*(this.B_im[e]*y+this.B_re[e]*x);var T=w*w+M*M;f=(_*w+b*M)/T,p=(b*w-_*M)/T}var A=f,E=p,C=1,S=0;for(e=1;e<=9;e++)C*=A,S+=this.D[e]*C;var R=this.lat0+S*i*1e5,P=this.long0+E;return t.x=P,t.y=R,t},e.names=["New_Zealand_Map_Grid","nzmg"]},function(t,e,i){var n=i(162);e.init=function(){},e.forward=function(t){var e=t.x,i=t.y,r=n(e-this.long0),o=this.x0+this.a*r,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return t.x=o,t.y=a,t},e.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e=n(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=i,t},e.names=["Miller_Cylindrical","mill"]},function(t,e,i){var n=i(162),r=i(197),o=i(210),a=20,s=i(211),u=i(212),l=Math.PI/2,h=1e-10,c=i(185);e.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=o(this.es)},e.forward=function(t){var e,i,r=t.x,o=t.y;if(r=n(r-this.long0),this.sphere){if(this.m)for(var u=this.n*Math.sin(o),l=a;l;--l){var c=(this.m*o+Math.sin(o)-u)/(this.m+Math.cos(o));if(o-=c,Math.abs(c)<h)break}else o=1!==this.n?Math.asin(this.n*Math.sin(o)):o;e=this.a*this.C_x*r*(this.m+Math.cos(o)),i=this.a*this.C_y*o}else{var d=Math.sin(o),f=Math.cos(o);i=this.a*s(o,d,f,this.en),e=this.a*r*f/Math.sqrt(1-this.es*d*d)}return t.x=e,t.y=i,t},e.inverse=function(t){var e,i,o,a;return t.x-=this.x0,o=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,o/=this.C_x*(this.m+Math.cos(e)),this.m?e=c((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=c(Math.sin(e)/this.n)),o=n(o+this.long0),e=r(e)):(e=u(t.y/this.a,this.es,this.en),a=Math.abs(e),a<l?(a=Math.sin(e),i=this.long0+t.x*Math.sqrt(1-this.es*a*a)/(this.a*Math.cos(e)),o=n(i)):a-h<l&&(o=this.long0)),t.x=o,t.y=e,t},e.names=["Sinusoidal","sinu"]},function(t,e){var i=1,n=.25,r=.046875,o=.01953125,a=.01068115234375,s=.75,u=.46875,l=.013020833333333334,h=.007120768229166667,c=.3645833333333333,d=.005696614583333333,f=.3076171875;t.exports=function(t){var e=[];e[0]=i-t*(n+t*(r+t*(o+t*a))),e[1]=t*(s-t*(r+t*(o+t*a)));var p=t*t;return e[2]=p*(u-t*(l+t*h)),p*=t,e[3]=p*(c-t*d),e[4]=p*t*f,e}},function(t,e){t.exports=function(t,e,i,n){return i*=e,e*=e,n[0]*t-i*(n[1]+e*(n[2]+e*(n[3]+e*n[4])))}},function(t,e,i){var n=i(211),r=1e-10,o=20;t.exports=function(t,e,i){for(var a=1/(1-e),s=t,u=o;u;--u){var l=Math.sin(s),h=1-e*l*l;if(h=(n(s,l,Math.cos(s),i)-t)*(h*Math.sqrt(h))*a,s-=h,Math.abs(h)<r)return s}return s}},function(t,e,i){var n=i(162),r=1e-10;e.init=function(){},e.forward=function(t){for(var e=t.x,i=t.y,o=n(e-this.long0),a=i,s=Math.PI*Math.sin(i),u=0;!0;u++){var l=-(a+Math.sin(a)-s)/(1+Math.cos(a));if(a+=l,Math.abs(l)<r)break}a/=2,Math.PI/2-Math.abs(i)<r&&(o=0);var h=.900316316158*this.a*o*Math.cos(a)+this.x0,c=1.4142135623731*this.a*Math.sin(a)+this.y0;return t.x=h,t.y=c,t},e.inverse=function(t){var e,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),e=Math.asin(i);var r=n(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),i=(2*e+Math.sin(2*e))/Math.PI,Math.abs(i)>1&&(i=1);var o=Math.asin(i);return t.x=r,t.y=o,t},e.names=["Mollweide","moll"]},function(t,e,i){var n=i(180),r=i(181),o=i(182),a=i(183),s=i(161),u=i(184),l=i(162),h=i(197),c=i(198),d=1e-10;e.init=function(){Math.abs(this.lat1+this.lat2)<d||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=n(this.es),this.e1=r(this.es),this.e2=o(this.es),this.e3=a(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=s(this.e,this.sinphi,this.cosphi),this.ml1=u(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<d?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=s(this.e,this.sinphi,this.cosphi),this.ml2=u(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=u(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},e.forward=function(t){var e,i=t.x,n=t.y;if(this.sphere)e=this.a*(this.g-n);else{var r=u(this.e0,this.e1,this.e2,this.e3,n);e=this.a*(this.g-r)}var o=this.ns*l(i-this.long0),a=this.x0+e*Math.sin(o),s=this.y0+this.rh-e*Math.cos(o);return t.x=a,t.y=s,t},e.inverse=function(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var e,i,n,r;this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var o=0;if(0!==i&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere)return r=l(this.long0+o/this.ns),n=h(this.g-i/this.a),t.x=r,t.y=n,t;var a=this.g-i/this.a;return n=c(a,this.e0,this.e1,this.e2,this.e3),r=l(this.long0+o/this.ns),t.x=r,t.y=n,t},e.names=["Equidistant_Conic","eqdc"]},function(t,e,i){var n=i(162),r=Math.PI/2,o=1e-10,a=i(185);e.init=function(){this.R=this.a},e.forward=function(t){var e,i,s=t.x,u=t.y,l=n(s-this.long0);Math.abs(u)<=o&&(e=this.x0+this.R*l,i=this.y0);var h=a(2*Math.abs(u/Math.PI));(Math.abs(l)<=o||Math.abs(Math.abs(u)-r)<=o)&&(e=this.x0,i=u>=0?this.y0+Math.PI*this.R*Math.tan(.5*h):this.y0+Math.PI*this.R*-Math.tan(.5*h));var c=.5*Math.abs(Math.PI/l-l/Math.PI),d=c*c,f=Math.sin(h),p=Math.cos(h),m=p/(f+p-1),v=m*m,g=m*(2/f-1),y=g*g,x=Math.PI*this.R*(c*(m-y)+Math.sqrt(d*(m-y)*(m-y)-(y+d)*(v-y)))/(y+d);l<0&&(x=-x),e=this.x0+x;var _=d+m;return x=Math.PI*this.R*(g*_-c*Math.sqrt((y+d)*(d+1)-_*_))/(y+d),i=u>=0?this.y0+x:this.y0-x,t.x=e,t.y=i,t},e.inverse=function(t){var e,i,r,a,s,u,l,h,c,d,f,p,m;return t.x-=this.x0,t.y-=this.y0,f=Math.PI*this.R,r=t.x/f,a=t.y/f,s=r*r+a*a,u=-Math.abs(a)*(1+s),l=u-2*a*a+r*r,h=-2*u+1+2*a*a+s*s,m=a*a/h+(2*l*l*l/h/h/h-9*u*l/h/h)/27,c=(u-l*l/3/h)/h,d=2*Math.sqrt(-c/3),f=3*m/c/d,Math.abs(f)>1&&(f=f>=0?1:-1),p=Math.acos(f)/3,i=t.y>=0?(-d*Math.cos(p+Math.PI/3)-l/3/h)*Math.PI:-(-d*Math.cos(p+Math.PI/3)-l/3/h)*Math.PI,e=Math.abs(r)<o?this.long0:n(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-a*a)+s*s))/2/r),t.x=e,t.y=i,t},e.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},function(t,e,i){var n=i(162),r=Math.PI/2,o=1e-10,a=i(184),s=i(180),u=i(181),l=i(182),h=i(183),c=i(196),d=i(185),f=i(198);e.init=function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},e.forward=function(t){var e,i,d,f,p,m,v,g,y,x,_,b,w,M,T,A,E,C,S,R,P,L,D,O=t.x,I=t.y,N=Math.sin(t.y),F=Math.cos(t.y),k=n(O-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=o?(t.x=this.x0+this.a*(r-I)*Math.sin(k),t.y=this.y0-this.a*(r-I)*Math.cos(k),t):Math.abs(this.sin_p12+1)<=o?(t.x=this.x0+this.a*(r+I)*Math.sin(k),t.y=this.y0+this.a*(r+I)*Math.cos(k),t):(C=this.sin_p12*N+this.cos_p12*F*Math.cos(k),A=Math.acos(C),E=A/Math.sin(A),t.x=this.x0+this.a*E*F*Math.sin(k),t.y=this.y0+this.a*E*(this.cos_p12*N-this.sin_p12*F*Math.cos(k)),t):(e=s(this.es),i=u(this.es),d=l(this.es),f=h(this.es),Math.abs(this.sin_p12-1)<=o?(p=this.a*a(e,i,d,f,r),m=this.a*a(e,i,d,f,I),t.x=this.x0+(p-m)*Math.sin(k),t.y=this.y0-(p-m)*Math.cos(k),t):Math.abs(this.sin_p12+1)<=o?(p=this.a*a(e,i,d,f,r),m=this.a*a(e,i,d,f,I),t.x=this.x0+(p+m)*Math.sin(k),t.y=this.y0+(p+m)*Math.cos(k),t):(v=N/F,g=c(this.a,this.e,this.sin_p12),y=c(this.a,this.e,N),x=Math.atan((1-this.es)*v+this.es*g*this.sin_p12/(y*F)),_=Math.atan2(Math.sin(k),this.cos_p12*Math.tan(x)-this.sin_p12*Math.cos(k)),S=0===_?Math.asin(this.cos_p12*Math.sin(x)-this.sin_p12*Math.cos(x)):Math.abs(Math.abs(_)-Math.PI)<=o?-Math.asin(this.cos_p12*Math.sin(x)-this.sin_p12*Math.cos(x)):Math.asin(Math.sin(k)*Math.cos(x)/Math.sin(_)),b=this.e*this.sin_p12/Math.sqrt(1-this.es),w=this.e*this.cos_p12*Math.cos(_)/Math.sqrt(1-this.es),M=b*w,T=w*w,R=S*S,P=R*S,L=P*S,D=L*S,A=g*S*(1-R*T*(1-T)/6+P/8*M*(1-2*T)+L/120*(T*(4-7*T)-3*b*b*(1-7*T))-D/48*M),t.x=this.x0+A*Math.sin(_),t.y=this.y0+A*Math.cos(_),t))},e.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,i,p,m,v,g,y,x,_,b,w,M,T,A,E,C,S,R,P,L,D,O,I;if(this.sphere){if(e=Math.sqrt(t.x*t.x+t.y*t.y),e>2*r*this.a)return;return i=e/this.a,p=Math.sin(i),m=Math.cos(i),v=this.long0,Math.abs(e)<=o?g=this.lat0:(g=d(m*this.sin_p12+t.y*p*this.cos_p12/e),y=Math.abs(this.lat0)-r,v=n(Math.abs(y)<=o?this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y):this.long0+Math.atan2(t.x*p,e*this.cos_p12*m-t.y*this.sin_p12*p))),t.x=v,t.y=g,t}return x=s(this.es),_=u(this.es),b=l(this.es),w=h(this.es),Math.abs(this.sin_p12-1)<=o?(M=this.a*a(x,_,b,w,r),e=Math.sqrt(t.x*t.x+t.y*t.y),T=M-e,g=f(T/this.a,x,_,b,w),v=n(this.long0+Math.atan2(t.x,-1*t.y)),t.x=v,t.y=g,t):Math.abs(this.sin_p12+1)<=o?(M=this.a*a(x,_,b,w,r),e=Math.sqrt(t.x*t.x+t.y*t.y),T=e-M,g=f(T/this.a,x,_,b,w),v=n(this.long0+Math.atan2(t.x,t.y)),t.x=v,t.y=g,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),C=Math.atan2(t.x,t.y),A=c(this.a,this.e,this.sin_p12),S=Math.cos(C),R=this.e*this.cos_p12*S,P=-R*R/(1-this.es),L=3*this.es*(1-P)*this.sin_p12*this.cos_p12*S/(1-this.es),D=e/A,O=D-P*(1+P)*Math.pow(D,3)/6-L*(1+3*P)*Math.pow(D,4)/24,I=1-P*O*O/2-D*O*O*O/6,E=Math.asin(this.sin_p12*Math.cos(O)+this.cos_p12*Math.sin(O)*S),v=n(this.long0+Math.asin(Math.sin(C)*Math.sin(O)/Math.cos(E))),g=Math.atan((1-this.es*I*this.sin_p12/Math.sin(E))*Math.tan(E)/(1-this.es)),t.x=v,t.y=g,t)},e.names=["Azimuthal_Equidistant","aeqd"]},function(t,e,i){var n=i(4),r=i(5),o=function(t){"use strict";function e(t,e){return("wheel"===t||h.buttons[t])&&!!h.modifiers.alt==!!e.alt&&!!h.modifiers.meta==!!e.meta&&!!h.modifiers.shift==!!e.shift&&!!h.modifiers.ctrl==!!e.ctrl}function n(t){var e=t.x,i=t.y;return Math.sqrt(e*e+i*i)}function a(t,e){e=e<=0?30:e;var i=s(),r=n(t),o=t.x/r,a=t.y/r;return r*=Math.exp(-b.momentum.drag*e),n(i)*e+r<b.momentum.minSpeed?null:(r>0?(o*=r,
a*=r):(o=0,a=0),{x:o-i.x*e,y:a-i.y*e})}function s(){var t,e,i,n;if(!b.spring.enabled)return{x:0,y:0};var r=w.map().maxBounds(void 0,null),o=w.map().gcsToDisplay({x:r.left,y:r.top},null),a=w.map().gcsToDisplay({x:r.right,y:r.bottom},null),s=b.spring.springConstant,u=w.map().node().width(),l=w.map().node().height();return t=s*Math.max(0,o.x),e=s*Math.max(0,u-a.x),i=s*Math.max(0,o.y)/2,n=s*Math.max(0,l-a.y)/2,{x:t-e,y:i-n}}function u(){function t(t,e){var a,s=w.map();i=e,o+=t,void 0===r&&(n=r=s.zoom()),r+=t,s&&Math.abs(o)>=1&&b.discreteZoom&&!b.zoomAnimation.enabled&&(a=Math.round(o+s.zoom()),o=o+s.zoom()-a,s.zoom(a,i))}function e(){var t,e=w.map();e&&(b.zoomAnimation.enabled?(t=r,b.discreteZoom&&(t=Math.round(t),t===n&&r!==n&&(t=n+(r>n?1:-1))),e.transitionCancel("debounced_zoom.zoom"),e.transition({zoom:t,zoomOrigin:i,duration:b.zoomAnimation.duration,ease:b.zoomAnimation.ease,done:function(t){t=t||{},t.next||t.cancel&&!((""+t.source).search(/\.zoom$/)<0)||(r=void 0),b.discreteZoom&&t.cancel&&t.transition&&t.transition.end&&(""+t.source).search(/\.zoom$/)<0&&e.zoom(t.transition.end.zoom,t.transition.end.zoomOrigin)}})):(t=o+e.zoom(),b.discreteZoom&&(t=Math.round(t)),e.zoom(t,i))),o=0}var i,n,r,o=0,a=400;return b.discreteZoom!==!0&&b.discreteZoom>0&&(a=b.discreteZoom),(b.discreteZoom===!0||b.discreteZoom>0)&&!b.zoomAnimation.enabled?x(a,!1,e,t):function(i,n){(i||void 0!==r)&&(t(i,n),e(i,n))}}function l(){function t(t){var e,i;T||(n!==f&&(n={kind:"wheel",scroll:{x:0,y:0}},f=n),t.preventDefault(),t.deltaFactor=1,1===t.originalEvent.deltaMode?t.deltaFactor=40:2===t.originalEvent.deltaMode&&(t.deltaFactor=v(window).height()),e=t.originalEvent.deltaX||0,i=t.originalEvent.deltaY||0,e=e*b.wheelScaleX*t.deltaFactor/120,i=i*b.wheelScaleY*t.deltaFactor/120,n.scroll.x+=e,n.scroll.y+=i)}function i(t){var i,r;if(n===f){if(w._getMouseModifiers(t),b.panWheelEnabled&&e("wheel",b.panWheelModifiers)?r="pan":b.zoomWheelEnabled&&e("wheel",b.zoomWheelModifiers)?r="zoom":b.rotateWheelEnabled&&e("wheel",b.rotateWheelModifiers)&&(r="rotate"),r){var o=w.map().transitionCancel("wheel."+r);switch(o|=w.cancel("momentum",!0),o&&(h.geo=w.map().displayToGcs(h.map)),r){case"pan":w.map().pan({x:f.scroll.x,y:f.scroll.y});break;case"zoom":i=-f.scroll.y,E(i,h);break;case"rotate":w.map().rotation(w.map().rotation()+f.scroll.y*b.rotateWheelScale,h)}}f={}}}var n={};return b.throttle>0?y(b.throttle,!1,i,t):function(e){t(e),i(e)}}if(!(this instanceof o))return new o(t);r.call(this);var h,c,d,f,p,m,v=i(1),g=i(125),y=i(120).throttle,x=i(120).debounce,_=i(218),b=t||{},w=this,M=null,T=!1,A=!1,E=function(){};return b=v.extend(!0,{},{throttle:30,discreteZoom:!1,panMoveButton:"left",panMoveModifiers:{},zoomMoveButton:"right",zoomMoveModifiers:{},rotateMoveButton:"left",rotateMoveModifiers:{ctrl:!0},panWheelEnabled:!1,panWheelModifiers:{},zoomWheelEnabled:!0,zoomWheelModifiers:{},rotateWheelEnabled:!0,rotateWheelModifiers:{ctrl:!0},wheelScaleX:1,wheelScaleY:1,zoomScale:1,rotateWheelScale:6*Math.PI/180,selectionButton:"left",selectionModifiers:{shift:!0,ctrl:!0},zoomSelectionButton:"left",zoomSelectionModifiers:{shift:!0},unzoomSelectionButton:"right",unzoomSelectionModifiers:{shift:!0},momentum:{enabled:!0,maxSpeed:2.5,minSpeed:.01,stopTime:250,drag:.01,actions:["pan","zoom"]},spring:{enabled:!1,springConstant:5e-5},click:{enabled:!0,buttons:{left:!0,right:!0,middle:!0},duration:0,cancelOnMove:!0},zoomAnimation:{enabled:!0,duration:500,ease:function(t){return(2-t)*t}}},b),h={page:{x:0,y:0},map:{x:0,y:0},buttons:{left:!1,right:!1,middle:!1},modifiers:{alt:!1,ctrl:!1,shift:!1,meta:!1},time:new Date,deltaTime:1,velocity:{x:0,y:0}},c={},d={},f={},this._connectEvents=function(){return b.map?(w._disconnectEvents(),p=v(b.map.node()),w._handleMouseWheel=l(),E=u(),p.on("wheel.geojs",w._handleMouseWheel),p.on("mousemove.geojs",w._handleMouseMove),p.on("mousedown.geojs",w._handleMouseDown),p.on("mouseup.geojs",w._handleMouseUp),p.on("dragstart",function(){return!1}),"right"!==b.panMoveButton&&"right"!==b.zoomMoveButton&&"right"!==b.rotateMoveButton&&"right"!==b.selectionButton&&"right"!==b.zoomSelectionButton&&"right"!==b.unzoomSelectionButton||p.on("contextmenu.geojs",function(){return!1}),w):w},this._disconnectEvents=function(){return p&&(p.off(".geojs"),p=null),w._handleMouseWheel=function(){},E=function(){},w},this.map=function(t){return void 0!==t?(b.map=t,w._connectEvents(),w):b.map},this.options=function(t){return void 0===t?v.extend({},b):(v.extend(b,t),this._connectEvents(),w)},this._getMousePosition=function(t){var e,i,n=p.offset();i=(new Date).valueOf(),e=i-h.time,h.time=i,h.deltaTime=e,h.velocity={x:(t.pageX-h.page.x)/e,y:(t.pageY-h.page.y)/e},h.page={x:t.pageX,y:t.pageY},h.map={x:t.pageX-n.left,y:t.pageY-n.top};try{h.geo=w.map().displayToGcs(h.map)}catch(r){h.geo=null}},this._getMouseButton=function(t){1===t.which?h.buttons.left="mouseup"!==t.type:3===t.which?h.buttons.right="mouseup"!==t.type:2===t.which&&(h.buttons.middle="mouseup"!==t.type)},this._getMouseModifiers=function(t){h.modifiers.alt=t.altKey,h.modifiers.ctrl=t.ctrlKey,h.modifiers.meta=t.metaKey,h.modifiers.shift=t.shiftKey},this._getSelection=function(){var t=d.origin,e=w.mouse(),i=w.map(),n={},r={};return n.upperLeft={x:Math.min(t.map.x,e.map.x),y:Math.min(t.map.y,e.map.y)},n.lowerRight={x:Math.max(t.map.x,e.map.x),y:Math.max(t.map.y,e.map.y)},n.upperRight={x:n.lowerRight.x,y:n.upperLeft.y},n.lowerLeft={x:n.upperLeft.x,y:n.lowerRight.y},r.upperLeft=i.displayToGcs(n.upperLeft,null),r.lowerRight=i.displayToGcs(n.lowerRight,null),r.upperRight=i.displayToGcs(n.upperRight,null),r.lowerLeft=i.displayToGcs(n.lowerLeft,null),m.data([{ul:r.upperLeft,ur:r.upperRight,ll:r.lowerLeft,lr:r.lowerRight}]),m.draw(),{display:n,gcs:r,mouse:e,origin:v.extend({},d.origin)}},this.cancel=function(t,e){var i;return i=t?d.action===t:!!d.action,i&&(e||(f={}),d={}),i},this._handleMouseDown=function(t){var i=null;T||(w._getMousePosition(t),w._getMouseButton(t),w._getMouseModifiers(t),!b.click.enabled||h.buttons.left&&!b.click.buttons.left||h.buttons.right&&!b.click.buttons.right||h.buttons.middle&&!b.click.buttons.middle||(A=!0,b.click.duration>0&&window.setTimeout(function(){A=!1},b.click.duration)),e(b.panMoveButton,b.panMoveModifiers)?i="pan":e(b.zoomMoveButton,b.zoomMoveModifiers)?i="zoom":e(b.rotateMoveButton,b.rotateMoveModifiers)?i="rotate":e(b.selectionButton,b.selectionModifiers)?i="select":e(b.zoomSelectionButton,b.zoomSelectionModifiers)?i="zoomselect":e(b.unzoomSelectionButton,b.unzoomSelectionModifiers)&&(i="unzoomselect"),w.map().transitionCancel("_handleMouseDown."+i),w.cancel("momentum"),h.velocity={x:0,y:0},i&&(f={kind:"move"},d={action:i,origin:v.extend(!0,{},h),delta:{x:0,y:0}},"select"!==i&&"zoomselect"!==i&&"unzoomselect"!==i||(M&&(M.clear(),w.map().deleteLayer(M),M=null),M=w.map().createLayer("feature",{features:[_.capabilities.color]}),m=M.createFeature("quad",{gcs:w.map().gcs()}),m.style({opacity:.25,color:{r:.3,g:.3,b:.3}}),w.map().geoTrigger(g.brushstart,w._getSelection())),b.throttle>0?v(document).on("mousemove.geojs",y(b.throttle,w._handleMouseMoveDocument)):v(document).on("mousemove.geojs",w._handleMouseMoveDocument),v(document).on("mouseup.geojs",w._handleMouseUpDocument)))},this._handleMouseMove=function(t){T||d.action||(b.click.cancelOnMove&&(A=!1),w._getMousePosition(t),w._getMouseButton(t),w._getMouseModifiers(t),A||w.map().geoTrigger(g.mousemove,w.mouse()))},this._handleMouseMoveDocument=function(t){var e,i,n;if(w.map()&&!T&&"move"===f.kind&&(w._getMousePosition(t),w._getMouseButton(t),w._getMouseModifiers(t),b.click.cancelOnMove&&(A=!1),!A)){if(!d.action)return void console.log("WARNING: Invalid state in mapInteractor.");if(e=h.map.x-d.origin.map.x-d.delta.x,i=h.map.y-d.origin.map.y-d.delta.y,d.delta.x+=e,d.delta.y+=i,"pan"===d.action)w.map().pan({x:e,y:i});else if("zoom"===d.action)E(-i*b.zoomScale/120,d);else if("rotate"===d.action){var r,o;void 0===d.origin.rotation&&(r=d.origin.map.x-w.map().size().width/2,o=d.origin.map.y-w.map().size().height/2,d.origin.rotation=w.map().rotation()-Math.atan2(o,r)),r=h.map.x-w.map().size().width/2,o=h.map.y-w.map().size().height/2,w.map().rotation(d.origin.rotation+Math.atan2(o,r))}else"select"!==d.action&&"zoomselect"!==d.action&&"unzoomselect"!==d.action||(n=w._getSelection(),w.map().geoTrigger(g.brush,n));t.preventDefault()}},this._zoomFromSelection=function(t,e,i){if(("zoomselect"===t||"unzoomselect"===t)&&e.x!==i.x&&e.y!==i.y){var n,r,o=w.map(),a=o.size(),s={x:Math.abs((i.x-e.x)/a.width),y:Math.abs((i.y-e.y)/a.height)};if("zoomselect"===t?(r=o.displayToGcs({x:(e.x+i.x)/2,y:(e.y+i.y)/2},null),n=o.zoom()-Math.log2(Math.max(s.x,s.y))):(n=o.zoom()+Math.log2(Math.max(s.x,s.y)),r=o.center(void 0,null)),o.discreteZoom()&&(n=Math.floor(n)),o.zoom(n),"zoomselect"===t)o.center(r,null);else{var u=o.gcsToDisplay(r,null);o.pan({x:(e.x+i.x)/2-u.x,y:(e.y+i.y)/2-u.y})}}},this._handleMouseUpDocument=function(t){var e,i;if(!T&&(f={},A=!1,w._getMouseButton(t),w._getMouseModifiers(t),v(document).off(".geojs"),h.buttons.right&&t.preventDefault(),"select"!==d.action&&"zoomselect"!==d.action&&"unzoomselect"!==d.action||(w._getMousePosition(t),e=w._getSelection(),M.clear(),w.map().deleteLayer(M),M=null,m=null,w.map().geoTrigger(g.brushend,e),w.map().geoTrigger(g[d.action],e),w._zoomFromSelection(d.action,e.display.lowerLeft,e.display.upperRight)),i=d.action,d={},b.momentum.enabled&&v.inArray(i,b.momentum.actions)>=0)){var n=(new Date).valueOf(),r=n-h.time+h.deltaTime;n-h.time<b.momentum.stopTime?(h.velocity.x=h.velocity.x*h.deltaTime/r,h.velocity.y=h.velocity.y*h.deltaTime/r,h.deltaTime=r):h.velocity.x=h.velocity.y=0,w.springBack(!0,i)}},this._handleMouseUp=function(t){T||A&&w._handleMouseClick(t)},this._handleMouseClick=function(t){w._getMouseButton(t),w._getMouseModifiers(t),w.cancel("pan"),v(document).off(".geojs"),A=!1,w.map().geoTrigger(g.mouseclick,w.mouse())},this._handleMouseWheel=function(){},this.springBack=function(t,e){"momentum"!==d.action&&(t||(h.velocity={x:0,y:0}),d.origAction=e,d.action="momentum",d.origin=w.mouse(),d.start=new Date,d.handler=function(){var t,e,i,r;if(r=Math.min(h.deltaTime,30),"momentum"===d.action&&w.map()&&!w.map().transition()){if(i=d.start.valueOf(),d.start=new Date,t=a(h.velocity,d.start-i),!t)return void(d={});switch(e=n(t),e>b.momentum.maxSpeed&&(e=b.momentum.maxSpeed/e,t.x=t.x*e,t.y=t.y*e),isFinite(t.x)&&isFinite(t.y)||(t.x=0,t.y=0),h.velocity.x=t.x,h.velocity.y=t.y,d.origAction){case"zoom":var o=h.velocity.y*r;E(-o*b.zoomScale/120,d);break;default:w.map().pan({x:h.velocity.x*r,y:h.velocity.y*r})}d.handler&&window.requestAnimationFrame(d.handler)}},d.handler&&window.requestAnimationFrame(d.handler))},this._handleDoubleClick=function(){},this.destroy=function(){w._disconnectEvents(),w.map(null)},this.mouse=function(){return v.extend(!0,{},h)},this.keyboard=function(){return v.extend(!0,{},c)},this.state=function(){return v.extend(!0,{},d)},this.pause=function(t){return void 0===t?T:(T=!!t,w)},this.simulateEvent=function(t,e){var i,n,r,o;return w.map()?(n=e.page||{},e.map&&(r=p.offset(),n.x=e.map.x+r.left,n.y=e.map.y+r.top),"left"===e.button?o=1:"right"===e.button?o=3:"middle"===e.button&&(o=2),e.modifiers=e.modifiers||[],e.wheelDelta=e.wheelDelta||{},i=v.Event(t,{pageX:n.x,pageY:n.y,which:o,altKey:e.modifiers.indexOf("alt")>=0,ctrlKey:e.modifiers.indexOf("ctrl")>=0,metaKey:e.modifiers.indexOf("meta")>=0,shiftKey:e.modifiers.indexOf("shift")>=0,originalEvent:{deltaX:e.wheelDelta.x,deltaY:e.wheelDelta.y,deltaMode:e.wheelMode,preventDefault:function(){},stopPropagation:function(){},stopImmediatePropagation:function(){}}}),t.indexOf(".geojs")>=0&&v(document).trigger(i),void p.trigger(i)):w},this._connectEvents(),this};n(o,r),t.exports=o},function(t,e,i){var n=i(1),r=i(4),o=i(127),a=function(t){"use strict";var e=i(147),r=i(120);if(!(this instanceof a))return new a(t);t=t||{},o.call(this,t);var s,u,l=this,h=this._init,c=0,d=[];return this._objectListStart=function(t){n.each(t,function(t,e){e.used=!1})},this._objectListGet=function(t,e){for(var i=0;i<t.length;i+=1)if(t[i].entry===e)return t[i].used=!0,t[i].value},this._objectListAdd=function(t,e,i){t.push({entry:e,value:i,used:!0})},this._objectListEnd=function(t){for(var e=t.length-1;e>=0;e-=1)t[e].used||t.splice(e,1)},this.pointSearch=function(t){var i,o=[],a=[],s=l.data(),h=[{},{},{},{}],c=[{},{},{},{}],d=l.layer().map(),f=[0,1,2,0],p=[1,2,3,1];return t=e.transformCoordinates(d.ingcs(),d.gcs(),t),u||this._generateQuads(),n.each([u.clrQuads,u.imgQuads],function(e,n){n.forEach(function(e,n){for(i=0;i<f.length;i+=1)h[i].x=e.pos[3*f[i]],h[i].y=e.pos[3*f[i]+1],h[i].z=e.pos[3*f[i]+2],c[i].x=e.pos[3*p[i]],c[i].y=e.pos[3*p[i]+1],c[i].z=e.pos[3*p[i]+2];(r.pointInPolygon(t,h)||r.pointInPolygon(t,c))&&(a.push(e.idx),o.push(s[e.idx]))})}),{index:a,found:o}},this.position=function(t){return void 0===t?l.style("position"):(l.style("position",r.ensureFunction(t)),l.dataTime().modified(),l.modified(),l)},this._positionToQuad=function(t,i,r,o){var a=t.call(l,r,o);if(a.ll&&a.ur||a.ul&&a.lr){var s=l.gcs(),u=l.layer().map().gcs(),h={};return n.each(["ll","lr","ul","ur"],function(t,n){void 0!==a[n]&&(h[n]={},void 0===a[n].x?h[n]=[a[n][0],a[n][1],a[n][2]]:h[n]=[a[n].x,a[n].y,a[n].z],void 0===h[n][2]&&(h[n][2]=i.call(l,r,o)),s!==u&&s!==!1&&(h[n]=e.transformCoordinates(s,u,h[n])))}),h.ll=h.ll||[h.ul[0],h.lr[1],(h.ul[2]+h.lr[2])/2],h.lr=h.lr||[h.ur[0],h.ll[1],(h.ur[2]+h.ll[2])/2],h.ur=h.ur||[h.lr[0],h.ul[1],(h.lr[2]+h.ul[2])/2],h.ul=h.ul||[h.ll[0],h.ur[1],(h.ll[2]+h.ur[2])/2],h}},this._generateQuads=function(){var t,e,i=l.position(),o=r.ensureFunction(l.style("image")),a=r.ensureFunction(l.style("color")),h=r.ensureFunction(l.style("depth")),f=r.ensureFunction(l.style("opacity")),p=r.ensureFunction(l.style("drawOnAsyncResourceLoaded")),m=r.ensureFunction(l.style("previewColor")),v=r.ensureFunction(l.style("previewImage")),g=l.data(),y=[],x=[],_=[0,0,0];return l._objectListStart(d),n.each(g,function(u,g){if(g._cachedQuad)return e=g._cachedQuad.diag2,(void 0===t||g._cachedQuad.diag2&&g._cachedQuad.diag2<t)&&(_=g._cachedQuad.ll,t=g._cachedQuad.diag2),g._cachedQuad.clrquad&&y.push(g._cachedQuad.clrquad),void(g._cachedQuad.imgquad&&x.push(g._cachedQuad.imgquad));var b,w,M,T,A,E,C,S,R,P={};if(A=l._positionToQuad(i,h,g,u),C=f.call(l,g,u),void 0!==A&&C){if(e=Math.pow(A.ll[0]-A.ur[0],2)+Math.pow(A.ll[1]-A.ur[1],2)+Math.pow(A.ll[2]-A.ur[0],2)+Math.pow(A.lr[0]-A.ur[0],2)+Math.pow(A.lr[1]-A.ur[1],2)+Math.pow(A.lr[2]-A.ur[0],2),P.diag2=e,P.ll=A.ll,(void 0===t||e&&e<t)&&(_=A.ll,t=e),A=[A.ll[0],A.ll[1],A.ll[2],A.lr[0],A.lr[1],A.lr[2],A.ul[0],A.ul[1],A.ul[2],A.ur[0],A.ur[1],A.ur[2]],E=o.call(l,g,u)){if(M=l._objectListGet(d,E),void 0===M&&(E instanceof Image?M=E:(M=new Image,M.src=E),l._objectListAdd(d,E,M)),b={idx:u,pos:A,opacity:C,reference:g.reference},M.complete&&M.naturalWidth&&M.naturalHeight)b.image=M;else if(S=void 0,R=v.call(l,g,u),R&&R instanceof Image&&R.complete&&R.naturalWidth&&R.naturalHeight?b.image=R:(S=m.call(l,g,u),null===S&&(S=void 0),void 0!==S&&(b.color=r.convertColor(S),y.push(b),P.keep=!1)),w=p.call(l,g,u))T=M.onload,M.onload=function(){if(void 0!==S&&n.inArray(b,y)>=0&&y.splice(n.inArray(b,y),1),b.image=M,l.dataTime().modified(),l.modified(),l._update(),l.layer().draw(),T)return T.apply(this,arguments)};else if(void 0===S&&!b.image)return;x.push(b),P.imgquad=b}else b={idx:u,pos:A,opacity:C,color:r.convertColor(a.call(l,g,u)),reference:g.reference},y.push(b),P.clrquad=b;s!==!1&&P.keep!==!1&&(P.clrquad&&(c+=1,P.clrquad.quadId=c),P.imgquad&&(c+=1,P.imgquad.quadId=c),g._cachedQuad=P)}}),l._objectListEnd(d),u={clrQuads:y,imgQuads:x,origin:_}},this._init=function(t){t=t||{},h.call(l,t),s=t.cacheQuads!==!1;var e=n.extend({},{color:{r:1,g:1,b:1},opacity:1,depth:0,drawOnAsyncResourceLoaded:!0,previewColor:null,previewImage:null,image:function(t){return t.image},position:function(t){return t}},void 0===t.style?{}:t.style);void 0!==t.position&&(e.position=r.ensureFunction(t.position)),l.style(e),l.dataTime().modified()},l};a.create=function(t,e){"use strict";return e=e||{},e.type="quad",o.create(t,e)},a.capabilities={color:"quad.color",image:"quad.image",imageFull:"quad.imageFull"},r(a,o),t.exports=a},function(t,e,i){var n=i(4),r=i(131).registerLayer,o=i(130),a=function(t){"use strict";var e=i(131).createWidget;if(t.renderer="dom",t.sticky=!1,!(this instanceof a))return new a(t);o.call(this,t);var n=this,r=this._exit;this.createWidget=function(t,i){var r=e(t,n,i);return i&&"parent"in i||n.addChild(r),r._init(i),n.modified(),r},this.deleteWidget=function(t){return t._exit(),n.removeChild(t),n.modified(),n},this._exit=function(){n.children().forEach(function(t){n.deleteWidget(t)}),r()}};n(a,o),r("ui",a),t.exports=a},function(t,e,i){t.exports=function(){"use strict";var t=i(1),e=i(4),n=i(221),r=i(131),o=i(218),a=function(t){var e=i(142);return this instanceof a?(void 0!==t.mapOpacity&&void 0===t.opacity&&(t.opacity=t.mapOpacity),n.call(this,t),this.mapOpacity=this.opacity,void(this._getTile=function(t,i){var n=i||t;return e({index:t,size:{x:this._options.tileWidth,y:this._options.tileHeight},queue:this._queue,url:this._options.url(n.x,n.y,n.level||0,this._options.subdomains)})}.bind(this))):new a(t)};return a.defaults=t.extend({},n.defaults,{minLevel:0,maxLevel:18,tileOverlap:0,tileWidth:256,tileHeight:256,tileOffset:function(t){var e=256*Math.pow(2,t-1);return{x:e,y:e}},wrapX:!0,wrapY:!1,url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Tile data &copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),e(a,n),r.registerLayer("osm",a,[o.capabilities.image]),a}()},function(t,e,i){t.exports=function(){"use strict";function t(t,e){return(t%e+e)%e}function e(e,i,n){return n[t(e+i,n.length)]}function n(t){return function(i,n,r,o){return t.replace("{s}",e(i,n,o)).replace("{z}",r).replace("{x}",i).replace("{y}",n)}}var r=i(4),o=i(137),a=function(e){var r=i(1),s=i(125),u=i(147),l=i(222),h=i(138),c=i(131).adjustLayerForRenderer,d=i(143);if(!(this instanceof a))return new a(e);if(o.call(this,e),e=r.extend(!0,{},this.constructor.defaults,e||{}),e.cacheSize||(e.cacheSize=e.keepLower?600:200),"string"===r.type(e.subdomains)&&(e.subdomains=e.subdomains.split("")),e.baseUrl){var f=e.baseUrl;f&&"/"!==f.charAt(f.length-1)&&(f+="/"),e.url=f+"{z}/{x}/{y}."+(e.imageFormat||"png")}e.originalUrl=e.url,"string"===r.type(e.url)&&(e.url=n(e.url));var p,m=this._init,v=this._exit,g=[];this._options=r.extend(!0,{},e),this.attribution(e.attribution),this._activeTiles={},this._tileTree={},this._cache=l({size:e.cacheSize}),this._queue=h({size:6,track:e.cacheSize,needed:function(t){return t===this.cache.get(t.toString(),!0)}.bind(this)});var y={};return Object.defineProperty(this,"options",{get:function(){return r.extend({},this._options)}}),Object.defineProperty(this,"cache",{get:function(){return this._cache}}),Object.defineProperty(this,"activeTiles",{get:function(){return r.extend({},this._activeTiles)}}),this.tilesAtZoom=function(t){if(this._options.tilesAtZoom)return this._options.tilesAtZoom.call(this,t);var e=Math.pow(2,t);return{x:e,y:e}},this.isValid=function(t){return this._options.minLevel<=t.level&&t.level<=this._options.maxLevel&&(!!(this._options.wrapX||0<=t.x&&t.x<=this.tilesAtZoom(t.level).x-1)&&!!(this._options.wrapY||0<=t.y&&t.y<=this.tilesAtZoom(t.level).y-1))},this._origin=function(t){var e,i,n=this.toLevel(this.toLocal(this.map().origin()),t),r=this._options;return e={x:Math.floor(n.x/r.tileWidth),y:Math.floor(n.y/r.tileHeight)},i={x:n.x-r.tileWidth*e.x,y:n.y-r.tileHeight*e.y},{index:e,offset:i}},this._tileBounds=function(t){var e=this._origin(t.index.level);return t.bounds(e.index,e.offset)},this.tileAtPoint=function(t,e){var i=this._origin(e),n=this.map();t=this.displayToLevel(n.gcsToDisplay(t,null),e),isNaN(t.x)&&(t.x=0),isNaN(t.y)&&(t.y=0);var r=this._tileOffset(e);r&&(t.x+=r.x,t.y+=r.y);var o={x:Math.floor(i.index.x+(i.offset.x+t.x)/this._options.tileWidth),y:Math.floor(i.index.y+(i.offset.y+t.y)/this._options.tileHeight)};return o},this.gcsTileBounds=function(t,e){var i=t.index?t:d({index:t,size:{x:this._options.tileWidth,y:this._options.tileHeight},url:""}),n=this._tileOffset(i.index.level),r=i.bounds({x:0,y:0},n),o=this.map(),a=o.unitsPerPixel(i.index.level),s=[{x:r.left*a,y:this._topDown()*r.top*a},{x:r.right*a,y:this._topDown()*r.bottom*a}];return e=null===e?o.gcs():void 0===e?o.ingcs():e,e!==o.gcs()&&(s=u.transformCoordinates(e,o.gcs(),s)),{left:s[0].x,top:s[0].y,right:s[1].x,bottom:s[1].y}},this._getTile=function(t,e){var i=e||t;return d({index:t,size:{x:this._options.tileWidth,y:this._options.tileHeight},queue:this._queue,url:this._options.url(i.x,i.y,i.level||0,this._options.subdomains)})},this._getTileCached=function(t,e,i){var n=this.cache.get(this._tileHash(t));return null===n&&(n=this._getTile(t,e),this.cache.add(n,this.remove.bind(this),i)),n},this._tileHash=function(t){return[t.level||0,t.y,t.x].join("_")},this._getTileRange=function(t,e){var i=[this.tileAtPoint({x:e.left,y:e.top},t),this.tileAtPoint({x:e.right,y:e.top},t),this.tileAtPoint({x:e.left,y:e.bottom},t),this.tileAtPoint({x:e.right,y:e.bottom},t)];return{start:{x:Math.min(i[0].x,i[1].x,i[2].x,i[3].x),y:Math.min(i[0].y,i[1].y,i[2].y,i[3].y)},end:{x:Math.max(i[0].x,i[1].x,i[2].x,i[3].x),y:Math.max(i[0].y,i[1].y,i[2].y,i[3].y)}}},this._getTiles=function(e,i,n,o){var a,s,u,l,h,c,d,f,p,m,v,y=[],x=!1,_=this._options.keepLower?this._options.minLevel:e;for(e<_&&(e=_),v=_;v<=e&&(d=this._getTileRange(v,i),h=d.start,c=d.end,l=this.tilesAtZoom(v),this._options.wrapX||(h.x=Math.min(Math.max(h.x,0),l.x-1),c.x=Math.min(Math.max(c.x,0),l.x-1),v===_&&this._options.keepLower&&(h.x=0,c.x=l.x-1)),this._options.wrapY||(h.y=Math.min(Math.max(h.y,0),l.y-1),c.y=Math.min(Math.max(c.y,0),l.y-1),v===_&&this._options.keepLower&&(h.y=0,c.y=l.y-1)),!(this._options.gcs&&this._options.gcs!==this.map().gcs()&&v!==_&&(c.x+1-h.x)*(c.y+1-h.y)>this.map().size().width*this.map().size().height/this._options.tileWidth/this._options.tileHeight*16));v+=1)for(a=h.x;a<=c.x;a+=1)for(s=h.y;s<=c.y;s+=1)u={level:v,x:a,y:s},f={level:v,x:a,y:s},this._options.wrapX&&(f.x=t(f.x,l.x)),this._options.wrapY&&(f.y=t(f.y,l.y)),this.isValid(f)&&(o&&y.length<g.length&&(m=g[y.length],x=x||u.level!==m.level||u.x!==m.x||u.y!==m.y),y.push({index:u,source:f}));if(o){if(!x&&y.length===g.length)return;g.splice(0,g.length),r.each(y,function(t,e){g.push(e.index)})}if(n){p={x:(h.x+c.x)/2,y:(h.y+c.y)/2,level:e,bottomLevel:e};for(var b=Math.max(c.x-h.x,c.y-h.y)+1;b>=1;b/=2)p.bottomLevel-=1;y.sort(this._loadMetric(p)),this._queue&&this._queue.batch(!0)}for(this.cache.size<y.length&&(console.log("Increasing cache size to "+y.length),this.cache.size=y.length),a=0;a<y.length;a+=1)y[a]=this._getTileCached(y[a].index,y[a].source,!0);return this.cache.purge(this.remove.bind(this)),y},this.prefetch=function(t,e){var i;return i=this._getTiles(t,e,!0),r.when.apply(r,i.map(function(t){return t.fetch()}))},this._loadMetric=function(t){return function(e,i){var n,r,o,a,s,u,l;return e=e.index||e,i=i.index||i,e.level!==i.level?t.bottomLevel&&e.level>=t.bottomLevel!=i.level>=t.bottomLevel?e.level>=t.bottomLevel?-1:1:e.level-i.level:(l=Math.pow(2,e.level-t.level),s=(t.x+.5)*l-.5,u=(t.y+.5)*l-.5,o=e.x-s,a=e.y-u,n=o*o+a*a,o=i.x-s,a=i.y-u,r=o*o+a*a,n-r)}},this.fromLevel=function(t,e){var i=Math.pow(2,-e);return{x:t.x*i,y:t.y*i}},this.toLevel=function(t,e){var i=Math.pow(2,e);return{x:t.x*i,y:t.y*i}},this.drawTile=function(t){var e=t.toString();this._activeTiles.hasOwnProperty(e)?this._moveToTop(t):this._drawTile(t),this._activeTiles[e]=t},this._drawTile=function(t){if(null!==this.renderer())throw new Error("This draw method is not valid on renderer managed layers.");var e=r(this._getSubLayer(t.index.level)),i=this._tileBounds(t),n=this._options.animationDuration,o=r('<div class="geo-tile-container"/>').attr("tile-reference",t.toString());o.append(t.image),o.css({position:"absolute",left:i.left-parseInt(e.attr("offsetx")||0,10)+"px",top:i.top-parseInt(e.attr("offsety")||0,10)+"px"}),n>0&&t.fadeIn(n),e.append(o),t["catch"](function(){console.warn("Could not load tile at "+t.toString()),this._remove(t)}.bind(this))},this.remove=function(t){var e=t.toString(),i=this._activeTiles[e];return i instanceof d&&this._remove(i),delete this._activeTiles[e],i},this._remove=function(t){t.image&&(t.image.parentElement?r(t.image.parentElement).remove():console.log("No parent element to remove "+t.toString(),t),r(t.image).remove())},this._moveToTop=function(t){r.noop(t)},this._getViewBounds=function(){var t=this.map(),e=t.zoom(),i=this._options.tileRounding(e),n=Math.pow(2,e-i),r=t.size(),o=this.displayToLevel({x:0,y:0}),a=this.displayToLevel({x:r.width,y:0}),s=this.displayToLevel({x:0,y:r.height}),u=this.displayToLevel({x:r.width,y:r.height});return{level:i,scale:n,left:Math.min(o.x,a.x,s.x,u.x),right:Math.max(o.x,a.x,s.x,u.x),top:Math.min(o.y,a.y,s.y,u.y),bottom:Math.max(o.y,a.y,s.y,u.y)}},this._purge=function(t,e,i){var n,r;if(!this._updating){i||(i=this._getViewBounds());for(r in this._activeTiles)n=this._activeTiles[r],this._canPurge(n,i,t,e)&&this.remove(n);return this}},this.clear=function(){var t,e=[];for(t in this._activeTiles)e.push(this.remove(t));return this._tileTree={},g=[],e},this.reset=function(){this.clear(),this._cache.clear()},this.toLocal=function(t,e){var i=this.map(),n=i.unitsPerPixel(void 0===e?i.zoom():e);return{x:t.x/n,y:this._topDown()*t.y/n}},this.fromLocal=function(t,e){var i=this.map(),n=i.unitsPerPixel(void 0===e?i.zoom():e);return{x:t.x*n,y:this._topDown()*t.y*n}},this._topDown=function(){return this._options.topDown?1:-1},this._getSubLayer=function(t){if(this.canvas()){var e=this.canvas().find("div[data-tile-layer="+t.toFixed()+"]").get(0);return e||(e=r('<div class=geo-tile-layer data-tile-layer="'+t.toFixed()+'"/>').css({"transform-origin":"0px 0px","line-height":0,"font-size":0}).get(0),this.canvas().append(e)),e}},this._updateSubLayers=function(t,e){var i=this.canvas(),n=parseInt(i.attr("lastlevel"),10),o=parseInt(i.attr("lastoffsetx")||0,10),a=parseInt(i.attr("lastoffsety")||0,10);if(n===t&&Math.abs(o-e.left)<65536&&Math.abs(a-e.top)<65536)return{x:o,y:a};var s=this.map(),u=this._tileOffset(t),l=parseInt((e.left+e.right-s.size().width)/2+u.x,10),h=parseInt((e.top+e.bottom-s.size().height)/2+u.y,10);return i.find(".geo-tile-layer").each(function(e,i){var n=r(i),o=parseInt(n.data("tileLayer"),10);n.css("transform","scale("+Math.pow(2,t-o)+")");var a=parseInt(l/Math.pow(2,t-o),10),s=parseInt(h/Math.pow(2,t-o),10),u=a-parseInt(n.attr("offsetx")||0,10),c=s-parseInt(n.attr("offsety")||0,10);n.attr({offsetx:a,offsety:s}),n.find(".geo-tile-container").each(function(t,e){r(e).css({left:parseInt(r(e).css("left"),10)-u+"px",top:parseInt(r(e).css("top"),10)-c+"px"})})}),i.attr({lastoffsetx:l,lastoffsety:h,lastlevel:t}),{x:l,y:h}},this._update=function(t){if(!t||!t.event||t.event.event!==s.zoom&&t.event.event!==s.rotate){var e,i=this.map(),n=i.bounds(void 0,null),o=i.zoom(),a=this._options.tileRounding(o);if(this._updateSubLayers){var u=this._getViewBounds(),l=this._updateSubLayers(a,u)||{x:0,y:0},h=this._tileOffset(a);if(null===this.renderer()){var c=Math.pow(2,o-a),d=i.rotation(),f=-h.x+-(u.left+u.right)/2+l.x,m=-h.y+-(u.bottom+u.top)/2+l.y,v=f+i.size().width/2,g=m+i.size().height/2;this.canvas().css({"transform-origin":""+-f+"px "+-m+"px"});var y="translate("+v+"px,"+g+"px)scale("+c+")";d&&(y+="rotate("+180*d/Math.PI+"deg)"),this.canvas().css("transform",y)}this.canvas().attr({scale:Math.pow(2,o-a),dx:-h.x+-(u.left+u.right)/2,dy:-h.y+-(u.bottom+u.top)/2,offsetx:l.x,offsety:l.y,rotation:i.rotation()})}e=this._getTiles(a,n,!0,!0),void 0!==e&&(this._tileTree={},e.forEach(function(t){if(t.fetched())this.drawTile(t),this._setTileTree(t);else if(t._queued){var e=this._queue?this._queue.get(t):-1;e>=0&&this._queue.add(t)}else t.then(function(){if(!p&&t===this.cache.get(t.toString())){var e=i.zoom(),n=this._options.tileRounding(e),r=this._getViewBounds();if(this._canPurge(t,r,n))return void this.remove(t);this.drawTile(t),this._setTileTree(t)}}.bind(this)),this.addPromise(t),t._queued=!0}.bind(this)),r.when.apply(r,e).done(function(){var t=this.map(),e=t.zoom(),i=this._options.tileRounding(e);this._purge(i,!0)}.bind(this)))}},this._setTileTree=function(t){if(!this._options.keepLower){var e=t.index;this._tileTree[e.level]=this._tileTree[e.level]||{},this._tileTree[e.level][e.x]=this._tileTree[e.level][e.x]||{},this._tileTree[e.level][e.x][e.y]=t}},this._getTileTree=function(t){return((this._tileTree[t.level]||{})[t.x]||{})[t.y]||null},this._isCovered=function(t){var e=t.index.level,i=t.index.x,n=t.index.y,r=[];return(r=this._getTileTree({level:e-1,x:Math.floor(i/2),y:Math.floor(n/2)}))?[r]:(r=[this._getTileTree({level:e+1,x:2*i,y:2*n}),this._getTileTree({level:e+1,x:2*i+1,y:2*n}),this._getTileTree({level:e+1,x:2*i,y:2*n+1}),this._getTileTree({level:e+1,x:2*i+1,y:2*n+1})],r.every(function(t){return null!==t})?r:null)},this._outOfBounds=function(t,e){var i=this._tileOffset(t.index.level),n=1;return t.index.level!==e.level&&(n=Math.pow(2,(e.level||0)-(t.index.level||0))),(t.bottom-i.y)*n<e.top||(t.left-i.x)*n>e.right||(t.top-i.y)*n>e.bottom||(t.right-i.x)*n<e.left},this._canPurge=function(t,e,i,n){if(this._options.keepLower){if(i=i||0,i<t.index.level&&t.index.level!==this._options.minLevel)return!0;if(t.index.level===this._options.minLevel&&!this._options.wrapX&&!this._options.wrapY)return!1}else if((n||this._isCovered(t))&&i!==t.index.level)return!0;return!!e&&this._outOfBounds(t,e)},this.displayToLevel=function(t,e){var i=this.map(),n=i.zoom(),r=this._options.tileRounding(n),o=i.unitsPerPixel(void 0===e?r:e);if(void 0===t){var a=i.size();t={x:a.width/2,y:a.height/2}}var s=i.displayToGcs(t,this._options.gcs||null),u={x:s.x/o,y:this._topDown()*s.y/o};return u},this.url=function(t){return void 0===t?this._options.originalUrl:t===this._options.originalUrl?this:(this._options.originalUrl=t,"string"===r.type(t)&&(t=n(t)),this._options.url=t,this.reset(),this.map().draw(),this)},this.subdomains=function(t){return void 0===t?this._options.subdomains:(t&&("string"===r.type(t)&&(t=t.indexOf(",")>=0?t.split(","):t.split("")),this._options.subdomains=t,this.reset(),this.map().draw()),this)},this._tileOffset=function(t){return void 0===y[t]&&(y[t]=this._options.tileOffset(t)),y[t]},this._init=function(){var t;if(m.apply(this,arguments),null===this.renderer())for(t=0;t<=this._options.maxLevel;t+=1)this._getSubLayer(t);return this},this._exit=function(){return this.reset(),v.apply(this,arguments),p=!0,this},c("tile",this),this};return a.defaults={minLevel:0,maxLevel:18,tileOverlap:0,tileWidth:256,tileHeight:256,wrapX:!0,wrapY:!1,url:null,subdomains:"abc",tileOffset:function(t){return{x:0,y:0}},topDown:!1,keepLower:!0,tileRounding:Math.round,attribution:"",animationDuration:0},r(a,o),a}()},function(t,e){t.exports=function(){"use strict";var t=function(e){return this instanceof t?(e=e||{},this._size=e.size||64,Object.defineProperty(this,"size",{get:function(){return this._size},set:function(t){for(;this._atime.length>t;)this.remove(this._atime[this._atime.length-1]);this._size=t}}),Object.defineProperty(this,"length",{get:function(){return this._atime.length}}),this._access=function(t){return this._atime.indexOf(t)},this.remove=function(t){var e="string"==typeof t?t:t.toString();return e in this._cache&&(this._atime.splice(this._access(e),1),delete this._cache[e],!0)},this.clear=function(){return this._cache={},this._atime=[],this},this.get=function(t,e){return t="string"==typeof t?t:t.toString(),t in this._cache?(e||(this._atime.splice(this._access(t),1),this._atime.unshift(t)),this._cache[t]):null},this.add=function(t,e,i){this.remove(t);var n=t.toString();this._cache[n]=t,this._atime.unshift(n),i||this.purge(e)},this.purge=function(t){for(var e;this._atime.length>this.size;){e=this._atime.pop();var i=this._cache[e];t&&t(i),delete this._cache[e]}},this.clear(),this):new t(e)};return t;
}()},function(t,e,i){var n=i(1),r=i(4),o=i(127),a=function(t){"use strict";if(!(this instanceof a))return new a(t);t=t||{},o.call(this,t);var e=this,i=void 0===t.position?[]:t.position,r=this._init;return this.position=function(t){return void 0===t?i:(i=t,e.dataTime().modified(),e.modified(),e)},this._init=function(t){r.call(e,t);var o=n.extend({},{strokeWidth:function(){return 1},strokeColor:function(){return{r:1,g:1,b:1}}},void 0===t.style?{}:t.style);e.style(o),i&&e.dataTime().modified()},this._init(t),this};r(a,o),t.exports=a},function(t,e,i){var n=i(4),r=i(127),o=function(t){"use strict";if(!(this instanceof o))return new o(t);t=t||{},r.call(this,t);var e=i(1),n=i(129),a=i(124),s=i(125),u=i(120),l=i(225),h=this,c=this._init,d=null,f=n(),p=this.data,m=0,v=t.clustering,g=null,y=[],x=null,_=!1;return this.clustering=function(t){return void 0===t?v:(v&&!t?(g=null,v=!1,p(y),y=null):!v&&t&&(v=!0,h._clusterData()),h)},this._clusterData=function(){if(v){var t=v===!0?{radius:.01}:v,e=h.position();g=new a(t,h.layer().width(),h.layer().height()),y.forEach(function(t,i){var n=u.normalizeCoordinates(e(t,i));n.index=i,g.addPoint(n)}),x=null,h._handleZoom(h.layer().map().zoom())}},this._handleZoom=function(t){var e=Math.floor(t);if(v&&e!==x){x=e;var i=g.points(e).map(function(t){return y[t.index]});g.clusters(e).forEach(function(t){t.__cluster=!0,t.__data=[],t.obj.each(function(e){t.__data.push(y[e.index])}),i.push(t)}),_=!0,h.data(i),h.draw()}},this.position=function(t){return void 0===t?h.style("position"):(t=u.ensureFunction(t),h.style("position",function(e,i){return e.__cluster?e:t(e,i)}),h.dataTime().modified(),h.modified(),h)},this._updateRangeTree=function(){if(!(f.getMTime()>=h.dataTime().getMTime())){var t,e,i=h.style.get("radius"),n=h.style.get("stroke"),r=h.style.get("strokeWidth");e=h.position(),m=0,t=h.data().map(function(t,o){var a=e(t);return a.idx=o,m=Math.max(m,i(t,o)+(n(t,o)?r(t,o):0)),a}),d=new l.RangeTree(t),f.modified()}},this.pointSearch=function(t){var e,i,n,r,o,a,s,u=[],c=[],f=[],p=h.style.get("stroke"),v=h.style.get("strokeWidth"),g=h.style.get("radius");return h.selectionAPI()?(n=h.data(),n&&n.length?(o=h.layer().map(),a=o.gcsToDisplay(t),s=[o.displayToGcs({x:a.x-m,y:a.y-m}),o.displayToGcs({x:a.x+m,y:a.y-m}),o.displayToGcs({x:a.x-m,y:a.y+m}),o.displayToGcs({x:a.x+m,y:a.y+m})],e={x:Math.min(s[0].x,s[1].x,s[2].x,s[3].x),y:Math.min(s[0].y,s[1].y,s[2].y,s[3].y)},i={x:Math.max(s[0].x,s[1].x,s[2].x,s[3].x),y:Math.max(s[0].y,s[1].y,s[2].y,s[3].y)},r=new l.Box(l.vect(e.x,e.y),l.vect(i.x,i.y)),h._updateRangeTree(),d.search(r).forEach(function(t){u.push(t.idx)}),u.forEach(function(t){var e,i,r,s,u=n[t],l=h.position()(u,t);r=g(n[t],t),r+=p(n[t],t)?v(n[t],t):0,s=r*r,l=o.gcsToDisplay(l),e=l.x-a.x,i=l.y-a.y,e*e+i*i<=s&&(c.push(u),f.push(t))}),{data:c,index:f}):{found:[],index:[]}):[]},this.boxSearch=function(t,e){var i=h.position(),n=[];return h.data().forEach(function(r,o){var a=i(r);a.x>=t.x&&a.x<=e.x&&a.y>=t.y&&a.y<=e.y&&n.push(o)}),n},this.data=function(t){return void 0===t?p():(v&&!_?(y=t,h._clusterData()):p(t),_=!1,h)},this._boundingBox=function(t){var e,i;return e=h.position()(t),e=h.layer().map().gcsToDisplay(e),i=h.style().radius(t),{min:{x:e.x-i,y:e.y-i},max:{x:e.x+i,y:e.y+i}}},this._init=function(t){c.call(h,t);var i=e.extend({},{radius:5,stroke:!0,strokeColor:{r:.851,g:.604,b:0},strokeWidth:1.25,strokeOpacity:1,fillColor:{r:1,g:.839,b:.439},fill:!0,fillOpacity:.8,sprites:!1,sprites_image:null,position:function(t){return t}},void 0===t.style?{}:t.style);void 0!==t.position&&(i.position=t.position),h.style(i),h.dataTime().modified(),h.geoOn(s.zoom,function(t){h._handleZoom(t.zoomLevel)})},h};o.create=function(t,e,i){"use strict";return i.type="point",r.create(t,i)},n(o,r),t.exports=o},function(t,e){/**
	 * @license
	 * Includes several support classes adapted from wigglemaps.
	 *
	 * https://github.com/dotskapes/wigglemaps
	 *
	 * Copyright 2013 Preston and Krejci (dotSkapes Virtual Lab)
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 *   http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software
	 * distributed under the License is distributed on an "AS IS" BASIS,
	 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	 * See the License for the specific language governing permissions and
	 * limitations under the License.
	 */
!function(){"use strict";function e(t,e){return new a(t,e)}var i=function(t,e,r,o){this.data=t[o],this.left=null,this.right=null,e!==o&&(this.left=new i(t,e,o-1,parseInt((e+(o-1))/2,10))),r!==o&&(this.right=new i(t,o+1,r,parseInt((r+(o+1))/2,10))),this.elem=t,this.start=e,this.end=r,this.subtree=null,this.search=n},n=function(t,e){var i=this,n=function(t){return t.x_in(i.elem[i.start])&&t.x_in(i.elem[i.end])},r=function(t,e,n){return t.y_in(i.subtree[e])&&t.y_in(i.subtree[n])},o=function(t,e,n,a,s){if(r(e,n,a))for(var u=n;u<=a;u++)t.push(i.subtree[u]);else e.y_in(i.subtree[s])&&t.push(i.subtree[s]),e.y_left(i.subtree[s])?s!==a&&o(t,e,s+1,a,parseInt((a+(s+1))/2,10)):e.x_right(i.subtree[s])?s!==n&&o(t,e,n,s-1,parseInt((n+(s-1))/2,10)):(s!==a&&o(t,e,s+1,a,parseInt((a+(s+1))/2,10)),s!==n&&o(t,e,n,s-1,parseInt((n+(s-1))/2,10)))};return n(e)?(this.subtree||(this.subtree=this.elem.slice(this.start,this.end+1),this.subtree.sort(function(t,e){return t.y-e.y})),void o(t,e,0,this.subtree.length-1,parseInt((this.subtree.length-1)/2,10))):(e.contains(this.data)&&t.push(this.data),void(e.x_left(this.data)?this.right&&this.right.search(t,e):e.x_right(this.data)?this.left&&this.left.search(t,e):(this.left&&this.left.search(t,e),this.right&&this.right.search(t,e))))},r=function(t){t.sort(function(t,e){return t.x-e.x}),t.length>0?this.root=new i(t,0,t.length-1,parseInt((t.length-1)/2,10)):this.root=null,this.search=function(t){if(!this.root)return[];var e=t.clone(),i=[];return this.root.search(i,e),i}},o=function(t,i){this.min=t.clone(),this.max=i.clone(),this.contains=function(e){return t.x<=e.x&&i.x>=e.x&&t.y<=e.y&&i.y>=e.y},this.x_in=function(e){return t.x<=e.x&&i.x>=e.x},this.x_left=function(e){return t.x>=e.x},this.x_right=function(t){return i.x<=t.x},this.y_in=function(e){return t.y<=e.y&&i.y>=e.y},this.y_left=function(e){return t.y>=e.y},this.y_right=function(t){return i.y<=t.y},this.area=function(){return(this.max.x-this.min.x)*(this.max.y-this.min.y)},this.height=function(){return this.max.y-this.min.y},this.width=function(){return this.max.x-this.min.x},this.vertex=function(t){switch(t){case 0:return this.min.clone();case 1:return new e(this.max.x,this.min.y);case 2:return this.max.clone();case 3:return new e(this.min.x,this.max.y);default:throw"Index out of bounds: "+t}},this.intersects=function(t){for(var i=0;i<4;i++)for(var n=0;n<4;n++)if(e.intersects(this.vertex(i),this.vertex((i+1)%4),t.vertex(n),t.vertex((n+1)%4)))return!0;return!!(this.contains(t.min)&&this.contains(t.max)&&this.contains(new e(t.min.x,t.max.y))&&this.contains(new e(t.max.x,t.min.y)))||!!(t.contains(this.min)&&t.contains(this.max)&&t.contains(new e(this.min.x,this.max.y))&&t.contains(new e(this.max.x,this.min.y)))},this.union=function(t){this.min.x=Math.min(this.min.x,t.min.x),this.min.y=Math.min(this.min.y,t.min.y),this.max.x=Math.max(this.max.x,t.max.x),this.max.y=Math.max(this.max.y,t.max.y)},this.centroid=function(){return new e((this.max.x+this.min.x)/2,(this.max.y+this.min.y)/2)},this.clone=function(){return new o(t,i)}},a=function(t,e){this.x=t,this.y=e,this.add=function(t){return this.x+=t.x,this.y+=t.y,this},this.sub=function(t){return this.x-=t.x,this.y-=t.y,this},this.scale=function(t){return this.x*=t,this.y*=t,this},this.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},this.normalize=function(){var t=this.length();return 0===t?this:(this.x/=t,this.y/=t,this)},this.div=function(t){return this.x/=t.x,this.y/=t.y,this},this.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},this.zero=function(t){return t=t||0,this.length()<=t},this.dot=function(t){return this.x*t.x+this.y*t.y},this.cross=function(t){return this.x*t.y-this.y*t.x},this.rotate=function(t){var e=Math.cos(t),i=Math.sin(t);return xp=e*this.x-i*this.y,yp=i*this.x+e*this.y,this.x=xp,this.y=yp,this},this.clone=function(){return new a(this.x,this.y)},this.array=function(){return[this.x,this.y]}};e.scale=function(t,e){return t.clone().scale(e)},e.add=function(t,e){return t.clone().add(e)},e.sub=function(t,e){return t.clone().sub(e)},e.dist=function(t,e){return t.clone().sub(e).length()},e.dir=function(t,e){return t.clone().sub(e).normalize()},e.dot=function(t,e){return t.x*e.x+t.y*e.y},e.cross=function(t,e){return t.x*e.y-t.y*e.x},e.left=function(t,i,n,r){r||(r=0);var o=e.sub(i,t),a=e.sub(n,t);return e.cross(o,a)>=-r},e.intersects=function(t,i,n,r,o){return o||(o=0),e.left(t,i,n,o)!=e.left(t,i,r,o)&&e.left(n,r,i,o)!=e.left(n,r,t,o)},e.intersect2dt=function(t,e,i,n){var r=t.x*(n.y-i.y)+e.x*(i.y-n.y)+n.x*(e.y-t.y)+i.x*(t.y-e.y);if(0===r)return 1/0;var o=(t.x*(n.y-i.y)+i.x*(t.y-n.y)+n.x*(i.y-t.y),-(t.x*(i.y-e.y)+e.x*(t.y-i.y)+i.x*(e.y-t.y))),a=o/r;return a},e.intersect2dpos=function(t,i,n,r){var o=t.x*(r.y-n.y)+i.x*(n.y-r.y)+r.x*(i.y-t.y)+n.x*(t.y-i.y);if(0===o)return 1/0;var a=t.x*(r.y-n.y)+n.x*(t.y-r.y)+r.x*(n.y-t.y),s=a/o,u=e.sub(i,t);return u.scale(s),e.add(t,u)},e.rotate=function(t,i){var n=Math.cos(i),r=Math.sin(i);xp=n*t.x-r*t.y,yp=r*t.x+n*t.y;var o=new e(xp,yp);return o},e.normalize=function(t){return t.clone().normalize()},t.exports={Box:o,vect:e,RangeTree:r}}()},function(t,e,i){var n=i(1),r=i(4),o=i(127),a=function(t){"use strict";function e(){var t=h.position(),e=h.polygon();g=h.data().map(function(i,n){var r,o,a,s,u,l,c,d=e(i);for(s=d.outer||(d instanceof Array?d:[]),r=new Array(s.length),u=0;u<s.length;u+=1)r[u]=t.call(h,s[u],u,i,n),l=r[u].x||r[u][0]||0,c=r[u].y||r[u][1]||0,u?(l<a.min.x&&(a.min.x=l),c<a.min.y&&(a.min.y=c),l>a.max.x&&(a.max.x=l),c>a.max.y&&(a.max.y=c)):a={min:{x:l,y:c},max:{x:l,y:c}};return o=(d.inner||[]).map(function(e){s=e||[];var r=new Array(s.length);for(u=0;u<s.length;u+=1)r[u]=t.call(h,s[u],u,i,n);return r}),{outer:r,inner:o,range:a}})}if(!(this instanceof a))return new a(t);t=t||{},o.call(this,t);var r,s,u,l=i(120),h=this,c=this._init,d=this._exit,f=this.data,p=this.draw,m=this.modified,v=this.style,g=[];return s=void 0===t.polygon?function(t){return t}:t.polygon,r=void 0===t.position?function(t){return t}:t.position,this.data=function(t){var i=f(t);return void 0!==t&&e(),i},this.polygon=function(t){return void 0===t?s:(s=t,h.dataTime().modified(),h.modified(),e(),h)},this.position=function(t){return void 0===t?r:(r=t,h.dataTime().modified(),h.modified(),e(),h)},this.pointSearch=function(t){var e=[],i=[],n=h.data();return g.forEach(function(r,o){var a=l.pointInPolygon(t,r.outer,r.inner,r.range);a&&(i.push(o),e.push(n[o]))}),{index:i,found:e}},this.style=function(t,e){var i=v.apply(this,arguments);return void 0===t||"string"==typeof t&&void 0===e||this._checkForStroke(),i},this.style.get=v.get,this._getLoopData=function(t,e,i,n){var r,o,a,s=[];for(r=0;r<i.length;r+=1)s.push([i[r],r,t,e]);return o=n(i[0],0,t,e),a=n(i[i.length-1],i.length-1,t,e),o.x===a.x&&o.y===a.y&&o.z===a.z||s.push([i[0],0,t,e]),s},this._checkForStroke=function(){if(v("stroke")===!1)return void(u&&h.layer()&&(h.layer().deleteFeature(u),u=null));if(h.layer()){u||(u=h.layer().createFeature("line",{selectionAPI:!1}));var t=h.style();u.style({strokeWidth:t.strokeWidth,strokeStyle:t.strokeStyle,strokeColor:t.strokeColor,strokeOpacity:function(t){return h.style.get("stroke")(t[2],t[3])?h.style.get("strokeOpacity")(t[0],t[1],t[2],t[3]):0}});var e=this.data(),i=this.position();if(e!==u._lastData||i!==u._posFunc){var n,r,o,a=[];for(n=0;n<e.length;n+=1)r=h.polygon()(e[n],n),o=r.outer||(r instanceof Array?r:[]),a.push(h._getLoopData(e[n],n,o,i)),r.inner&&r.inner.forEach(function(t){a.push(h._getLoopData(e[n],n,t,i))});u.position(function(t,e,n,r){return i(t[0],t[1],t[2],t[3])}),u.data(a),u._lastData=e,u._lastPosFunc=i}}},this.draw=function(){var t=p();return u&&u.draw(),t},this.modified=function(){var t=m();return u&&u.modified(),t},this._exit=function(){u&&h.layer()&&(h.layer().deleteFeature(u),u=null),d()},this._init=function(t){t=t||{},c.call(h,t);var e=n.extend({},{fill:!0,fillColor:{r:0,g:.5,b:.5},fillOpacity:1,stroke:!1,strokeWidth:1,strokeStyle:"solid",strokeColor:{r:0,g:1,b:1},strokeOpacity:1},void 0===t.style?{}:t.style);h.style(e),r&&h.dataTime().modified(),this._checkForStroke()},this};a.create=function(t,e){"use strict";return e=e||{},e.type="polygon",o.create(t,e)},r(a,o),t.exports=a},function(t,e,i){var n=i(1),r=i(4),o=i(127),a=i(147),s=function(t){"use strict";if(!(this instanceof s))return new s(t);t=t||{},o.call(this,t);var e,i,r,u,l,h,c,d=this,f=this._init;return e=t.position||function(t){return t},i=t.intensity||function(t){return 1},r=void 0!==t.maxIntensity?t.maxIntensity:null,u=void 0!==t.minIntensity?t.minIntensity:null,h=void 0!==t.binned?t.binned:"auto",l=t.updateDelay?parseInt(t.updateDelay,10):1e3,this.maxIntensity=function(t){return void 0===t?r:(r=t,d.dataTime().modified(),d.modified(),d)},this.minIntensity=function(t){return void 0===t?u:(u=t,d.dataTime().modified(),d.modified(),d)},this.updateDelay=function(t){return void 0===t?l:(l=parseInt(t,10),d)},this.binned=function(t){return void 0===t?h:("true"===t?t=!0:"false"===t?t=!1:"auto"!==t&&t!==!0&&t!==!1&&(t=parseInt(t,10),(t<=0||isNaN(t))&&(t=!1)),h=t,d.dataTime().modified(),d.modified(),d)},this.position=function(t){return void 0===t?e:(e=t,d.dataTime().modified(),d.modified(),d)},this.gcsPosition=function(){return this._update(),c},this.intensity=function(t){return void 0===t?i:(i=t,d.dataTime().modified(),d.modified(),d)},this._init=function(t){f.call(d,t);var i=n.extend({},{radius:10,blurRadius:10,gaussian:!0,color:{0:{r:0,g:0,b:0,a:0},.25:{r:0,g:0,b:1,a:.5},.5:{r:0,g:1,b:1,a:.6},.75:{r:1,g:1,b:0,a:.7},1:{r:1,g:0,b:0,a:.8}}},void 0===t.style?{}:t.style);d.style(i),e&&d.dataTime().modified()},this._build=function(){var t=d.data(),e=null,i=[],n=null===r||void 0===r,o=null===u||void 0===u;return t.forEach(function(t){i.push(d.position()(t)),(n||o)&&(e=d.intensity()(t),null!==r&&void 0!==r||(r=e),null!==u&&void 0!==u||(u=e),n&&e>r&&(r=e),o&&e<u&&(u=e))}),o&&n&&u===r&&(u-=1),c=a.transformCoordinates(d.gcs(),d.layer().map().gcs(),i),d.buildTime().modified(),d},this._init(t),this};r(s,o),t.exports=s},function(t,e,i){var n=i(4),r=i(127),o=function(t){"use strict";if(!(this instanceof o))return new o(t);var e=i(1);t=t||{},r.call(this,t);var n=this,a=this._init,s=this.style;this.origin=function(t){return void 0===t?s("origin"):(s("origin",t),n.dataTime().modified(),n.modified(),n)},this.delta=function(t){return void 0===t?s("delta"):(s("delta",t),n.dataTime().modified(),n.modified(),n)},this._init=function(t){a.call(n,t);var i=e.extend({},{strokeColor:"black",strokeWidth:2,strokeOpacity:1,originStyle:"none",endStyle:"arrow",origin:{x:0,y:0,z:0},delta:function(t){return t},scale:null},void 0===t.style?{}:t.style);void 0!==t.origin&&(i.origin=t.origin),n.style(i),n.dataTime().modified()}};n(o,r),t.exports=o},function(t,e,i){t.exports="0.10.1"},function(t,e,i){t.exports="daf9c26929fd4b87a00f0a49d813854f358b082e"},function(t,e,i){var n=i(125);n.d3={rescale:i(232)},t.exports={graphFeature:i(233),lineFeature:i(234),object:i(235),pathFeature:i(237),pointFeature:i(238),quadFeature:i(239),renderer:i(240),tileLayer:i(241),uniqueID:i(236),vectorFeature:i(242)}},function(t,e){t.exports="geo_d3_rescale"},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(141),a=function(t){"use strict";var e=this;return this instanceof a?(o.call(this,t),this.select=function(){var t=e.renderer(),i={},n=e.nodeFeature(),r=e.linkFeatures();return i.nodes=t.select(n._d3id()),i.links=r.map(function(e){return t.select(e._d3id())}),i},this):new a(t)};n(a,o),r("d3","graph",a),t.exports=a},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(145),a=function(t){"use strict";if(!(this instanceof a))return new a(t);var e=i(132),n=i(235),r=i(129),s=i(120);t=t||{},o.call(this,t),n.call(this);var u=this,l=this._init,h=r(),c=this._update;return this._init=function(t){return l.call(u,t),u},this._build=function(){var t=u.data()||[],i=u.style(),n=u.renderer(),r=u.position(),o=e.svg.line().x(function(t){return u.featureGcsToDisplay(t).x}).y(function(t){return u.featureGcsToDisplay(t).y});return c.call(u),i.fill=function(){return!1},t.forEach(function(t,e){function a(i){return s.isFunction(i)?function(){return i(c[0],0,t,e)}:i}var l,h,c=u.line()(t,e),d={};for(h in i)i.hasOwnProperty(h)&&(d[h]=a(i[h]));l={data:[c.map(function(i,n){return r(i,n,t,e)})],append:"path",attributes:{d:o},id:u._d3id()+e,classes:["d3LineFeature","d3SubLine-"+e],style:d},n._drawFeatures(l)}),h.modified(),u.updateTime().modified(),u},this._update=function(){return c.call(u),u.getMTime()>=h.getMTime()&&u._build(),u},this._init(t),this};n(a,o);var s={};s[o.capabilities.basic]=!0,s[o.capabilities.multicolor]=!1,r("d3","line",a,s),t.exports=a},function(t,e,i){var n=i(4),r=i(128),o=function(t){"use strict";var e=i(5),n=i(236);if(!(this instanceof e))return new o(t);r.call(this);var a="d3-"+n(),s=this._exit,u=this,l=this.draw;return this._d3id=function(){return a},this.select=function(){return u.renderer().select(u._d3id())},this.draw=function(){return u._update(),l(),u},this._exit=function(){u.renderer()._removeFeature(u._d3id()),s()},this};n(o,r),t.exports=o},function(t,e){var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",n=8,r=function(){var t,e=[];for(e.length=n,t=0;t<n;t+=1)e[t]=i.charAt(Math.floor(Math.random()*i.length));return e.join("")};t.exports=r},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(223),a=function(t){"use strict";if(!(this instanceof a))return new a(t);var e=i(1),n=i(132),r=i(235),s=i(129);t=t||{},o.call(this,t),r.call(this);var u=this,l=this._init,h=s(),c=this._update,d={};return d.style={},this._init=function(t){return l.call(u,t),u},this._build=function(){var t,i,r=u.data()||[],o=u.style();return c.call(u),i=function(t){var e={source:t.source,target:t.target};return n.svg.diagonal()(e)},t=[],r.forEach(function(e,i){var n,o;i<r.length-1&&(n=e,o=r[i+1],t.push({source:u.featureGcsToDisplay(n),target:u.featureGcsToDisplay(o)}))}),d.data=t,d.attributes={d:i},d.id=u._d3id(),d.append="path",d.classes=["d3PathFeature"],d.style=e.extend({fill:function(){return!1},fillColor:function(){return{r:0,g:0,b:0}}},o),u.renderer()._drawFeatures(d),h.modified(),u.updateTime().modified(),u},this._update=function(){return c.call(u),u.dataTime().getMTime()>=h.getMTime()&&u._build(),u},this._init(t),this};n(a,o),r("d3","path",a),t.exports=a},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(224),a=function(t){"use strict";if(!(this instanceof a))return new a(t);var e=i(235),n=i(129);t=t||{},o.call(this,t),e.call(this);var r=this,s=this._init,u=this._update,l=n(),h={};return this._init=function(t){return s.call(r,t),r},this._build=function(){var t=r.data(),e=r.style.get(),i=r.renderer(),n=r.position();return u.call(r),t||(t=[]),h.id=r._d3id(),h.data=t,h.append="circle",h.attributes={r:i._convertScale(e.radius),cx:function(t){return r.featureGcsToDisplay(n(t)).x},cy:function(t){return r.featureGcsToDisplay(n(t)).y}},h.style=e,h.classes=["d3PointFeature"],r.renderer()._drawFeatures(h),l.modified(),r.updateTime().modified(),r},this._update=function(){return u.call(r),r.getMTime()>=l.getMTime()&&r._build(),r},this._init(t),this};n(a,o),r("d3","point",a),t.exports=a},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(218),a=function(t){"use strict";if(!(this instanceof a))return new a(t);var e=i(1),n=i(132),r=i(235);o.call(this,t),r.call(this);var s,u=this,l=this._exit,h=this._init,c=this._update;return this._build=function(){if(this.position()){var t=this.renderer(),i=t.layer().map();s=this._generateQuads();var r=[];e.each(s.clrQuads,function(t,e){r.push({type:"clr",quad:e,zIndex:e.pos[2]})}),e.each(s.imgQuads,function(t,e){e.image&&r.push({type:"img",quad:e,zIndex:e.pos[2]})});var o={id:this._d3id(),data:r,dataIndex:function(t){return t.quad.quadId},append:function(t){var e=this.namespaceURI,i="clr"===t.type?"polygon":"image";return e?document.createElementNS(e,i):document.createElement(i)},attributes:{fill:function(t){return"clr"===t.type?n.rgb(255*t.quad.color.r,255*t.quad.color.g,255*t.quad.color.b):void(1!==t.quad.opacity&&n.select(this).style("opacity",t.quad.opacity))},height:function(t){return"clr"===t.type?void 0:1},points:function(e){if("clr"===e.type&&!e.points){var n,r=[];for(n=0;n<e.quad.pos.length;n+=3){var o={x:e.quad.pos[n],y:e.quad.pos[n+1],z:e.quad.pos[n+2]};o=i.gcsToDisplay(o,null),o=t.baseToLocal(o),r.push(""+o.x+","+o.y)}e.points=r[0]+" "+r[1]+" "+r[3]+" "+r[2]}return"clr"===e.type?e.points:void 0},preserveAspectRatio:function(t){return"clr"===t.type?void 0:"none"},reference:function(t){return t.quad.reference},stroke:!1,transform:function(e){if("img"===e.type&&e.quad.image&&!e.svgTransform){var n,r,o,a,s=[],u=-1,l=e.quad.image.width,h=e.quad.image.height;for(o=0;o<e.quad.pos.length;o+=3){var c={x:e.quad.pos[o],y:e.quad.pos[o+1],z:e.quad.pos[o+2]};c=i.gcsToDisplay(c,null),c=t.baseToLocal(c),s.push(c)}for(o=0;o<4;o+=1)n=Math.abs(s[(o+1)%4].x*(s[(o+2)%4].y-s[(o+3)%4].y)+s[(o+2)%4].x*(s[(o+3)%4].y-s[(o+1)%4].y)+s[(o+3)%4].x*(s[(o+1)%4].y-s[(o+2)%4].y))/2,n>u&&(u=n,r=o);e.svgTransform=[3===r||2===r?s[1].x-s[0].x:s[3].x-s[2].x,3===r||2===r?s[1].y-s[0].y:s[3].y-s[2].y,0===r||2===r?s[1].x-s[3].x:s[0].x-s[2].x,0===r||2===r?s[1].y-s[3].y:s[0].y-s[2].y,2===r?s[3].x+s[0].x-s[1].x:s[2].x,2===r?s[3].y+s[0].y-s[1].y:s[2].y],Math.abs(e.svgTransform[1]/l)<1e-6&&Math.abs(e.svgTransform[2]/h)<1e-6&&(a=e.svgTransform[0]/l,e.svgTransform[4]=Math.round(e.svgTransform[4]/a)*a,a=e.svgTransform[3]/h,e.svgTransform[5]=Math.round(e.svgTransform[5]/a)*a)}return"img"===e.type&&e.quad.image?"matrix("+e.svgTransform.join(" ")+")":void 0},width:function(t){return"clr"===t.type?void 0:1},x:function(t){return"clr"===t.type?void 0:0},"xlink:href":function(t){return"clr"!==t.type&&t.quad.image?t.quad.image.src:void 0},y:function(t){return"clr"===t.type?void 0:0}},style:{fillOpacity:function(t){return"clr"===t.type?t.quad.opacity:void 0}},onlyRenderNew:!this.style("previewColor")&&!this.style("previewImage"),sortByZ:!0,classes:["d3QuadFeature"]};t._drawFeatures(o),this.buildTime().modified()}},this._update=function(){return c.call(u),(u.buildTime().getMTime()<=u.dataTime().getMTime()||u.buildTime().getMTime()<u.getMTime())&&u._build(),u},this._init=function(){h.call(u,t)},this._exit=function(){l.call(u)},u._init(t),this};n(a,o);var s={};s[o.capabilities.color]=!0,s[o.capabilities.image]=!0,s[o.capabilities.imageFull]=!1,r("d3","quad",a,s),t.exports=a},function(t,e,i){var n=i(4),r=i(131).registerRenderer,o=i(136),a=function(t){"use strict";function e(t,e){var i;for(i in e)e.hasOwnProperty(i)&&t.attr(i,e[i])}function n(t,e){function i(){return e.fill.apply(p,arguments)?null:"none"}function n(){return e.stroke.apply(p,arguments)?null:"none"}var r,o,a;for(r in e)e.hasOwnProperty(r)&&(a=null,o=null,"strokeColor"===r?(o="stroke",a=p._convertColor(e[r],e.stroke)):"stroke"===r&&e[r]&&!e.hasOwnProperty("strokeColor")?(o="stroke",a=n):"strokeWidth"===r?(o="stroke-width",a=p._convertScale(e[r])):"strokeOpacity"===r?(o="stroke-opacity",a=e[r]):"fillColor"===r?(o="fill",a=p._convertColor(e[r],e.fill)):"fill"!==r||e.hasOwnProperty("fillColor")?"fillOpacity"===r&&(o="fill-opacity",a=e[r]):(o="fill",a=i),o&&t.style(o,a))}function r(t){return t?E.select(".group-"+t):E.select(".group-"+p._d3id())}function s(){var t=p.layer(),e=t.map(),i=e.size().width,n=e.size().height;if(y=i,x=n,!y||!x)throw"Map layer has size 0";_=Math.pow(i*i+n*n,.5),g={upperLeft:e.displayToGcs({x:0,y:0},null),lowerRight:e.displayToGcs({x:i,y:n},null),center:e.displayToGcs({x:i/2,y:n/2},null)}}var u=i(132),l=i(235),h=i(120),c=i(125),d=i(232);if(!(this instanceof a))return new a(t);o.call(this,t);var f=this._exit;l.call(this,t),t=t||{};var p=this,m=null,v={},g=null,y=null,x=null,_=null,b=1,w={dx:0,dy:0,rx:0,ry:0,rotation:0},M=null,T={},A={},E=null,C=null;return this._convertColor=function(t,e){return t=h.ensureFunction(t),e=e||function(){return!0},function(){var i="none";return e.apply(p,arguments)&&(i=t.apply(p,arguments),i.hasOwnProperty("r")&&i.hasOwnProperty("g")&&i.hasOwnProperty("b")&&(i=u.rgb(255*i.r,255*i.g,255*i.b))),i}},this._convertScale=function(t){return t=h.ensureFunction(t),function(){return t.apply(p,arguments)/b}},this._setTransform=function(){if(g||s(),m){var t,e,i,n,o,a,u=p.layer(),l=u.map(),h=l.gcsToDisplay(g.upperLeft,null),c=l.gcsToDisplay(g.lowerRight,null),d=l.gcsToDisplay(g.center,null),f=r();i=Math.sqrt(Math.pow(c.y-h.y,2)+Math.pow(c.x-h.x,2))/_,n=l.rotation(),o=-y/2,a=-x/2,t=i*o+d.x,e=i*a+d.y,n||(t=Math.round(t),e=Math.round(e));var v="matrix("+[i,0,0,i,t,e].join()+")";n&&(v+=" rotate("+[180*n/Math.PI,-o,-a].join()+")"),f.attr("transform",v),b=i,w.dx=t,w.dy=e,w.rx=o,w.ry=a,w.rotation=n}},this.baseToLocal=function(t){if(t={x:(t.x-w.dx)/b,y:(t.y-w.dy)/b},w.rotation){var e=Math.sin(-w.rotation),i=Math.cos(-w.rotation),n=t.x+w.rx,r=t.y+w.ry;t={x:n*i-r*e-w.rx,y:n*e+r*i-w.ry}}return t},this.localToBase=function(t){if(w.rotation){var e=Math.sin(w.rotation),i=Math.cos(w.rotation),n=t.x+w.rx,r=t.y+w.ry;t={x:n*i-r*e-w.rx,y:n*e+r*i-w.ry}}return t={x:t.x*b+w.dx,y:t.y*b+w.dy}},this._init=function(t){if(!p.canvas()){var e;t.widget=t.widget||!1,E="d3Parent"in t?u.select(t.d3Parent).append("svg"):u.select(p.layer().node().get(0)).append("svg"),C=E.append("defs");var i=C.append("filter").attr("id","geo-highlight").attr("x","-100%").attr("y","-100%").attr("width","300%").attr("height","300%");i.append("feMorphology").attr("operator","dilate").attr("radius",2).attr("in","SourceAlpha").attr("result","dilateOut"),i.append("feGaussianBlur").attr("stdDeviation",5).attr("in","dilateOut").attr("result","blurOut"),i.append("feColorMatrix").attr("type","matrix").attr("values","-1 0 0 0 1  0 -1 0 0 1  0 0 -1 0 1  0 0 0 1 0").attr("in","blurOut").attr("result","invertOut"),i.append("feBlend").attr("in","SourceGraphic").attr("in2","invertOut").attr("mode","normal"),t.widget||(e=E.append("g")),i=C.append("filter").attr("id","geo-blur").attr("x","-100%").attr("y","-100%").attr("width","300%").attr("height","300%"),i.append("feGaussianBlur").attr("stdDeviation",20).attr("in","SourceGraphic"),m=p.layer().sticky(),E.attr("class",p._d3id()),E.attr("width",p.layer().node().width()),E.attr("height",p.layer().node().height()),t.widget?p.canvas(E):(e.attr("class","group-"+p._d3id()),p.canvas(e))}p._setTransform()},this.api=function(){return"d3"},this.scaleFactor=function(){return b},this._resize=function(t,e,i,n){g||s(),E.attr("width",i),E.attr("height",n),p._setTransform(),p.layer().geoTrigger(c.d3Rescale,{scale:b},!0)},this._update=function(){},this._exit=function(){v={},p.canvas().remove(),E.remove(),E=void 0,C.remove(),C=void 0,T={},A={},f()},this._definitions=function(){return C},this._drawFeatures=function(t){return v[t.id]={data:t.data,index:t.dataIndex,style:t.style,attributes:t.attributes,classes:t.classes,append:t.append,onlyRenderNew:t.onlyRenderNew,sortByZ:t.sortByZ,parentId:t.parentId},p.__render(t.id,t.parentId)},this.__render=function(t,e){var i;if(void 0===t){for(i in v)v.hasOwnProperty(i)&&p.__render(i);return p}e?p._renderFeature(t,e):(T[t]=!0,null===M&&(M=window.requestAnimationFrame(p._renderFrame)))},this._renderFrame=function(){var t;for(t in A)p.select(t).remove(),C.selectAll("."+t).remove();A={};var e=T;T={},M=null;for(t in e)e.hasOwnProperty(t)&&p._renderFeature(t)},this._renderFeature=function(t,i){if(v[t]){var r,o,a=v[t].data,s=v[t].index,u=v[t].style,l=v[t].attributes,h=v[t].classes,c=v[t].append,d=p.select(t,i).data(a,s);return r=d.enter().append(c),d.exit().remove(),o=v[t].onlyRenderNew?r:d,e(o,l),o.attr("class",h.concat([t]).join(" ")),n(o,u),r.size()&&v[t].sortByZ&&d.sort(function(t,e){return(t.zIndex||0)-(e.zIndex||0)}),p}},this.select=function(t,e){return r(e).selectAll("."+t)},this._removeFeature=function(t){return A[t]=!0,null===M&&(M=window.requestAnimationFrame(p._renderFrame)),delete v[t],T[t]&&delete T[t],p},this.draw=function(){},this.layer().geoOn(c.pan,p._setTransform),this.layer().geoOn(c.rotate,p._setTransform),this.layer().geoOn(c.zoom,function(){p._setTransform(),p.__render(),p.layer().geoTrigger(d,{scale:b},!0)}),this.layer().geoOn(c.resize,function(t){p._resize(t.x,t.y,t.width,t.height)}),this._init(t),this};n(a,o),r("d3",a),function(){"use strict";a.supported=function(){return!!i.m[132]},a.fallback=function(){return null}}(),t.exports=a},function(t,e,i){var n=i(131).registerLayerAdjustment,r=function(){"use strict";var t,e=this,i=this._init,n=this._exit,r=0,o=[];this._drawTile=function(i){var n=e._tileBounds(i),a=i.index.level||0,s=this._tileOffset(a),u={};u.ul=this.fromLocal(this.fromLevel({x:n.left-s.x,y:n.top-s.y},a),0),u.ll=this.fromLocal(this.fromLevel({x:n.left-s.x,y:n.bottom-s.y},a),0),u.ur=this.fromLocal(this.fromLevel({x:n.right-s.x,y:n.top-s.y},a),0),u.lr=this.fromLocal(this.fromLevel({x:n.right-s.x,y:n.bottom-s.y},a),0),u.ul.z=u.ll.z=u.ur.z=u.lr.z=1e-5*a,r+=1,u.id=r,i.quadId=u.id,u.image=i.image,u.reference=i.toString(),o.push(u),t.data(o),t._update(),e.draw()},this._remove=function(i){if(void 0!==i.quadId&&t){for(var n=0;n<o.length;n+=1)if(o[n].id===i.quadId){o.splice(n,1);break}t.data(o),t._update(),e.draw()}},this._exit=function(){e.deleteFeature(t),t=null,o=[],n.apply(e,arguments)},this._init=function(){i.apply(e,arguments),t=this.createFeature("quad",{previewColor:e._options.previewColor,previewImage:e._options.previewImage}),t.geoTrigger=void 0,t.gcs(e._options.gcs||e.map().gcs()),t.data(o),t._update()},this._getSubLayer=function(){},this._updateSubLayers=void 0};n("d3","tile",r),t.exports=r},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(228),a=function(t){"use strict";function e(t,e,i){return l._d3id()+"_marker_"+e+"_"+i}function n(t,i,n,r,o){var a={arrow:{attrs:{"class":"geo-vector-arrow geo-vector-marker",viewBox:"0 0 10 10",refX:"1",refY:"5",markerHeight:"5",markerWidth:"5",orient:"auto"},path:"M 0 0 L 10 5 L 0 10 z"},point:{attrs:{"class":"geo-vector-point geo-vector-marker",viewBox:"0 0 12 12",refX:"6",refY:"6",markerHeight:"8",markerWidth:"8",orient:"auto"},path:"M 6 3 A 3 3 0 1 1 5.99999 3 Z"},bar:{attrs:{"class":"geo-vector-bar geo-vector-marker",viewBox:"0 0 10 10",refX:"0",refY:"5",markerHeight:"6",markerWidth:"6",orient:"auto"},path:"M 0 0 L 2 0 L 2 10 L 0 10 z"},wedge:{attrs:{"class":"geo-vector-wedge geo-vector-marker",viewBox:"0 0 10 10",refX:"10",refY:"5",markerHeight:"5",markerWidth:"5",orient:"auto"},path:"M 0 0 L 1 0 L 10 5 L 1 10 L 0 10 L 9 5 L 0 0"}},s=l.renderer()._definitions().selectAll("g.marker-group#"+l._d3id()).data(t.length?[1]:[]);s.enter().append("g").attr("id",l._d3id).attr("class","marker-group"),s.exit().remove();var h=t.reduce(function(t,e,i){var n=a[o(e,i)],s=a[r(e,i)];return n&&t.push({data:e,dataIndex:i,head:!0}),s&&t.push({data:e,dataIndex:i,head:!1}),t},[]),c=s.selectAll("marker.geo-vector-marker").data(h);c.enter().append("marker").append("path");var d=l.renderer();c.each(function(t){var e=u.select(this),i=t.head?a[o(t.data,t.dataIndex)]:a[r(t.data,t.dataIndex)];Object.keys(i.attrs).map(function(t){e.attr(t,i.attrs[t])})}).attr("id",function(t){return e(t.data,t.dataIndex,t.head?"head":"tail")}).style("stroke",function(t){return d._convertColor(i)(t.data,t.dataIndex)}).style("fill",function(t){return d._convertColor(i)(t.data,t.dataIndex)}).style("opacity",function(t){return n(t.data,t.dataIndex)}).select("path").attr("d",function(t){return t.head?a[o(t.data,t.dataIndex)].path:a[r(t.data,t.dataIndex)].path}),c.exit().remove()}if(!(this instanceof a))return new a(t);var r=i(235),s=i(129),u=i(132);t=t||{},o.call(this,t),r.call(this);var l=this,h=this._init,c=this._exit,d=this._update,f=s(),p={};return this._init=function(t){return h.call(l,t),l},this._build=function(){function t(){return h/o.scaleFactor()}var i=l.data(),r=l.style.get(),o=l.renderer(),a=l.origin(),s=l.delta(),u=[],h=l.style("scale"),c=Number.NEGATIVE_INFINITY;return d.call(l),i||(i=[]),u=i.map(function(t,e){var i=l.featureGcsToDisplay(a(t,e)),n=s(t,e);return c=Math.max(c,n.x*n.x+n.y*n.y),{x1:i.x,y1:i.y,dx:n.x,dy:-n.y}}),c=Math.sqrt(c),h||(h=75/c),p.id=l._d3id(),p.data=i,p.append="line",p.attributes={x1:function(t,e){return u[e].x1},y1:function(t,e){return u[e].y1},x2:function(e,i){return u[i].x1+t()*u[i].dx},y2:function(e,i){return u[i].y1+t()*u[i].dy},"marker-start":function(t,i){return"url(#"+e(t,i,"tail")+")"},"marker-end":function(t,i){return"url(#"+e(t,i,"head")+")"}},p.style={stroke:function(){return!0},strokeColor:r.strokeColor,strokeWidth:r.strokeWidth,strokeOpacity:r.strokeOpacity,originStyle:r.originStyle,endStyle:r.endStyle},p.classes=["d3VectorFeature"],n(i,r.strokeColor,r.strokeOpacity,r.originStyle,r.endStyle),l.renderer()._drawFeatures(p),f.modified(),l.updateTime().modified(),l},this._update=function(){return d.call(l),l.getMTime()>=f.getMTime()?l._build():n(p.data,p.style.strokeColor,p.style.strokeOpacity,p.style.originStyle,p.style.endStyle),l},this._exit=function(){c.call(l),p={},n([],null,null,null,null)},this._init(t),this};n(a,o),r("d3","vector",a),t.exports=a},function(t,e,i){t.exports={choroplethFeature:i(244),contourFeature:i(245),ellipsoid:i(247),geomFeature:i(248),lineFeature:i(249),pointFeature:i(250),polygonFeature:i(251),quadFeature:i(253),tileLayer:i(254),vglRenderer:i(255)}},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(126),a=function(t){"use strict";function e(){return i.createChoropleth()}if(!(this instanceof a))return new a(t);t=t||{},o.call(this,t);var i=this,n=null,r=this._exit,s=this._init,u=this.draw,l=this._update;return this.draw=function(){if(i._update(),n)for(var t=0;t<n.length;t+=1)n[t].draw();return u(),i},this._init=function(t){s.call(i,t)},this._build=function(){return i.buildTime().modified(),n=e()},this._update=function(){l.call(i),(i.dataTime().getMTime()>=i.buildTime().getMTime()||i.updateTime().getMTime()<=i.getMTime())&&(i._wipePolygons(),i._build()),i.updateTime().modified()},this._wipePolygons=function(){n&&n.map(function(t){return t._exit()}),n=null},this._exit=function(){i._wipePolygons(),r()},this._init(t),this};n(a,o),r("vgl","choropleth",a),t.exports=a},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(134),a=function(t){"use strict";function e(){var t=["#ifdef GL_ES","  precision highp float;","#endif","attribute vec3 pos;","attribute float value;","attribute float opacity;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","varying float valueVar;","varying float opacityVar;","void main(void)","{","  vec4 scrPos = projectionMatrix * modelViewMatrix * vec4(pos.xy, 0, 1);","  if (scrPos.w != 0.0) {","    scrPos = scrPos / scrPos.w;","  }","  valueVar = value;","  opacityVar = opacity;","  gl_Position = scrPos;","}"].join("\n"),e=new s.shader(s.GL.VERTEX_SHADER);return e.setShaderSource(t),e}function n(){var t=["#ifdef GL_ES","  precision highp float;","#endif","uniform vec4 minColor;","uniform vec4 maxColor;","uniform float steps;","uniform bool stepped;","uniform sampler2D sampler2d;","varying float valueVar;","varying float opacityVar;","void main () {","  vec4 clr;","  if (valueVar < 0.0) {","    clr = minColor;","  } else if (valueVar > steps) {","    clr = maxColor;","  } else {","    float step;","    if (stepped) {","      step = floor(valueVar) + 0.5;","      if (step > steps) {","        step = steps - 0.5;","      }","    } else {","      step = valueVar;","    }","    clr = texture2D(sampler2d, vec2(step / steps, 0.0));","  }","  gl_FragColor = vec4(clr.rgb, clr.a * opacityVar);","}"].join("\n"),e=new s.shader(s.GL.FRAGMENT_SHADER);return e.setShaderSource(t),e}function r(){var t,e,i,n,r,o,a,s,h=c.createContours(),d=h.elements.length,f=[],p=m.geometryData();for(y.set([h.minColor.r,h.minColor.g,h.minColor.b,h.minColor.a]),x.set([h.maxColor.r,h.maxColor.g,h.maxColor.b,h.maxColor.a]),_.set(h.colorMap.length),b.set(h.stepped),t=0;t<h.colorMap.length;t+=1)f.push(255*h.colorMap[t].r),f.push(255*h.colorMap[t].g),f.push(255*h.colorMap[t].b),f.push(255*h.colorMap[t].a);for(g.setColorTable(f),h.pos=u.transformCoordinates(c.gcs(),c.layer().map().gcs(),h.pos,3),r=l.getGeomBuffer(p,"pos",3*d),
o=l.getGeomBuffer(p,"opacity",d),a=l.getGeomBuffer(p,"value",d),t=e=0;t<d;t+=1,e+=3)i=h.elements[t],n=3*i,r[e]=h.pos[n],r[e+1]=h.pos[n+1],r[e+2]=h.pos[n+2],o[t]=h.opacity[i],a[t]=h.value[i];s=p.primitive(0).indices(),s instanceof Uint16Array&&s.length===d||(s=new Uint16Array(d),p.primitive(0).setIndices(s)),p.boundsDirty(!0),m.modified(),m.boundsDirtyTimestamp().modified()}if(!(this instanceof a))return new a(t);t=t||{},o.call(this,t);var s=i(6),u=i(147),l=i(120),h=i(246);h.call(this);var c=this,d=this._exit,f=7,p=null,m=null,v=null,g=null,y=null,x=null,_=null,b=null,w=void 0!==t.dynamicDraw&&t.dynamicDraw,M=this._init,T=this._update;return this._init=function(t){var i=s.blend(),r=s.shaderProgram(),o=s.material(),a=s.lookupTable(),u=s.geometryData(),l=new s.modelViewUniform("modelViewMatrix"),h=new s.projectionUniform("projectionMatrix"),d=new s.uniform(s.GL.INT,"sampler2d"),T=e(),A=n(),E=s.vertexAttribute("pos"),C=s.vertexAttribute("value"),S=s.vertexAttribute("opacity"),R=s.sourceDataP3fv({name:"pos"}),P=s.sourceDataAnyfv(1,s.vertexAttributeKeysIndexed.One,{name:"value"}),L=s.sourceDataAnyfv(1,s.vertexAttributeKeysIndexed.Two,{name:"opacity"}),D=new s.triangles;M.call(c,t),m=s.mapper({dynamicDraw:w}),r.addVertexAttribute(E,s.vertexAttributeKeys.Position),r.addVertexAttribute(C,s.vertexAttributeKeysIndexed.One),r.addVertexAttribute(S,s.vertexAttributeKeysIndexed.Two),r.addUniform(l),r.addUniform(h),y=new s.uniform(s.GL.FLOAT_VEC4,"minColor"),r.addUniform(y),x=new s.uniform(s.GL.FLOAT_VEC4,"maxColor"),r.addUniform(x),_=new s.uniform(s.GL.FLOAT,"steps"),r.addUniform(_),b=new s.uniform(s.GL.BOOL,"stepped"),r.addUniform(b),r.addShader(A),r.addShader(T),r.addUniform(d),a.setTextureUnit(f),d.set(f),v=o,v.addAttribute(r),v.addAttribute(i),g=a,v.addAttribute(g),p=s.actor(),p.setMaterial(v),p.setMapper(m),u.addSource(R),u.addSource(P),u.addSource(L),u.addPrimitive(D),m.setGeometryData(u)},this._build=function(){p&&c.renderer().contextRenderer().removeActor(p),r(),c.renderer().contextRenderer().addActor(p),c.buildTime().modified()},this._update=function(){T.call(c),(c.dataTime().getMTime()>=c.buildTime().getMTime()||c.updateTime().getMTime()<=c.getMTime())&&c._build(),p.setVisible(c.visible()),p.material().setBinNumber(c.bin()),c.updateTime().modified()},this._exit=function(){c.renderer().contextRenderer().removeActor(p),d()},this._init(t),this};n(a,o),r("vgl","contour",a),t.exports=a},function(t,e,i){var n=function(t){"use strict";var e=i(5);if(!(this instanceof e))return new n(t);var r=this,o=this.draw;return this.draw=function(){return r._update({mayDelay:!0}),r.renderer()._render(),o(),r},this};t.exports=n},function(t,e,i){var n=function(t,e,r){"use strict";if(!(this instanceof n))return new n(t,e,r);var o=i(6),a=i(120),s=i(58);if(t=o.defaultValue(t,0),e=o.defaultValue(e,0),r=o.defaultValue(r,0),t<0||e<0||r<0)return console.log("[error] Al radii components must be greater than zero");var u=this,l=[t,e,r],h=[t*t,e*e,r*r],c=Math.min(t,e,r),d=Math.max(t,e,r);return this.radii=function(){return l},this.radiiSquared=function(){return h},this.maximumRadius=function(){return d},this.minimumRadius=function(){return c},this.computeGeodeticSurfaceNormal=function(t,e){if("undefined"==typeof t||"undefined"==typeof e)throw"[error] Valid latitude and longitude is required";var i=Math.cos(t),n=a.vec3AsArray();return n[0]=i*Math.cos(e),n[1]=i*Math.sin(e),n[2]=Math.sin(t),s.normalize(n,n),n},this.transformPoint=function(t,e,i){t*=Math.PI/180,e*=Math.PI/180;var n=u.computeGeodeticSurfaceNormal(t,e),r=a.vec3AsArray(),o=Math.sqrt(s.dot(n,r)),l=a.vec3AsArray();return s.multiply(r,h,n),s.scale(r,r,1/o),s.scale(n,n,i),s.add(l,n,r),l},this.transformGeometry=function(t){if(!t)throw"[error] Failed to transform to cartesian. Invalid geometry.";var e=t.sourceData(o.vertexAttributeKeys.Position),i=e.data(),n=e.attributeNumberOfComponents(o.vertexAttributeKeys.Position),r=e.attributeStride(o.vertexAttributeKeys.Position),l=e.attributeOffset(o.vertexAttributeKeys.Position),c=e.sizeOfAttributeDataType(o.vertexAttributeKeys.Position),d=null,f=i.length*(1/n),p=null,m=null,v=0,g=a.vec3AsArray(),y=a.vec3AsArray();if(r/=c,l/=c,3!==n)throw"[error] Requires positions with three components";for(v=0;v<f;v+=1)d=v*r+l,i[d]=i[d]*(Math.PI/180),i[d+1]=i[d+1]*(Math.PI/180),m=u.computeGeodeticSurfaceNormal(i[d+1],i[d]),s.multiply(g,h,m),p=Math.sqrt(s.dot(m,g)),s.scale(g,g,1/p),s.scale(m,m,i[d+2]),s.add(y,m,g),i[d]=y[0],i[d+1]=y[1],i[d+2]=y[2]},u};t.exports=n},function(t,e,i){var n=i(4),r=i(140),o=function(t){"use strict";if(!(this instanceof o))return new o(t);var e=i(6);t=t||{},r.call(this,t);var n=i(246);n.call(this);var a=this,s=t.geom||null,u=e.actor(),l=e.mapper(),h=null,c=null,d=t.color||[1,1,1],f=null,p=0;return this._build=function(){var t=a.style();null!==s&&(c=s.sourceData(e.vertexAttributeKeys.Scalar),d=s.sourceData(e.vertexAttributeKeys.Color),l.setGeometryData(s)),a.setMapper(l),void 0!==t.point_sprites&&t.point_sprites&&void 0!==t.point_sprites_image&&null!==t.point_sprites_image&&1===p&&s.primitive(0).primitiveType()===e.GL.POINTS?h=e.utils.createPointSpritesMaterial(t.point_sprites_image):c?d instanceof e.lookupTable?(d.updateRange(c.scalarRange()),h=e.utils.createColorMappedMaterial(d)):(d=e.lookupTable(),d.updateRange(c.scalarRange()),h=e.utils.createColorMappedMaterial(d)):h=d?e.utils.createColorMaterial():e.utils.createSolidColorMaterial(),u.setMaterial(h)},this._update=function(){f&&f.getMTime()<a.getMTime()?d instanceof e.lookupTable&&e.utils.updateColorMappedMaterial(a.material(),a.style.color):(f=e.timestamp(),f.modified())},this.geometry=function(t){return void 0===t?s:(s=t,a.modified(),a)},this};n(o,r),t.exports=o},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(145),a=function(t){"use strict";function e(){var t=["#ifdef GL_ES","  precision highp float;","#endif","attribute vec3 pos;","attribute vec3 prev;","attribute vec3 next;","attribute float offset;","attribute vec3 strokeColor;","attribute float strokeOpacity;","attribute float strokeWidth;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float pixelWidth;","uniform float aspect;","varying vec4 strokeColorVar;","void main(void)","{","  if (strokeOpacity < 0.0) {","    gl_Position = vec4(2, 2, 0, 1);","    return;","  }","  const float PI = 3.14159265358979323846264;","  vec4 worldPos = projectionMatrix * modelViewMatrix * vec4(pos.xyz, 1);","  if (worldPos.w != 0.0) {","    worldPos = worldPos/worldPos.w;","  }","  vec4 worldNext = projectionMatrix * modelViewMatrix * vec4(next.xyz, 1);","  if (worldNext.w != 0.0) {","    worldNext = worldNext/worldNext.w;","  }","  vec4 worldPrev = projectionMatrix* modelViewMatrix * vec4(prev.xyz, 1);","  if (worldPrev.w != 0.0) {","    worldPrev = worldPrev/worldPrev.w;","  }","  strokeColorVar = vec4(strokeColor, strokeOpacity);","  vec2 deltaNext = worldNext.xy - worldPos.xy;","  vec2 deltaPrev = worldPos.xy - worldPrev.xy;","  float angleNext = 0.0, anglePrev = 0.0;","  if (deltaNext.xy != vec2(0.0, 0.0))","    angleNext = atan(deltaNext.y / aspect, deltaNext.x);","  if (deltaPrev.xy == vec2(0.0, 0.0)) anglePrev = angleNext;","  else  anglePrev = atan(deltaPrev.y / aspect, deltaPrev.x);","  if (deltaNext.xy == vec2(0.0, 0.0)) angleNext = anglePrev;","  float angle = (anglePrev + angleNext) / 2.0;","  if (abs(anglePrev - angleNext) >= PI)","    angle += PI;","  float cosAngle = cos(anglePrev - angle);","  if (cosAngle < 0.1) { cosAngle = sign(cosAngle) * 1.0; angle = 0.0; }","  float distance = (offset * strokeWidth * pixelWidth) /","                    cosAngle;","  worldPos.x += distance * sin(angle);","  worldPos.y -= distance * cos(angle) * aspect;","  gl_Position = worldPos;","}"].join("\n"),e=new s.shader(s.GL.VERTEX_SHADER);return e.setShaderSource(t),e}function n(){var t=["#ifdef GL_ES","  precision highp float;","#endif","varying vec4 strokeColorVar;","void main () {","  gl_FragColor = strokeColorVar;","}"].join("\n"),e=new s.shader(s.GL.FRAGMENT_SHADER);return e.setShaderSource(t),e}function r(){var t,e,i,n,r,o,a,s,h,d,f,m,v,g,y,x,_,b,w,M,T=c.data(),A=0,E=[{},{}],C=[],S=c.position(),R=c.style.get("strokeWidth"),P=c.style.get("strokeColor"),L=c.style.get("strokeOpacity"),D=c.featureVertices(),O=p.geometryData();for(t=0;t<T.length;t+=1)for(o=c.line()(T[t],t),A+=o.length-1,e=0;e<o.length;e+=1)h=S(o[e],e,o,t),C.push(h.x),C.push(h.y),C.push(h.z||0);for(C=u.transformCoordinates(c.gcs(),c.layer().map().gcs(),C,3),r=A*D.length,f=l.getGeomBuffer(O,"pos",3*r),m=l.getGeomBuffer(O,"next",3*r),v=l.getGeomBuffer(O,"prev",3*r),g=l.getGeomBuffer(O,"offset",r),x=l.getGeomBuffer(O,"strokeWidth",r),_=l.getGeomBuffer(O,"strokeColor",3*r),b=l.getGeomBuffer(O,"strokeOpacity",r),y=O.primitive(0).indices(),y instanceof Uint16Array&&y.length===r||(y=new Uint16Array(r),O.primitive(0).setIndices(y)),t=d=w=M=0;t<T.length;t+=1)for(o=c.line()(T[t],t),e=0;e<o.length;e+=1,d+=3)if(a=o[e],e&&(s=E[0],E[0]=E[1],E[1]=s),E[1].pos=d,E[1].prev=d-(e?3:0),E[1].next=d+(e+1<o.length?3:0),E[1].strokeWidth=R(a,e,o,t),E[1].strokeColor=P(a,e,o,t),E[1].strokeOpacity=L(a,e,o,t),e)for(i=0;i<D.length;i+=1,w+=1,M+=3)n=E[D[i][0]],f[M]=C[n.pos],f[M+1]=C[n.pos+1],f[M+2]=C[n.pos+2],v[M]=C[n.prev],v[M+1]=C[n.prev+1],v[M+2]=C[n.prev+2],m[M]=C[n.next],m[M+1]=C[n.next+1],m[M+2]=C[n.next+2],g[w]=D[i][1],x[w]=n.strokeWidth,_[M]=n.strokeColor.r,_[M+1]=n.strokeColor.g,_[M+2]=n.strokeColor.b,b[w]=n.strokeOpacity;O.boundsDirty(!0),p.modified(),p.boundsDirtyTimestamp().modified()}if(!(this instanceof a))return new a(t);t=t||{},o.call(this,t);var s=i(6),u=i(147),l=i(120),h=i(246);h.call(this);var c=this,d=this._exit,f=null,p=null,m=null,v=null,g=null,y=void 0!==t.dynamicDraw&&t.dynamicDraw,x=this._init,_=this._update;return this.featureVertices=function(){return[[0,1],[1,-1],[0,-1],[0,1],[1,1],[1,-1]]},this.verticesPerFeature=function(){return c.featureVertices().length},this._init=function(t){var i=s.shaderProgram(),r=e(),o=n(),a=s.vertexAttribute("pos"),u=s.vertexAttribute("prev"),l=s.vertexAttribute("next"),h=s.vertexAttribute("offset"),d=s.vertexAttribute("strokeWidth"),_=s.vertexAttribute("strokeColor"),b=s.vertexAttribute("strokeOpacity"),w=new s.modelViewUniform("modelViewMatrix"),M=new s.projectionUniform("projectionMatrix"),T=s.geometryData(),A=s.sourceDataP3fv({name:"pos"}),E=s.sourceDataAnyfv(3,s.vertexAttributeKeysIndexed.Four,{name:"prev"}),C=s.sourceDataAnyfv(3,s.vertexAttributeKeysIndexed.Five,{name:"next"}),S=s.sourceDataAnyfv(1,s.vertexAttributeKeysIndexed.Six,{name:"offset"}),R=s.sourceDataAnyfv(1,s.vertexAttributeKeysIndexed.One,{name:"strokeWidth"}),P=s.sourceDataAnyfv(3,s.vertexAttributeKeysIndexed.Two,{name:"strokeColor"}),L=s.sourceDataAnyfv(1,s.vertexAttributeKeysIndexed.Three,{name:"strokeOpacity"}),D=s.triangles();v=new s.floatUniform("pixelWidth",1/c.renderer().width()),g=new s.floatUniform("aspect",c.renderer().width()/c.renderer().height()),x.call(c,t),m=s.material(),p=s.mapper({dynamicDraw:y}),i.addVertexAttribute(a,s.vertexAttributeKeys.Position),i.addVertexAttribute(d,s.vertexAttributeKeysIndexed.One),i.addVertexAttribute(_,s.vertexAttributeKeysIndexed.Two),i.addVertexAttribute(b,s.vertexAttributeKeysIndexed.Three),i.addVertexAttribute(u,s.vertexAttributeKeysIndexed.Four),i.addVertexAttribute(l,s.vertexAttributeKeysIndexed.Five),i.addVertexAttribute(h,s.vertexAttributeKeysIndexed.Six),i.addUniform(w),i.addUniform(M),i.addUniform(v),i.addUniform(g),i.addShader(o),i.addShader(r),m.addAttribute(i),m.addAttribute(s.blend()),f=s.actor(),f.setMaterial(m),f.setMapper(p),T.addSource(A),T.addSource(E),T.addSource(C),T.addSource(R),T.addSource(P),T.addSource(L),T.addSource(S),T.addPrimitive(D),p.setGeometryData(T)},this.actors=function(){return f?[f]:[]},this._build=function(){f&&c.renderer().contextRenderer().removeActor(f),r(),c.renderer().contextRenderer().addActor(f),c.buildTime().modified()},this._update=function(){_.call(c),(c.dataTime().getMTime()>=c.buildTime().getMTime()||c.updateTime().getMTime()<=c.getMTime())&&c._build(),v.set(1/c.renderer().width()),g.set(c.renderer().width()/c.renderer().height()),f.setVisible(c.visible()),f.material().setBinNumber(c.bin()),c.updateTime().modified()},this._exit=function(){c.renderer().contextRenderer().removeActor(f),d()},this._init(t),this};n(a,o);var s={};s[o.capabilities.basic]=!0,s[o.capabilities.multicolor]=!0,r("vgl","line",a,s),t.exports=a},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(224),a=function(t){"use strict";function e(){var t=new u.shader(u.GL.VERTEX_SHADER);return t.setShaderSource(w),t}function n(){var t=new u.shader(u.GL.FRAGMENT_SHADER);return t.setShaderSource(M),t}function r(t,e,i,n){var r;switch(x){case"triangle":r=[t,e-2*n,t-i*Math.sqrt(3),e+n,t+i*Math.sqrt(3),e+n];break;case"sprite":r=[t,e];break;default:r=[t-i,e+n,t-i,e-n,t+i,e+n,t-i,e-n,t+i,e-n,t+i,e+n]}return r}function s(){var t,e,i,n,o,a,s,u,c,f,p,v,g,y,_,b,w,M,T,A,E,C,S,R,P,L,D,O,I,N,F,k,G,U,z,B,j,V=d.data().length,q=r(0,0,1,1),W=new Array(3*V),H=d.verticesPerFeature(),X=d.data(),K=m.geometryData();for(o=d.position(),f=d.style.get("radius"),g=d.style.get("stroke"),b=d.style.get("strokeWidth"),T=d.style.get("strokeOpacity"),C=d.style.get("strokeColor"),P=d.style.get("fill"),O=d.style.get("fillOpacity"),F=d.style.get("fillColor"),t=B=0;t<V;t+=1,B+=3)n=o(X[t]),W[B]=n.x,W[B+1]=n.y,W[B+2]=n.z||0,j=j||W[B+2];if(W=l.transformCoordinates(d.gcs(),d.layer().map().gcs(),W,3),!j&&d.gcs()!==d.layer().map().gcs())for(t=B=0;t<V;t+=1,B+=3)W[B+2]=0;for(i=h.getGeomBuffer(K,"pos",H*V*3),"sprite"!==x&&(a=h.getGeomBuffer(K,"unit",H*V*2)),u=h.getGeomBuffer(K,"rad",H*V),p=h.getGeomBuffer(K,"stroke",H*V),y=h.getGeomBuffer(K,"strokeWidth",H*V),w=h.getGeomBuffer(K,"strokeOpacity",H*V),A=h.getGeomBuffer(K,"strokeColor",H*V*3),S=h.getGeomBuffer(K,"fill",H*V),L=h.getGeomBuffer(K,"fillOpacity",H*V),I=h.getGeomBuffer(K,"fillColor",H*V*3),s=K.primitive(0).indices(),s instanceof Uint16Array&&s.length===H*V||(s=new Uint16Array(H*V),K.primitive(0).setIndices(s)),t=G=U=z=B=0;t<V;t+=1,B+=3){if(k=X[t],"sprite"!==x)for(e=0;e<q.length;e+=1,z+=1)a[z]=q[e];for(c=f(k),v=g(k)?1:0,_=b(k),M=T(k),E=C(k),R=P(k)?1:0,D=O(k),N=F(k),e=0;e<H;e+=1,G+=1,U+=3)i[U]=W[B],i[U+1]=W[B+1],i[U+2]=W[B+2],u[G]=c,p[G]=v,y[G]=_,w[G]=M,A[U]=E.r,A[U+1]=E.g,A[U+2]=E.b,S[G]=R,L[G]=D,I[U]=N.r,I[U+1]=N.g,I[U+2]=N.b}K.boundsDirty(!0),m.modified(),m.boundsDirtyTimestamp().modified()}if(!(this instanceof a))return new a(t);t=t||{},o.call(this,t);var u=i(6),l=i(147),h=i(120),c=i(246);c.call(this);var d=this,f=this._exit,p=null,m=null,v=null,g=null,y=void 0!==t.dynamicDraw&&t.dynamicDraw,x="sprite",_=this._init,b=this._update,w=null,M=null;return"triangle"!==t.primitiveShape&&"square"!==t.primitiveShape&&"sprite"!==t.primitiveShape||(x=t.primitiveShape),w=["#ifdef GL_ES","  precision highp float;","#endif","attribute vec3 pos;","attribute float rad;","attribute vec3 fillColor;","attribute vec3 strokeColor;","attribute float fillOpacity;","attribute float strokeWidth;","attribute float strokeOpacity;","attribute float fill;","attribute float stroke;","uniform float pixelWidth;","uniform float aspect;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","varying vec4 fillColorVar;","varying vec4 strokeColorVar;","varying float radiusVar;","varying float strokeWidthVar;","varying float fillVar;","varying float strokeVar;"],"sprite"!==x&&(w=w.concat(["attribute vec2 unit;","varying vec3 unitVar;"])),w.push.apply(w,["void main(void)","{","  strokeWidthVar = strokeWidth;","  // No stroke or fill implies nothing to draw","  if (stroke < 1.0 || strokeWidth <= 0.0 || strokeOpacity <= 0.0) {","    strokeVar = 0.0;","    strokeWidthVar = 0.0;","  }","  else","    strokeVar = 1.0;","  if (fill < 1.0 || rad <= 0.0 || fillOpacity <= 0.0)","    fillVar = 0.0;","  else","    fillVar = 1.0;","  if (fillVar == 0.0 && strokeVar == 0.0) {","    gl_Position = vec4(2, 2, 0, 1);","    return;","  }","  fillColorVar = vec4 (fillColor, fillOpacity);","  strokeColorVar = vec4 (strokeColor, strokeOpacity);","  radiusVar = rad;"]),"sprite"===x?w.push.apply(w,["  gl_Position = (projectionMatrix * modelViewMatrix * vec4(pos, 1.0)).xyzw;","  gl_PointSize = 2.0 * (rad + strokeWidthVar); ","}"]):w.push.apply(w,["  unitVar = vec3 (unit, 1.0);","  vec4 p = (projectionMatrix * modelViewMatrix * vec4(pos, 1.0)).xyzw;","  if (p.w != 0.0) {","    p = p / p.w;","  }","  p += (rad + strokeWidthVar) * ","       vec4 (unit.x * pixelWidth, unit.y * pixelWidth * aspect, 0.0, 1.0);","  gl_Position = vec4(p.xyz, 1.0);","}"]),w=w.join("\n"),M=["#ifdef GL_ES","  precision highp float;","#endif","uniform float aspect;","varying vec4 fillColorVar;","varying vec4 strokeColorVar;","varying float radiusVar;","varying float strokeWidthVar;","varying float fillVar;","varying float strokeVar;"],"sprite"!==x&&M.push("varying vec3 unitVar;"),M.push.apply(M,["void main () {","  vec4 strokeColor, fillColor;","  float endStep;","  // No stroke or fill implies nothing to draw","  if (fillVar == 0.0 && strokeVar == 0.0)","    discard;"]),"sprite"===x?M.push("  float rad = 2.0 * length (gl_PointCoord - vec2(0.5));"):M.push("  float rad = length (unitVar.xy);"),M.push.apply(M,["  if (rad > 1.0)","    discard;","  // If there is no stroke, the fill region should transition to nothing","  if (strokeVar == 0.0) {","    strokeColor = vec4 (fillColorVar.rgb, 0.0);","    endStep = 1.0;","  } else {","    strokeColor = strokeColorVar;","    endStep = radiusVar / (radiusVar + strokeWidthVar);","  }","  // Likewise, if there is no fill, the stroke should transition to nothing","  if (fillVar == 0.0)","    fillColor = vec4 (strokeColor.rgb, 0.0);","  else","    fillColor = fillColorVar;","  // Distance to antialias over","  float antialiasDist = 3.0 / (2.0 * radiusVar);","  if (rad < endStep) {","    float step = smoothstep (endStep - antialiasDist, endStep, rad);","    gl_FragColor = mix (fillColor, strokeColor, step);","  } else {","    float step = smoothstep (1.0 - antialiasDist, 1.0, rad);","    gl_FragColor = mix (strokeColor, vec4 (strokeColor.rgb, 0.0), step);","  }","}"]),M=M.join("\n"),this.actors=function(){return p?[p]:[]},this.verticesPerFeature=function(){var t=r(0,0,1,1);return t.length/2},this._init=function(){var i=u.shaderProgram(),r=e(),o=n(),a=u.vertexAttribute("pos"),s=u.vertexAttribute("unit"),l=u.vertexAttribute("rad"),h=u.vertexAttribute("strokeWidth"),c=u.vertexAttribute("fillColor"),f=u.vertexAttribute("fill"),b=u.vertexAttribute("strokeColor"),w=u.vertexAttribute("stroke"),M=u.vertexAttribute("fillOpacity"),T=u.vertexAttribute("strokeOpacity"),A=new u.modelViewUniform("modelViewMatrix"),E=new u.projectionUniform("projectionMatrix"),C=u.material(),S=u.blend(),R=u.geometryData(),P=u.sourceDataP3fv({name:"pos"}),L=u.sourceDataAnyfv(2,u.vertexAttributeKeysIndexed.One,{name:"unit"}),D=u.sourceDataAnyfv(1,u.vertexAttributeKeysIndexed.Two,{name:"rad"}),O=u.sourceDataAnyfv(1,u.vertexAttributeKeysIndexed.Three,{name:"strokeWidth"}),I=u.sourceDataAnyfv(3,u.vertexAttributeKeysIndexed.Four,{name:"fillColor"}),N=u.sourceDataAnyfv(1,u.vertexAttributeKeysIndexed.Five,{name:"fill"}),F=u.sourceDataAnyfv(3,u.vertexAttributeKeysIndexed.Six,{name:"strokeColor"}),k=u.sourceDataAnyfv(1,u.vertexAttributeKeysIndexed.Seven,{name:"stroke"}),G=u.sourceDataAnyfv(1,u.vertexAttributeKeysIndexed.Eight,{name:"fillOpacity"}),U=u.sourceDataAnyfv(1,u.vertexAttributeKeysIndexed.Nine,{name:"strokeOpacity"}),z=new u.triangles;"sprite"===x&&(z=new u.points),v=new u.floatUniform("pixelWidth",2/d.renderer().width()),g=new u.floatUniform("aspect",d.renderer().width()/d.renderer().height()),_.call(d,t),m=u.mapper({dynamicDraw:y}),i.addVertexAttribute(a,u.vertexAttributeKeys.Position),"sprite"!==x&&i.addVertexAttribute(s,u.vertexAttributeKeysIndexed.One),i.addVertexAttribute(l,u.vertexAttributeKeysIndexed.Two),i.addVertexAttribute(h,u.vertexAttributeKeysIndexed.Three),i.addVertexAttribute(c,u.vertexAttributeKeysIndexed.Four),i.addVertexAttribute(f,u.vertexAttributeKeysIndexed.Five),i.addVertexAttribute(b,u.vertexAttributeKeysIndexed.Six),i.addVertexAttribute(w,u.vertexAttributeKeysIndexed.Seven),i.addVertexAttribute(M,u.vertexAttributeKeysIndexed.Eight),i.addVertexAttribute(T,u.vertexAttributeKeysIndexed.Nine),i.addUniform(v),i.addUniform(g),i.addUniform(A),i.addUniform(E),i.addShader(o),i.addShader(r),C.addAttribute(i),C.addAttribute(S),p=u.actor(),p.setMaterial(C),p.setMapper(m),R.addSource(P),R.addSource(L),R.addSource(D),R.addSource(O),R.addSource(I),R.addSource(N),R.addSource(F),R.addSource(k),R.addSource(G),R.addSource(U),R.addPrimitive(z),m.setGeometryData(R)},this._build=function(){p&&d.renderer().contextRenderer().removeActor(p),s(),d.renderer().contextRenderer().addActor(p),d.renderer().contextRenderer().render(),d.buildTime().modified()},this._update=function(){b.call(d),(d.dataTime().getMTime()>=d.buildTime().getMTime()||d.updateTime().getMTime()<d.getMTime())&&d._build(),v.set(2/d.renderer().width()),g.set(d.renderer().width()/d.renderer().height()),p.setVisible(d.visible()),p.material().setBinNumber(d.bin()),d.updateTime().modified()},this._exit=function(){d.renderer().contextRenderer().removeActor(p),f()},d._init(),this};n(a,o),r("vgl","point",a),t.exports=a},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(226),a=function(t){"use strict";function e(){var t=["attribute vec3 pos;","attribute vec3 fillColor;","attribute float fillOpacity;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","varying vec4 fillColorVar;","void main(void)","{","  vec4 clipPos = projectionMatrix * modelViewMatrix * vec4(pos.xyz, 1);","  if (clipPos.w != 0.0) {","    clipPos = clipPos/clipPos.w;","  }","  fillColorVar = vec4(fillColor, fillOpacity);","  gl_Position = clipPos;","}"].join("\n"),e=new s.shader(s.GL.VERTEX_SHADER);return e.setShaderSource(t),e}function n(){var t=["#ifdef GL_ES","  precision highp float;","#endif","varying vec4 fillColorVar;","void main () {","  gl_FragColor = fillColorVar;","}"].join("\n"),e=new s.shader(s.GL.FRAGMENT_SHADER);return e.setShaderSource(t),e}function r(t){var e,i,n,r,o,a,s,c,f,m,v,y,x,_,b,w,M,T,A,E,C,S,R,P,L,D,O,I=[],N=p.gcs(),F=p.layer().map().gcs(),k=0,G=g.geometryData();for(r=p.style.get("fillColor"),o=h.isFunction(p.style("fillColor"))?void 0:r(),s=p.style.get("fillOpacity"),c=h.isFunction(p.style("fillOpacity"))?void 0:s(),f=p.style.get("fill"),m=h.isFunction(p.style("fill"))?void 0:f(),v=p.style.get("uniformPolygon"),t?(I=d.items,k=d.numPts):(i=p.position(),p.data().forEach(function(t,e){var n,r,o,a;for(n=p.polygon()(t,e),r=n.outer||(n instanceof Array?n:[]),o=new Array(3*r.length),E=T=0;E<r.length;E+=1,T+=3)a=i(r[E],E,t,e),o[T]=a.x,o[T+1]=a.y,o[T+2]=a.z||0;o={vertices:o,dimensions:3,holes:[]},O=r,n.inner&&n.inner.forEach(function(n){for(O=O.concat(n),o.holes.push(T/3),E=0;E<n.length;E+=1,T+=3)a=i(n[E],E,t,e),o.vertices[T]=a.x,o.vertices[T+1]=a.y,o.vertices[T+2]=a.z||0}),o.vertices=l.transformCoordinates(N,F,o.vertices,o.dimensions),P={triangles:u(o.vertices,o.holes,o.dimensions),vertices:o.vertices,original:O,item:t,itemIndex:e},I.push(P),k+=P.triangles.length}),e=h.getGeomBuffer(G,"pos",3*k),x=G.primitive(0).indices(),x instanceof Uint16Array&&x.length===k||(x=new Uint16Array(k),G.primitive(0).setIndices(x)),d={items:I,numPts:k}),n=h.getGeomBuffer(G,"fillColor",3*k),a=h.getGeomBuffer(G,"fillOpacity",k),M=T=0,_=o,b=c,w=m,S=0;S<I.length;S+=1)if(R=I[S].triangles.length,A=I[S].vertices,L=I[S].item,D=I[S].itemIndex,O=I[S].original,y=v(L,D),y&&(void 0===o&&(_=r(A[0],0,L,D)),void 0===c&&(b=s(A[0],0,L,D))),void 0===m&&(w=f(L,D)),w||(b=0),y&&t&&I[S].uniform&&I[S].color&&_.r===I[S].color.r&&_.g===I[S].color.g&&_.b===I[S].color.b&&b===I[S].opacity)M+=R,T+=3*R;else{for(E=0;E<R;E+=1,M+=1,T+=3)t&&y?(n[T]=_.r,n[T+1]=_.g,n[T+2]=_.b,a[M]=b):(C=3*I[S].triangles[E],t||(e[T]=A[C],e[T+1]=A[C+1],e[T+2]=A[C+2],x[M]=E),y||void 0!==o||(_=r(O[C],C,L,D)),n[T]=_.r,n[T+1]=_.g,n[T+2]=_.b,y||void 0!==c||(b=s(O[C],C,L,D)),a[M]=b);(y||I[S].uniform)&&(I[S].uniform=y,I[S].color=_,I[S].opacity=b)}g.modified(),t||(G.boundsDirty(!0),g.boundsDirtyTimestamp().modified())}if(!(this instanceof a))return new a(t);t=t||{},o.call(this,t);var s=i(6),u=i(252),l=i(147),h=i(120),c=i(246);c.call(this);var d,f,p=this,m=this._exit,v=s.actor(),g=s.mapper(),y=s.material(),x=this._init,_=this._update;return this._init=function(t){var i=s.shaderProgram(),r=s.vertexAttribute("pos"),o=s.vertexAttribute("fillColor"),a=s.vertexAttribute("fillOpacity"),u=new s.modelViewUniform("modelViewMatrix"),l=new s.projectionUniform("projectionMatrix"),h=e(),c=n(),d=s.blend(),f=s.geometryData(),m=s.sourceDataP3fv({name:"pos"}),_=s.sourceDataAnyfv(3,s.vertexAttributeKeysIndexed.Two,{name:"fillColor"}),b=s.sourceDataAnyfv(1,s.vertexAttributeKeysIndexed.Three,{name:"fillOpacity"}),w=s.triangles();i.addVertexAttribute(r,s.vertexAttributeKeys.Position),i.addVertexAttribute(o,s.vertexAttributeKeysIndexed.Two),i.addVertexAttribute(a,s.vertexAttributeKeysIndexed.Three),i.addUniform(u),i.addUniform(l),i.addShader(c),i.addShader(h),y.addAttribute(i),y.addAttribute(d),v.setMaterial(y),v.setMapper(g),f.addSource(m),f.addSource(_),f.addSource(b),f.addPrimitive(w),g.setGeometryData(f),x.call(p,t)},this._build=function(){r(p.dataTime().getMTime()<p.buildTime().getMTime()&&d),p.renderer().contextRenderer().hasActor(v)||p.renderer().contextRenderer().addActor(v),p.buildTime().modified()},this._update=function(t){return t&&t.mayDelay?void(f=window.requestAnimationFrame(this._update)):(f&&(window.cancelAnimationFrame(f),f=null),_.call(p),(p.dataTime().getMTime()>=p.buildTime().getMTime()||p.updateTime().getMTime()<=p.getMTime())&&p._build(),v.setVisible(p.visible()),v.material().setBinNumber(p.bin()),void p.updateTime().modified())},this._exit=function(){p.renderer().contextRenderer().removeActor(v),m()},this._init(t),this};n(a,o),r("vgl","polygon",a),t.exports=a},function(t,e){"use strict";function i(t,e,i){i=i||2;var r=e&&e.length,a=r?e[0]*i:t.length,s=n(t,0,a,i,!0),u=[];if(!s)return u;var l,c,d,f,p,m,v;if(r&&(s=h(t,e,s,i)),t.length>80*i){l=d=t[0],c=f=t[1];for(var g=i;g<a;g+=i)p=t[g],m=t[g+1],p<l&&(l=p),m<c&&(c=m),p>d&&(d=p),m>f&&(f=m);v=Math.max(d-l,f-c)}return o(s,u,i,l,c,v),u}function n(t,e,i,n,r){var o,a;if(r===P(t,e,i,n)>0)for(o=e;o<i;o+=n)a=C(o,t[o],t[o+1],a);else for(o=i-n;o>=e;o-=n)a=C(o,t[o],t[o+1],a);return a&&b(a,a.next)&&(S(a),a=a.next),a}function r(t,e){if(!t)return t;e||(e=t);var i,n=t;do if(i=!1,n.steiner||!b(n,n.next)&&0!==_(n.prev,n,n.next))n=n.next;else{if(S(n),n=e=n.prev,n===n.next)return null;i=!0}while(i||n!==e);return e}function o(t,e,i,n,h,c,d){if(t){!d&&c&&p(t,n,h,c);for(var f,m,v=t;t.prev!==t.next;)if(f=t.prev,m=t.next,c?s(t,n,h,c):a(t))e.push(f.i/i),e.push(t.i/i),e.push(m.i/i),S(t),t=m.next,v=m.next;else if(t=m,t===v){d?1===d?(t=u(t,e,i),o(t,e,i,n,h,c,2)):2===d&&l(t,e,i,n,h,c):o(r(t),e,i,n,h,c,1);break}}}function a(t){var e=t.prev,i=t,n=t.next;if(_(e,i,n)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(y(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&_(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function s(t,e,i,n){var r=t.prev,o=t,a=t.next;if(_(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,u=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,l=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,h=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,c=v(s,u,e,i,n),d=v(l,h,e,i,n),f=t.nextZ;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&y(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&_(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=t.prevZ;f&&f.z>=c;){if(f!==t.prev&&f!==t.next&&y(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&_(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}function u(t,e,i){var n=t;do{var r=n.prev,o=n.next.next;!b(r,o)&&w(r,n,n.next,o)&&T(r,o)&&T(o,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(o.i/i),S(n),S(n.next),n=t=o),n=n.next}while(n!==t);return n}function l(t,e,i,n,a,s){var u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&x(u,l)){var h=E(u,l);return u=r(u,u.next),h=r(h,h.next),o(u,e,i,n,a,s),void o(h,e,i,n,a,s)}l=l.next}u=u.next}while(u!==t)}function h(t,e,i,o){var a,s,u,l,h,f=[];for(a=0,s=e.length;a<s;a++)u=e[a]*o,l=a<s-1?e[a+1]*o:t.length,h=n(t,u,l,o,!1),h===h.next&&(h.steiner=!0),f.push(g(h));for(f.sort(c),a=0;a<f.length;a++)d(f[a],i),i=r(i,i.next);return i}function c(t,e){return t.x-e.x}function d(t,e){if(e=f(t,e)){var i=E(e,t);r(i,i.next)}}function f(t,e){var i,n=e,r=t.x,o=t.y,a=-(1/0);do{if(o<=n.y&&o>=n.next.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>a){if(a=s,s===r){if(o===n.y)return n;if(o===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===a)return i.prev;var u,l=i,h=i.x,c=i.y,d=1/0;for(n=i.next;n!==l;)r>=n.x&&n.x>=h&&y(o<c?r:a,o,h,c,o<c?a:r,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(r-n.x),(u<d||u===d&&n.x>i.x)&&T(n,t)&&(i=n,d=u)),n=n.next;return i}function p(t,e,i,n){var r=t;do null===r.z&&(r.z=v(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,m(r)}function m(t){var e,i,n,r,o,a,s,u,l=1;do{for(i=t,t=null,o=null,a=0;i;){for(a++,n=i,s=0,e=0;e<l&&(s++,n=n.nextZ,n);e++);for(u=l;s>0||u>0&&n;)0===s?(r=n,n=n.nextZ,u--):0!==u&&n?i.z<=n.z?(r=i,i=i.nextZ,s--):(r=n,n=n.nextZ,u--):(r=i,i=i.nextZ,s--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;i=n}o.nextZ=null,l*=2}while(a>1);return t}function v(t,e,i,n,r){return t=32767*(t-i)/r,e=32767*(e-n)/r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function g(t){var e=t,i=t;do e.x<i.x&&(i=e),e=e.next;while(e!==t);return i}function y(t,e,i,n,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(n-s)-(i-a)*(e-s)>=0&&(i-a)*(o-s)-(r-a)*(n-s)>=0}function x(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!M(t,e)&&T(t,e)&&T(e,t)&&A(t,e)}function _(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function w(t,e,i,n){return!!(b(t,e)&&b(i,n)||b(t,n)&&b(i,e))||_(t,e,i)>0!=_(t,e,n)>0&&_(i,n,t)>0!=_(i,n,e)>0}function M(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&w(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function T(t,e){return _(t.prev,t,t.next)<0?_(t,e,t.next)>=0&&_(t,t.prev,e)>=0:_(t,e,t.prev)<0||_(t,t.next,e)<0}function A(t,e){var i=t,n=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do i.y>o!=i.next.y>o&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==t);return n}function E(t,e){var i=new R(t.i,t.x,t.y),n=new R(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function C(t,e,i,n){var r=new R(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function R(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function P(t,e,i,n){for(var r=0,o=e,a=i-n;o<i;o+=n)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}t.exports=i,i.deviation=function(t,e,i,n){var r=e&&e.length,o=r?e[0]*i:t.length,a=Math.abs(P(t,0,o,i));if(r)for(var s=0,u=e.length;s<u;s++){var l=e[s]*i,h=s<u-1?e[s+1]*i:t.length;a-=Math.abs(P(t,l,h,i))}var c=0;for(s=0;s<n.length;s+=3){var d=n[s]*i,f=n[s+1]*i,p=n[s+2]*i;c+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},i.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)i.vertices.push(t[r][o][a]);r>0&&(n+=t[r-1].length,i.holes.push(n))}return i}},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(218),a=function(t){"use strict";function e(t){var e=t.m_context,i=!1;m.imgQuads.length&&((!d||d.length<12*m.imgQuads.length||!_.imgQuadsPosition)&&(_.imgQuadsPosition&&e.deleteBuffer(_.imgQuadsPosition),_.imgQuadsPosition=e.createBuffer(),d=new Float32Array(12*Math.max(128,2*m.imgQuads.length)),
i=!0),r.each(m.imgQuads,function(t,e){for(var i=0;i<12;i+=1)d[12*t+i]=e.pos[i]-m.origin[i%3]}),e.bindBuffer(s.GL.ARRAY_BUFFER,_.imgQuadsPosition),i?e.bufferData(s.GL.ARRAY_BUFFER,d,s.GL.DYNAMIC_DRAW):e.bufferSubData(s.GL.ARRAY_BUFFER,0,d)),b.modified()}function n(t){var e=t.m_context,i=!1;m.clrQuads.length&&((!f||f.length<12*m.clrQuads.length||!_.clrQuadsPosition)&&(_.imgQuadsPosition&&e.deleteBuffer(_.clrQuadsPosition),_.clrQuadsPosition=e.createBuffer(),f=new Float32Array(12*Math.max(128,2*m.clrQuads.length)),i=!0),r.each(m.clrQuads,function(t,e){for(var i=0;i<12;i+=1)f[12*t+i]=e.pos[i]-m.origin[i%3]}),e.bindBuffer(s.GL.ARRAY_BUFFER,_.clrQuadsPosition),i?e.bufferData(s.GL.ARRAY_BUFFER,f,s.GL.DYNAMIC_DRAW):e.bufferSubData(s.GL.ARRAY_BUFFER,0,f)),w.modified()}if(!(this instanceof a))return new a(t);o.call(this,t);var r=i(1),s=i(6),u=i(246);u.call(this);var l,h,c,d,f,p,m,v=this,g=this._exit,y=this._init,x=this._update,_={},b=s.timestamp(),w=s.timestamp(),M=["attribute vec3 vertexPosition;","attribute vec3 textureCoord;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","varying highp vec3 iTextureCoord;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);","  iTextureCoord = textureCoord;","}"].join("\n"),T=["attribute vec3 vertexPosition;","uniform vec3 vertexColor;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","varying mediump vec3 iVertexColor;","varying highp vec3 iTextureCoord;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);","  iVertexColor = vertexColor;","}"].join("\n");return this._build=function(){var t,e,i,n,r;v.position()&&(m=this._generateQuads(),m.imgQuads.length&&!h&&(v.visible(!1),t=new s.mapper({dynamicDraw:!0}),h=new s.actor,h.setMapper(t),e=new s.material,i=new s.shaderProgram,i.addVertexAttribute(new s.vertexAttribute("vertexPosition"),s.vertexAttributeKeys.Position),i.addVertexAttribute(new s.vertexAttribute("textureCoord"),s.vertexAttributeKeys.TextureCoordinate),l=new s.modelViewOriginUniform("modelViewMatrix",m.origin),i.addUniform(l),i.addUniform(new s.projectionUniform("projectionMatrix")),i.addUniform(new s.floatUniform("opacity",1)),i.addShader(s.getCachedShader(s.GL.VERTEX_SHADER,s.GL,M)),i.addShader(s.utils.createRgbaTextureFragmentShader(s.GL)),e.addAttribute(i),e.addAttribute(new s.blend),r=new s.geometryData,d=void 0,n=new s.sourceDataT2fv,n.pushBack([0,0,1,0,0,1,1,1]),r.addSource(n),t.setGeometryData(r),h.setMaterial(e),t.s_render=t.render,t.render=v._renderImageQuads,v.renderer().contextRenderer().addActor(h),v.visible(!0)),m.clrQuads.length&&!c&&(v.visible(!1),t=new s.mapper({dynamicDraw:!0}),c=new s.actor,c.setMapper(t),e=new s.material,i=new s.shaderProgram,i.addVertexAttribute(new s.vertexAttribute("vertexPosition"),s.vertexAttributeKeys.Position),p=new s.modelViewOriginUniform("modelViewMatrix",m.origin),i.addUniform(p),i.addUniform(new s.projectionUniform("projectionMatrix")),i.addUniform(new s.floatUniform("opacity",1)),i.addUniform(new s.uniform(s.GL.FLOAT_VEC3,"vertexColor")),i.addShader(s.getCachedShader(s.GL.VERTEX_SHADER,s.GL,T)),i.addShader(s.utils.createFragmentShader(s.GL)),e.addAttribute(i),e.addAttribute(new s.blend),r=new s.geometryData,f=void 0,t.setGeometryData(r),c.setMaterial(e),t.s_render=t.render,t.render=v._renderColorQuads,v.renderer().contextRenderer().addActor(c),v.visible(!0)),l&&l.setOrigin(m.origin),p&&p.setOrigin(m.origin),v.buildTime().modified())},this._updateTextures=function(){var t;r.each(m.imgQuads,function(e,i){i.image&&(i.image._texture?i.texture=i.image._texture:(t=new s.texture,t.setImage(i.image),i.texture=i.image._texture=t))})},this._renderColorQuads=function(t){if(m.clrQuads.length){var e=this;(e.getMTime()>w.getMTime()||v.dataTime().getMTime()>w.getMTime()||t.m_contextChanged||!f||12*m.clrQuads.length>f.length)&&n(t),e.s_render(t,!0);var i,o=t.m_context,a=1;o.bindBuffer(s.GL.ARRAY_BUFFER,_.clrQuadsPosition),r.each(m.clrQuads,function(e,n){n.opacity!==a&&(a=n.opacity,o.uniform1fv(t.m_material.shaderProgram().uniformLocation("opacity"),new Float32Array([a]))),i&&i.r===n.color.r&&i.g===n.color.g&&i.b===n.color.b||(i=n.color,o.uniform3fv(t.m_material.shaderProgram().uniformLocation("vertexColor"),new Float32Array([i.r,i.g,i.b]))),o.bindBuffer(s.GL.ARRAY_BUFFER,_.clrQuadsPosition),o.vertexAttribPointer(s.vertexAttributeKeys.Position,3,s.GL.FLOAT,!1,12,12*e*4),o.enableVertexAttribArray(s.vertexAttributeKeys.Position),o.drawArrays(s.GL.TRIANGLE_STRIP,0,4)}),o.bindBuffer(s.GL.ARRAY_BUFFER,null),e.undoBindVertexData(t)}},this._renderImageQuads=function(t){if(m.imgQuads.length){var i=this;(i.getMTime()>b.getMTime()||v.dataTime().getMTime()>b.getMTime()||t.m_contextChanged||!d||12*m.imgQuads.length>d.length)&&e(t),i.s_render(t,!0);var n=t.m_context,o=1;v._updateTextures(),n.bindBuffer(s.GL.ARRAY_BUFFER,_.imgQuadsPosition),r.each(m.imgQuads,function(e,i){i.image&&(i.texture.bind(t),i.opacity!==o&&(o=i.opacity,n.uniform1fv(t.m_material.shaderProgram().uniformLocation("opacity"),new Float32Array([o]))),n.bindBuffer(s.GL.ARRAY_BUFFER,_.imgQuadsPosition),n.vertexAttribPointer(s.vertexAttributeKeys.Position,3,s.GL.FLOAT,!1,12,12*e*4),n.enableVertexAttribArray(s.vertexAttributeKeys.Position),n.drawArrays(s.GL.TRIANGLE_STRIP,0,4),i.texture.undoBind(t))}),n.bindBuffer(s.GL.ARRAY_BUFFER,null),i.undoBindVertexData(t)}},this._update=function(){x.call(v),(v.buildTime().getMTime()<=v.dataTime().getMTime()||v.updateTime().getMTime()<v.getMTime())&&v._build(),c&&(c.setVisible(v.visible()),c.material().setBinNumber(v.bin())),h&&(h.setVisible(v.visible()),h.material().setBinNumber(v.bin())),v.updateTime().modified()},this._init=function(){y.call(v,t)},this._exit=function(){h&&(v.renderer().contextRenderer().removeActor(h),h=null),c&&(v.renderer().contextRenderer().removeActor(c),c=null),g.call(v)},v._init(t),this};n(a,o);var s={};s[o.capabilities.color]=!0,s[o.capabilities.image]=!0,s[o.capabilities.imageFull]=!0,r("vgl","quad",a,s),t.exports=a},function(t,e,i){var n=i(131).registerLayerAdjustment,r=function(){"use strict";var t,e=this,i=this._init,n=this._exit,r=0,o=[];this._drawTile=function(i){if(t){var n=this._tileBounds(i),a=i.index.level||0,s=this._tileOffset(a),u={};u.ul=this.fromLocal(this.fromLevel({x:n.left-s.x,y:n.top-s.y},a),0),u.ll=this.fromLocal(this.fromLevel({x:n.left-s.x,y:n.bottom-s.y},a),0),u.ur=this.fromLocal(this.fromLevel({x:n.right-s.x,y:n.top-s.y},a),0),u.lr=this.fromLocal(this.fromLevel({x:n.right-s.x,y:n.bottom-s.y},a),0),u.ul.z=u.ll.z=u.ur.z=u.lr.z=1e-5*a,r+=1,u.id=r,i.quadId=u.id,u.image=i.image,o.push(u),t.data(o),t._update(),e.draw()}},this._remove=function(i){if(void 0!==i.quadId&&t){for(var n=0;n<o.length;n+=1)if(o[n].id===i.quadId){o.splice(n,1);break}t.data(o),t._update(),e.draw()}},this._exit=function(){e.deleteFeature(t),t=null,o=[],n.apply(e,arguments)},this._init=function(){i.apply(e,arguments),t=this.createFeature("quad",{previewColor:e._options.previewColor,previewImage:e._options.previewImage}),t.geoTrigger=void 0,t.gcs(e._options.gcs||e.map().gcs()),t.data(o),t._update()},this._getSubLayer=function(){},this._updateSubLayers=void 0};n("vgl","tile",r),t.exports=r},function(t,e,i){var n=i(4),r=i(131).registerRenderer,o=i(136),a=function(t){"use strict";if(!(this instanceof a))return new a(t);t=t||{},o.call(this,t);var e,n=i(1),r=i(6),s=i(8),u=i(120),l=i(125),h=this,c=null,d=null,f=0,p=0,m=null,v=this._init,g=this._exit;return this.width=function(){return f},this.height=function(){return p},this.contextRenderer=function(){return c},this.api=function(){return"vgl"},this._init=function(){if(h.initialized())return h;v.call(h);var e=n(document.createElement("canvas"));e.attr("class","webgl-canvas"),n(h.layer().node().get(0)).append(e),d=r.viewer(e.get(0),t.options),d.init(),c=d.renderWindow().activeRenderer(),c.setResetScene(!1),d.renderWindow().renderers().length>0&&c.setLayer(d.renderWindow().renderers().length),h.canvas(e);var i=h.layer().map(),o=i.size();return h._resize(0,0,o.width,o.height),h},this._resize=function(t,e,i,n){var r=d.renderWindow();return f=i,p=n,h.canvas().attr("width",i),h.canvas().attr("height",n),r.positionAndResize(t,e,i,n),h._updateRendererCamera(),h._render(),h},this._render=function(){return m&&window.cancelAnimationFrame(m),m=window.requestAnimationFrame(this._renderFrame),h},this._renderFrame=function(){m=null,d.render()},this._exit=function(){h.canvas().remove(),d.exit(),g()},this._updateRendererCamera=function(){var t=d.renderWindow(),i=h.layer().map(),n=i.camera(),r=i.rotation()||0,o=n.view,a=n.projectionMatrix;a[15]&&(a=s.scale(u.mat4AsArray(),a,[1,1,-1])),a=s.translate(u.mat4AsArray(),a,[0,0,n.constructor.bounds.far]);var l=Math.PI/2,c=r%l,f=Math.min(Math.abs(c),Math.abs(c-l))<1e-5;t.renderers().forEach(function(t){var r=t.camera();u.compareArrays(o,r.viewMatrix())&&u.compareArrays(a,r.projectionMatrix())&&e===i.zoom()||(e=i.zoom(),r.setViewMatrix(o,!0),r.setProjectionMatrix(a),a[1]||a[2]||a[3]||a[4]||a[6]||a[7]||a[8]||a[9]||a[11]||1!==a[15]||!f||parseFloat(e.toFixed(6))!==parseFloat(e.toFixed(0))?r.viewAlignment=function(){return null}:r.viewAlignment=function(){var t={roundx:2/n.viewport.width,roundy:2/n.viewport.height};return t.dx=n.viewport.width%2?.5*t.roundx:0,t.dy=n.viewport.height%2?.5*t.roundy:0,t})})},h.layer().geoOn(l.pan,function(t){h._updateRendererCamera()}),h.layer().geoOn(l.zoom,function(t){h._updateRendererCamera()}),h.layer().geoOn(l.rotate,function(t){h._updateRendererCamera()}),h.layer().geoOn(l.parallelprojection,function(t){var e,i=h.contextRenderer(),n=h.layer();t.geo&&t.geo._triggeredBy!==n&&(i&&i.camera()||console.log("Parallel projection event triggered on unconnected VGL renderer."),e=i.camera(),e.setEnableParallelProjection(t.parallelProjection),h._updateRendererCamera())}),this};n(a,o),r("vgl",a),function(){"use strict";var t;a.supported=function(){if(void 0===t){var e,i,n;try{e=document.createElement("canvas"),i=e.getContext("webgl")||e.getContext("experimental-webgl"),n=i.getSupportedExtensions(),t=!0}catch(r){console.error("No webGL support"),t=!1}e=void 0,i=void 0,n=void 0}return t},a.fallback=function(){return null}}(),t.exports=a},function(t,e,i){t.exports={canvasRenderer:i(257),quadFeature:i(258),heatmapFeature:i(260),tileLayer:i(261)}},function(t,e,i){var n=i(4),r=i(131).registerRenderer,o=i(136),a=function(t){"use strict";var e=i(1);if(!(this instanceof a))return new a(t);t=t||{},o.call(this,t);var n=this,r=null,s=!0,u=this._init,l=this._exit;return this.clearCanvas=function(t){s=t},this.api=function(){return"canvas"},this._init=function(){if(n.initialized())return n;u.call(n);var t=e(document.createElement("canvas"));n.context2d=t[0].getContext("2d"),t.attr("class","canvas-canvas"),e(n.layer().node().get(0)).append(t),n.canvas(t);var i=n.layer().map(),r=i.size();return n._resize(0,0,r.width,r.height),n},this._resize=function(t,e,i,r){return n.canvas().attr("width",i),n.canvas().attr("height",r),n._render(),n},this._render=function(){return null===r&&(r=window.requestAnimationFrame(function(){r=null;var t=n.layer(),e=t.map(),i=e.camera(),o=i._viewport;s&&(n.context2d.setTransform(1,0,0,1,0,0),n.context2d.clearRect(0,0,o.width,o.height));for(var a=t.features(),u=0;u<a.length;u+=1)a[u]._renderOnCanvas(n.context2d,e)})),n},this._exit=function(){n.canvas().remove(),l()},this};n(a,o),r("canvas",a),function(){"use strict";var t;a.supported=function(){if(void 0===t){var e;try{e=document.createElement("canvas"),t=!(!e.getContext||!e.getContext("2d"))}catch(i){t=!1}e=void 0}return t},a.fallback=function(){return null}}(),t.exports=a},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(218),a=function(t){"use strict";if(!(this instanceof a))return new a(t);o.call(this,t);var e=i(259);e.call(this);var n,r=i(1),s=this,u=this._exit,l=this._init,h=this._update;return this._build=function(){s.position()&&(n=this._generateQuads(),n.imgQuads&&n.imgQuads.sort(function(t,e){return t.pos[2]-e.pos[2]}),s.buildTime().modified())},this._renderColorQuads=function(t){},this._renderImageQuads=function(t,e){if(n.imgQuads.length){var i=t.globalAlpha,o=i;r.each(n.imgQuads,function(i,n){if(n.image){var r=n.image.width,a=n.image.height,s=e.gcsToDisplay({x:n.pos[0],y:n.pos[1]},null),u=e.gcsToDisplay({x:n.pos[9],y:n.pos[10]},null),l=e.gcsToDisplay({x:n.pos[6],y:n.pos[7]},null);t.setTransform((u.x-l.x)/r,(u.y-l.y)/a,(s.x-l.x)/r,(s.y-l.y)/a,l.x,l.y),n.opacity!==o&&(o=n.opacity,t.globalAlpha=o),t.drawImage(n.image,0,0)}}),o!==i&&(t.globalAlpha=i)}},this._renderOnCanvas=function(t,e){this._renderImageQuads(t,e),this._renderColorQuads(t,e)},this._update=function(){h.call(s),(s.buildTime().getMTime()<=s.dataTime().getMTime()||s.updateTime().getMTime()<s.getMTime())&&s._build(),s.updateTime().modified()},this._init=function(){l.call(s,t)},this._exit=function(){u.call(s)},s._init(t),this};n(a,o);var s={};s[o.capabilities.color]=!1,s[o.capabilities.image]=!0,s[o.capabilities.imageFull]=!1,r("canvas","quad",a,s),t.exports=a},function(t,e,i){var n=i(4),r=i(128),o=function(t){"use strict";var e=i(5);if(!(this instanceof e))return new o(t);r.call(this);var n=this,a=this.draw;return this.draw=function(){return n._update(),n.renderer()._render(),a(),n},this};n(o,r),t.exports=o},function(t,e,i){var n=i(4),r=i(131).registerFeature,o=i(227),a=i(129),s=function(t){"use strict";if(!(this instanceof s))return new s(t);o.call(this,t);var e=i(259);e.call(this);var n,r,u,l,h=i(125),c=this,d=this._exit,f=this._init,p=this._update,m=a();return this._convertColor=function(t){var e;return t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")&&t.hasOwnProperty("a")&&(e="rgba("+255*t.r+","+255*t.g+","+255*t.b+","+t.a+")"),e},this._computeGradient=function(){var t,e,i,n,r;if(r=c.style("color"),!c._grad||c._gradColors!==r){t=document.createElement("canvas"),i=t.getContext("2d"),n=i.createLinearGradient(0,0,0,256),t.width=1,t.height=256;for(e in r)n.addColorStop(e,c._convertColor(r[e]));i.fillStyle=n,i.fillRect(0,0,1,256),c._grad=i.getImageData(0,0,1,256).data,c._gradColors=r}return c},this._createCircle=function(){var t,e,i,n,r,o;if(i=c.style("radius"),r=c.style("blurRadius"),o=c.style("gaussian"),!c._circle||c._circle.gaussian!==o||c._circle.radius!==i||c._circle.blurRadius!==r){if(t=c._circle=document.createElement("canvas"),e=t.getContext("2d"),n=r+i,t.width=t.height=2*n,o){var a=e.createRadialGradient(n,n,0,n,n,n);a.addColorStop(0,"rgba(255,255,255,1)"),a.addColorStop(.1,"rgba(255,255,255,0.946)"),a.addColorStop(.2,"rgba(255,255,255,0.801)"),a.addColorStop(.3,"rgba(255,255,255,0.607)"),a.addColorStop(.4,"rgba(255,255,255,0.411)"),a.addColorStop(.5,"rgba(255,255,255,0.249)"),a.addColorStop(.6,"rgba(255,255,255,0.135)"),a.addColorStop(.7,"rgba(255,255,255,0.066)"),a.addColorStop(.8,"rgba(255,255,255,0.029)"),a.addColorStop(.9,"rgba(255,255,255,0.011)"),a.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=a,e.fillRect(0,0,2*n,2*n)}else e.shadowOffsetX=e.shadowOffsetY=2*n,e.shadowBlur=r,e.shadowColor="black",e.beginPath(),e.arc(-n,-n,i,0,2*Math.PI,!0),e.closePath(),e.fill();t.radius=i,t.blurRadius=r,t.gaussian=o,c._circle=t}return c},this._colorize=function(t,e){var i,o,a,s=new Uint32Array(e.buffer),l=t.length;for(n&&n.length===l||(n=new ArrayBuffer(l),r=new Uint8ClampedArray(n),u=new Uint32Array(n)),i=3,a=0;i<l;i+=4,a+=1)o=t[i],o&&(u[a]=s[o]);t.set(r)},this._renderPoints=function(t,e,i,n){var r,o,a,s=c.gcsPosition(),u=c.intensity(),l=c.minIntensity(),h=c.maxIntensity()-l||1;for(r=i.length-1;r>=0;r-=1)o=e.worldToDisplay(s[r]),a=(u(i[r])-l)/h,a<=0||(t.globalAlpha=a<.01?.01:a>1?1:a,t.drawImage(c._circle,o.x-n,o.y-n))},this._renderBinnedData=function(t,e,i,n,r){var o,a,s,u,l,h,d,f,p=c.gcsPosition(),m=c.intensity(),v=c.minIntensity(),g=c.maxIntensity()-v||1,y=e.camera()._viewport,x=[],_=Math.ceil(n/r),b=Math.ceil(y.width/r)+2*_+2,w=Math.ceil(y.height/r)+2*_+2,M=i.length;for(o=0;o<M;o+=1)a=e.worldToDisplay(p[o]),isNaN(a.x)||isNaN(a.y)||(void 0===d&&(d=(a.x%r+r)%r,f=(a.y%r+r)%r),u=Math.floor((a.x-d)/r)+_+1,u<0||u>=b||(l=Math.floor((a.y-f)/r)+_+1,l<0||l>=w||(s=(m(i[o])-v)/g,s<=0||(s>1&&(s=1),x[l]=x[l]||[],u*=4,h=x[l],h[u]?(h[u]+=s,h[u+1]+=(1-h[u+1])*s,h[u+2]+=a.x*s,h[u+3]+=a.y*s):(h[u]=h[u+1]=s,h[u+2]=a.x*s,h[u+3]=a.y*s)))));for(l=x.length-1;l>=0;l-=1)if(h=x[l])for(u=h.length-4;u>=0;u-=4)h[u]&&(s=h[u+1],t.globalAlpha=s<.01?.01:s>1?1:s,t.drawImage(c._circle,h[u+2]/h[u]-n,h[u+3]/h[u]-n))},this._renderOnCanvas=function(t,e){if(m.getMTime()<c.buildTime().getMTime()){var i,n,r=c.data()||[],o=c.style("radius")+c.style("blurRadius"),a=c.binned(),s=c.layer(),u=e.camera()._viewport;if((a===!0||"auto"===a)&&(a=Math.max(Math.floor(o/8),3),"auto"===c.binned())){var h=Math.ceil((u.width+2*o)/a)*Math.ceil((u.height+2*o)/a);h>=r.length&&(a=0)}(a<1||isNaN(a))&&(a=!1),c._binned=a,t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,u.width,u.height),s.canvas().css({transform:"","transform-origin":"0px 0px"}),c._createCircle(),c._computeGradient(),a?c._renderBinnedData(t,e,r,o,a):c._renderPoints(t,e,r,o),i=s.canvas()[0],n=t.getImageData(0,0,i.width,i.height),c._colorize(n.data,c._grad),t.putImageData(n,0,0),l={zoom:e.zoom(),gcsOrigin:e.displayToGcs({x:0,y:0},null),rotation:e.rotation(),lastScale:void 0,lastOrigin:{x:0,y:0},lastRotation:void 0},m.modified(),s.renderer().clearCanvas(!1)}return c},this._init=function(){return f.call(c,t),c.geoOn(h.pan,c._animatePan),c},this._update=function(){return p.call(c),(c.buildTime().getMTime()<=c.dataTime().getMTime()||c.updateTime().getMTime()<c.getMTime())&&c._build(),c.updateTime().modified(),c},this._animatePan=function(t){var e=c.layer().map(),i=e.zoom(),n=Math.pow(2,i-l.zoom),r=e.gcsToDisplay(l.gcsOrigin,null),o=e.rotation();if(l.lastScale!==n||l.lastOrigin.x!==r.x||l.lastOrigin.y!==r.y||l.lastRotation!==o){var a=" translate("+r.x+"px,"+r.y+"px) scale("+n+") rotate("+180*(o-l.rotation)/Math.PI+"deg)";c.layer().canvas()[0].style.transform=a,l.lastScale=n,l.lastOrigin.x=r.x,l.lastOrigin.y=r.y,l.lastRotation=o,l.timeout&&(window.clearTimeout(l.timeout),l.timeout=void 0),1===parseFloat(n.toFixed(4))&&0===parseFloat((o-l.rotation).toFixed(4))&&0===parseFloat(r.x.toFixed(1))&&0===parseFloat(r.y.toFixed(1))||(l.timeout=window.setTimeout(function(){l.timeout=void 0,c.buildTime().modified(),c.layer().draw()},c.updateDelay()))}},this._exit=function(){d.call(c)},c._init(t),this};n(s,o),r("canvas","heatmap",s),t.exports=s},function(t,e,i){var n=i(131).registerLayerAdjustment,r=function(){"use strict";var t,e=this,i=this._init,n=this._exit,r=0,o=[];this._drawTile=function(i){if(t){var n=this._tileBounds(i),a=i.index.level||0,s=this._tileOffset(a),u={};u.ul=this.fromLocal(this.fromLevel({x:n.left-s.x,y:n.top-s.y},a),0),u.ll=this.fromLocal(this.fromLevel({x:n.left-s.x,y:n.bottom-s.y},a),0),u.ur=this.fromLocal(this.fromLevel({x:n.right-s.x,y:n.top-s.y},a),0),u.lr=this.fromLocal(this.fromLevel({x:n.right-s.x,y:n.bottom-s.y},a),0),u.ul.z=u.ll.z=u.ur.z=u.lr.z=1e-5*a,r+=1,u.id=r,i.quadId=u.id,u.image=i.image,o.push(u),t.data(o),t._update(),e.draw()}},this._remove=function(i){if(void 0!==i.quadId&&t){for(var n=0;n<o.length;n+=1)if(o[n].id===i.quadId){o.splice(n,1);break}t.data(o),t._update(),e.draw()}},this._exit=function(){e.deleteFeature(t),t=null,o=[],n.apply(e,arguments)},this._init=function(){i.apply(e,arguments),t=this.createFeature("quad",{previewColor:e._options.previewColor,previewImage:e._options.previewImage}),t.geoTrigger=void 0,t.gcs(e._options.gcs||e.map().gcs()),t.data(o),t._update()},this._getSubLayer=function(){},this._updateSubLayers=void 0};n("canvas","tile",r),t.exports=r},function(t,e,i){t.exports={domWidget:i(263),legendWidget:i(265),sliderWidget:i(267),svgWidget:i(266),uiLayer:i(219),widget:i(264)}},function(t,e,i){var n=i(264),r=i(4),o=i(131).registerWidget,a=function(t){"use strict";if(!(this instanceof a))return new a(t);n.call(this,t);var e=this,i="div";return this._init=function(){t.hasOwnProperty("parent")&&t.parent.addChild(e),e._createCanvas(),e._appendChild(),e.canvas().addEventListener("mousedown",function(t){t.stopPropagation()}),e.reposition()},this._createCanvas=function(){e.canvas(document.createElement(t.el||i))},this};r(a,n),o("dom","dom",a),t.exports=a},function(t,e,i){var n=i(4),r=i(128),o=function(t){"use strict";if(!(this instanceof o))return new o(t);r.call(this,t);var e=i(125),n=i(131).createFeature,a=this,s=this._exit,u=t.layer,l=null;if(t.position=void 0===t.position?{left:0,top:0}:t.position,void 0!==t.parent&&!(t.parent instanceof o))throw"Parent must be of type geo.gui.widget";this._init=function(){a.modified()},this._exit=function(){a.children().forEach(function(t){a._deleteFeature(t)}),a.layer().geoOff(e.pan,a.repositionEvent),a.parentCanvas().removeChild(a.canvas()),s()},this._createFeature=function(t,e){var i=n(t,a,a.renderer(),e);return a.addChild(i),a.modified(),i},this._deleteFeature=function(t){return a.removeChild(t),t._exit(),a},this.layer=function(){return u},this._createCanvas=function(){throw"Must be defined in derived classes"},this.canvas=function(t){return void 0===t?l:void(l=t)},this._appendChild=function(){a.parentCanvas().appendChild(a.canvas())},this.parentCanvas=function(){return void 0===a.parent?a.layer().canvas():a.parent().canvas()},this.position=function(e){if(void 0!==e)return t.position=e,this.reposition(),this;var i;return t&&t.hasOwnProperty("position")&&t.position.hasOwnProperty("x")&&t.position.hasOwnProperty("y")?(i=a.layer().map().gcsToDisplay(t.position),{left:i.x,top:i.y}):t.position},this.reposition=function(t){t=t||a.position(),a.canvas().style.position="absolute";for(var e in t)t.hasOwnProperty(e)&&(a.canvas().style[e]=t[e]+"px")},this.repositionEvent=function(){return a.reposition()},this.isInViewport=function(){var t=a.position(),e=a.layer();return t.left>=0&&t.top>=0&&t.left<=e.width()&&t.top<=e.height()},t&&t.hasOwnProperty("position")&&t.position.hasOwnProperty("x")&&t.position.hasOwnProperty("y")&&this.layer().geoOn(e.pan,a.repositionEvent)};n(o,r),t.exports=o},function(t,e,i){var n=i(266),r=i(4),o=i(131).registerWidget,a=function(t){"use strict";if(!(this instanceof a))return new a(t);n.call(this,t);var e=i(132),r=i(125),o=this,s=[],u=null,l=null,h=null,c=20,d=12,f=this._createCanvas,p=this._appendChild;this.categories=function(t){return void 0===t?s.slice():(s=t.slice().map(function(t){return"line"===t.type&&(t.style.fill=!1,t.style.stroke=!0),t}),o.draw(),o)},this.size=function(){var t,i=1,n=e.select(o.canvas()).append("text").style("opacity",1e-6);return s.forEach(function(t){n.text(t.name),i=Math.max(i,n.node().getBBox().width)}),n.remove(),t=c*(s.length+1),{width:i+50,height:t}},this.draw=function(){function t(t){t.style("fill",function(t){return t.style.fill||void 0===t.style.fill?t.style.fillColor:"none"}).style("fill-opacity",function(t){return void 0===t.style.fillOpacity?1:t.style.fillOpacity}).style("stroke",function(t){return t.style.stroke||void 0===t.style.stroke?t.style.strokeColor:"none"}).style("stroke-opacity",function(t){return void 0===t.style.strokeOpacity?1:t.style.strokeOpacity}).style("stroke-width",function(t){return void 0===t.style.strokeWidth?1.5:t.style.strokeWidth})}o._init(),h.attr("height",o.size().height+2*d).style("display",null);var e=o._scale(),i=l.selectAll("g.geo-label").data(s,function(t){return t.name}),n=i.enter().append("g").attr("class","geo-label").attr("transform",function(t,i){return"translate(0,"+e.y(i)+")"});return t(n.filter(function(t){return"point"!==t.type&&"line"!==t.type}).append("rect").attr("x",0).attr("y",-6).attr("rx",5).attr("ry",5).attr("width",40).attr("height",12)),t(n.filter(function(t){return"point"===t.type}).append("circle").attr("cx",20).attr("cy",0).attr("r",6)),t(n.filter(function(t){return"line"===t.type}).append("line").attr("x1",0).attr("y1",0).attr("x2",40).attr("y2",0)),n.append("text").attr("x","50px").attr("y",0).attr("dy","0.3em").text(function(t){return t.name}),o.reposition(),o},this._scale=function(){return{x:e.scale.linear().domain([0,1]).range([0,o.size().width]),y:e.scale.linear().domain([0,s.length-1]).range([d/2,o.size().height-d/2])}},this._init=function(){u||(f(),p());var t=o.size().width+2*d+4,i=o.size().height+2*d+4;u&&u.remove(),e.select(o.canvas()).attr("width",t).attr("height",i),u=e.select(o.canvas()).append("g"),l=u.append("g").attr("transform","translate("+[d+2,d+2]+")"),h=l.append("rect").attr("x",-d).attr("y",-d).attr("width",t-4).attr("height",i-4).attr("rx",3).attr("ry",3).style({stroke:"black","stroke-width":"1.5px",fill:"white","fill-opacity":.75,display:"none"}),l.on("mousedown",function(){e.event.stopPropagation()}),l.on("mouseover",function(){h.transition().duration(250).style("fill-opacity",1)}),l.on("mouseout",function(){h.transition().duration(250).style("fill-opacity",.75)}),o.reposition()},this.geoOn(r.resize,function(){o.draw()})};r(a,n),o("dom","legend",a),t.exports=a},function(t,e,i){var n=i(263),r=i(4),o=i(131).registerWidget,a=function(t){"use strict";if(!(this instanceof a))return new a(t);n.call(this,t);var e=i(240),r=this,o=null;return this._init=function(t){var e;t.hasOwnProperty("parent")&&(t.parent.addChild(r),e=t.parent.canvas()),r._createCanvas(e),r.canvas().addEventListener("mousedown",function(t){t.stopPropagation()}),r.reposition()},this._createCanvas=function(t){var i={layer:r.layer(),widget:!0};t&&(i.d3Parent=t),o=e(i),r.canvas(o.canvas()[0][0])},this};r(a,n),o("dom","svg",a),t.exports=a},function(t,e,i){var n=i(266),r=i(4),o=i(131).registerWidget,a=function(t){"use strict";function e(t,e,i,n,r){var o=e.append("g"),a=r/1024;return o.append("g").append("g").attr("transform","translate("+i+","+n+") scale("+a+") translate(-512,-512)").append("path").attr("d",t).attr("class","geo-glyphicon"),o}if(!(this instanceof a))return new a(t);n.call(this,t);var r,o,s,u,l,h,c,d,f,p=i(132),m=i(125),v=this,g=this._exit,y=this._createCanvas,x=this._appendChild,_=20,b=100,w=10,M=100;h="M512 81.92c-237.568 0-430.080 192.614-430.080 430.080 0 237.568 192.563 430.080 430.080 430.080s430.080-192.563 430.080-430.080c0-237.517-192.563-430.080-430.080-430.080zM564.326 564.326v206.182h-104.653v-206.182h-206.234v-104.653h206.182v-206.234h104.704v206.182h206.182v104.704h-206.182z",c="M512 81.92c-237.568 0-430.080 192.614-430.080 430.080 0 237.568 192.563 430.080 430.080 430.080s430.080-192.563 430.080-430.080c0-237.517-192.563-430.080-430.080-430.080zM770.56 459.674v104.704h-517.12v-104.704h517.12z",f={white:"#f4f4f4",black:"#505050"},this._init=function(){function t(t,e){var i=o.invert(p.mouse(v.layer().node()[0])[1]),n=g.zoomRange();i=(1-i)*(n.max-n.min)+n.min,e?g.transition({zoom:i,ease:p.ease("cubic-in-out"),duration:500,done:v._update()}):(g.zoom(i),v._update()),t.stopPropagation()}y(),x(),v.reposition();var i=p.select(v.canvas()),n=40,a=40+_,g=v.layer().map();r=p.scale.linear().domain([-4,4]).range([n,n+_]),o=p.scale.linear().domain([0,1]).range([a,a+b]),i=i.append("g").classed("geo-ui-slider",!0),d=i,s=i.append("g"),s.append("circle").datum({fill:"white",stroke:null}).classed("geo-zoom-in",!0).attr("cx",r(0)).attr("cy",o(0)-_+2).attr("r",_/2).style({cursor:"pointer"}).on("click",function(){var t=g.zoom();g.transition({zoom:t+1,ease:p.ease("cubic-in-out"),duration:500})}).on("mousedown",function(){p.event.stopPropagation()}),e(h,s,r(0),o(0)-_+2,_+5).style("cursor","pointer").style("pointer-events","none").select("path").datum({fill:"black",stroke:null}),u=i.append("g"),u.append("circle").datum({fill:"white",stroke:null}).classed("geo-zoom-out",!0).attr("cx",r(0)).attr("cy",o(1)+_-2).attr("r",_/2).style({cursor:"pointer"}).on("click",function(){var t=g.zoom();g.transition({zoom:t-1,ease:p.ease("cubic-in-out"),duration:500})}).on("mousedown",function(){p.event.stopPropagation()}),e(c,u,r(0),o(1)+_-2,_+5).style("cursor","pointer").style("pointer-events","none").select("path").datum({fill:"black",stroke:null}),i.append("rect").datum({fill:"white",stroke:"black"}).classed("geo-zoom-track",!0).attr("x",r(0)-_/6).attr("y",o(0)).attr("rx",_/10).attr("ry",_/10).attr("width",_/3).attr("height",b).style({cursor:"pointer"}).on("click",function(){t(p.event,!0)}),l=i.append("rect").datum({fill:"black",stroke:null}).classed("geo-zoom-nub",!0).attr("x",r(-4)).attr("y",o(.5)-w/2).attr("rx",3).attr("ry",3).attr("width",_).attr("height",w).style({cursor:"pointer"}).on("mousedown",function(){p.select(document).on("mousemove.geo.slider",function(){t(p.event)}),p.select(document).on("mouseup.geo.slider",function(){t(p.event),p.select(document).on(".geo.slider",null)}),p.event.stopPropagation()});var T=function(){p.select(this).attr("filter","url(#geo-highlight)"),d.selectAll("rect,path,circle").transition().duration(M).style("fill",function(t){return t.fill||null}).style("stroke",function(t){return t.stroke||null})},A=function(){p.select(this).attr("filter",null),d.selectAll("circle,rect,path").transition().duration(M).style("fill",function(t){return f[t.fill]||null}).style("stroke",function(t){return f[t.stroke]||null})};d.selectAll("*").on("mouseover",T).on("mouseout",A),v.layer().geoOn(m.zoom,function(){v._update()}),A(),v._update()},this._exit=function(){d.remove(),v.layer().geoOff(m.zoom),g()},this._update=function(t){var e=v.layer().map(),i=e.zoomRange(),n=e.zoom(),r=p.scale.linear();t=t||{},n=t.value||n,r.domain([i.min,i.max]).range([1,0]).clamp(!0),l.attr("y",o(r(n))-w/2)}};r(a,n),o("dom","slider",a),t.exports=a}])});